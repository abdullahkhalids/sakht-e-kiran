(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.4' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    251986,       5504]
NotebookOptionsPosition[    246518,       5331]
NotebookOutlinePosition[    246887,       5347]
CellTagsIndexPosition[    246844,       5344]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["This notebook diagonalize a given rate matrix.", "Text",
 CellChangeTimes->{{3.672713741567542*^9, 3.672713777013112*^9}}],

Cell["\<\
Calculates the rate matrix for any input and any output configuration of \
photons in a interferometer.\
\>", "Text",
 CellChangeTimes->{{3.643610913425571*^9, 3.643610939541642*^9}}],

Cell["Inputs: the input and output photon configurations.", "Text",
 CellChangeTimes->{{3.6436089545677147`*^9, 3.643608979910529*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"inputdist", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"outputdist", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"inputpermutation", "=", 
   RowBox[{"Cycles", "[", 
    RowBox[{"{", 
     RowBox[{"{", "}"}], "}"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6436004058020353`*^9, 3.643600409468233*^9}, {
   3.6436009704049587`*^9, 3.6436009717383833`*^9}, {3.643602399992597*^9, 
   3.643602406605891*^9}, {3.6436072966466627`*^9, 3.643607298370922*^9}, {
   3.643607362781349*^9, 3.643607364282209*^9}, {3.6436074267145977`*^9, 
   3.643607428185925*^9}, {3.6436074612051773`*^9, 3.643607464361793*^9}, {
   3.6436083405631104`*^9, 3.64360834179792*^9}, {3.643610005275527*^9, 
   3.643610017448551*^9}, {3.643610081352216*^9, 3.6436100831652803`*^9}, {
   3.6436108733560677`*^9, 3.643610874673819*^9}, {3.643611123222293*^9, 
   3.64361116391925*^9}, {3.6436113867749767`*^9, 3.6436113886416693`*^9}, {
   3.643611440901795*^9, 3.643611442846052*^9}, {3.643611495594458*^9, 
   3.643611498256769*^9}, {3.643611538411118*^9, 3.643611603890555*^9}, {
   3.6436127258819036`*^9, 3.6436127268667*^9}, {3.643645392872064*^9, 
   3.643645394638459*^9}, {3.6436454437735567`*^9, 3.64364544966813*^9}, {
   3.643645490482872*^9, 3.643645541616087*^9}, {3.6436470643497972`*^9, 
   3.643647065892641*^9}, {3.643647769036433*^9, 3.643647773892983*^9}, {
   3.6436479123234177`*^9, 3.643647913768911*^9}, {3.643648201179006*^9, 
   3.643648206052462*^9}, {3.643648549278146*^9, 3.643648551949889*^9}, {
   3.643650827779578*^9, 3.643650829668572*^9}, {3.643651122683813*^9, 
   3.643651127277918*^9}, {3.64365683855057*^9, 3.643656844647785*^9}, {
   3.647120379200632*^9, 3.647120384777946*^9}, {3.647122186254682*^9, 
   3.647122191563105*^9}, {3.6471933725262747`*^9, 3.647193390883336*^9}, {
   3.6471938170986843`*^9, 3.647193823515936*^9}, {3.647213365806601*^9, 
   3.64721336747812*^9}, {3.6472134397263308`*^9, 3.647213442585253*^9}, {
   3.647213803593987*^9, 3.6472138078043337`*^9}, {3.647311763570917*^9, 
   3.6473117646794786`*^9}, {3.652220064485099*^9, 3.652220065756666*^9}, {
   3.652420517800768*^9, 3.6524205568518553`*^9}, {3.652420707787077*^9, 
   3.652420710754376*^9}, {3.672330282847165*^9, 3.672330285630321*^9}, {
   3.673046229993739*^9, 3.6730462331102533`*^9}, {3.673046607090119*^9, 
   3.6730466080443563`*^9}, {3.673046794379424*^9, 3.673046795038377*^9}, {
   3.6730468512180433`*^9, 3.673046873898426*^9}, {3.6730544884926777`*^9, 
   3.673054489712656*^9}, {3.673055389697695*^9, 3.6730553904999933`*^9}, {
   3.673056628285479*^9, 3.673056631189335*^9}, {3.673057081548152*^9, 
   3.673057083414384*^9}, {3.6730678183743143`*^9, 3.673067820175185*^9}, {
   3.673068007469626*^9, 3.673068042799155*^9}, {3.673130631196372*^9, 
   3.6731306324287643`*^9}, {3.6731307465297127`*^9, 3.673130749017703*^9}, {
   3.6731314396251593`*^9, 3.673131440531262*^9}, {3.673138727363439*^9, 
   3.673138730337132*^9}, {3.673138891805002*^9, 3.6731388926344767`*^9}, {
   3.673141118204981*^9, 3.673141119043228*^9}, {3.673143153744055*^9, 
   3.673143156445366*^9}, {3.673144733824004*^9, 3.673144739718957*^9}, {
   3.6731515843968563`*^9, 3.67315159675119*^9}, {3.673152133141114*^9, 
   3.673152143766457*^9}, {3.673323981897853*^9, 3.6733239932992563`*^9}, {
   3.67332614524061*^9, 3.6733261491302767`*^9}, {3.673329410363263*^9, 
   3.673329412041313*^9}, {3.6733301025501137`*^9, 3.673330103552463*^9}, {
   3.673330391141528*^9, 3.673330392015518*^9}, {3.673330972142354*^9, 
   3.6733309733155527`*^9}, {3.67333259812778*^9, 3.673332611715108*^9}, {
   3.673332846404707*^9, 3.673332849186913*^9}, {3.6733344693482027`*^9, 
   3.673334470674493*^9}, {3.673334917144683*^9, 3.673334919551613*^9}, {
   3.673452231948052*^9, 3.673452233172964*^9}, {3.67376144771124*^9, 
   3.673761449765923*^9}, {3.673762565227644*^9, 3.673762566142223*^9}, {
   3.6738414016763077`*^9, 3.673841403264984*^9}, {3.673841913722795*^9, 
   3.673841914603649*^9}, {3.673844388368328*^9, 3.673844389210224*^9}, {
   3.673844650020645*^9, 3.673844650703499*^9}, {3.677369982731784*^9, 
   3.677369986454764*^9}, {3.677370447622026*^9, 3.677370449260198*^9}, {
   3.6776082761661987`*^9, 3.677608278982682*^9}, {3.677608525475278*^9, 
   3.677608526412114*^9}, {3.677615739041712*^9, 3.677615743674333*^9}, {
   3.677615822204801*^9, 3.677615824267688*^9}, {3.677616099203451*^9, 
   3.677616135474544*^9}, {3.677616233817958*^9, 3.677616234827898*^9}, {
   3.677616306589551*^9, 3.677616307768577*^9}, {3.6776163427049026`*^9, 
   3.677616382013188*^9}, {3.677628795401904*^9, 3.677628805478928*^9}, {
   3.6822685945847187`*^9, 3.682268595694191*^9}, {3.6822800929212427`*^9, 
   3.6822800950692387`*^9}, {3.6822812535435553`*^9, 3.68228125580882*^9}, {
   3.682281374399225*^9, 3.682281375482122*^9}, {3.6826965663328333`*^9, 
   3.682696568632247*^9}, {3.6925123100179567`*^9, 3.69251234031686*^9}, {
   3.692512522981163*^9, 3.692512526276197*^9}, {3.6925140654732857`*^9, 
   3.6925140669975557`*^9}, {3.6925142678661737`*^9, 3.69251426938305*^9}, {
   3.692514513908565*^9, 3.6925145152183104`*^9}, {3.692546787570361*^9, 
   3.692546788387909*^9}, {3.692547123868018*^9, 3.692547129108329*^9}, {
   3.692595522797427*^9, 3.692595526983211*^9}, {3.693716713489725*^9, 
   3.693716717494331*^9}, {3.6937168479140263`*^9, 3.693716855527012*^9}, {
   3.6960975807648983`*^9, 3.6960975835847816`*^9}, {3.696563253558247*^9, 
   3.696563278526478*^9}, 3.696563317147834*^9, {3.69656445278008*^9, 
   3.696564456397275*^9}, {3.69656618986312*^9, 3.6965661900415077`*^9}, {
   3.696569260513928*^9, 3.69656926384342*^9}, {3.696569837118264*^9, 
   3.696569839963835*^9}, {3.702095957472187*^9, 3.7020959626975327`*^9}, {
   3.702096529996467*^9, 3.70209653304147*^9}, {3.702101883401783*^9, 
   3.7021018880934258`*^9}, {3.702102288128048*^9, 3.702102289287963*^9}, {
   3.702102418935258*^9, 3.702102426487275*^9}, {3.702469593732791*^9, 
   3.7024695952071323`*^9}, {3.702469686794738*^9, 3.702469688060645*^9}, {
   3.702470195886283*^9, 3.702470195987872*^9}, {3.70247025531733*^9, 
   3.702470255458856*^9}, {3.702471393228657*^9, 3.702471401388249*^9}, {
   3.702472491943955*^9, 3.702472520118208*^9}, {3.702481034533146*^9, 
   3.7024810475610523`*^9}, 3.702482356457306*^9, {3.702482435649699*^9, 
   3.702482455179685*^9}, {3.702482799087942*^9, 3.702482808637529*^9}, 
   3.702507447753146*^9, {3.702509406455062*^9, 3.702509419814437*^9}, {
   3.702509561290934*^9, 3.7025095825524683`*^9}, {3.702509620242532*^9, 
   3.702509621098278*^9}, 3.702509720597459*^9, {3.702509800662324*^9, 
   3.7025098638433113`*^9}, {3.7025099005890913`*^9, 3.7025099452307*^9}, {
   3.7025113874934263`*^9, 3.702511396931369*^9}, {3.702511437634686*^9, 
   3.702511461389318*^9}, {3.702512185094224*^9, 3.702512189176845*^9}, {
   3.702512466506857*^9, 3.7025124714694138`*^9}, {3.702513006926819*^9, 
   3.7025130110007753`*^9}, {3.702513163418192*^9, 3.702513164594586*^9}, {
   3.70251648161614*^9, 3.7025164827694607`*^9}, {3.702516633903874*^9, 
   3.7025166340834303`*^9}, {3.702516673896756*^9, 3.702516681412279*^9}, {
   3.702516932317202*^9, 3.702516933054793*^9}, {3.702562529315987*^9, 
   3.7025625558151217`*^9}, {3.702564597263501*^9, 3.702564602645142*^9}, {
   3.702571603429942*^9, 3.702571603839892*^9}, {3.702571752818224*^9, 
   3.7025717561039953`*^9}, {3.702573053157105*^9, 3.70257305642293*^9}, {
   3.7025732895696783`*^9, 3.702573294080175*^9}, {3.702576546350718*^9, 
   3.7025765477349052`*^9}, {3.702576677954946*^9, 3.7025766788982058`*^9}, {
   3.702576944702092*^9, 3.7025769512839518`*^9}, {3.702596027058977*^9, 
   3.7025960308351593`*^9}, {3.7025974839032793`*^9, 3.702597503965905*^9}, {
   3.702598072730838*^9, 3.7025980753685007`*^9}, {3.7025984244897013`*^9, 
   3.702598430211032*^9}, {3.7025986001777554`*^9, 3.702598601721396*^9}, {
   3.702598635277529*^9, 3.702598638338502*^9}, {3.702598885363525*^9, 
   3.702598888538286*^9}, {3.702599808770001*^9, 3.7025998093325644`*^9}, {
   3.702600103144238*^9, 3.702600104149873*^9}, {3.7026008477149277`*^9, 
   3.7026008498628263`*^9}, {3.702600965010933*^9, 3.702600986858077*^9}, {
   3.702601032379504*^9, 3.702601034845749*^9}, {3.702601092131206*^9, 
   3.702601107628088*^9}, {3.702602445057652*^9, 3.702602449783873*^9}, {
   3.70260253470936*^9, 3.702602538425085*^9}, {3.702602597242291*^9, 
   3.702602605106901*^9}, {3.702602904393817*^9, 3.702602906481667*^9}, {
   3.702604638063805*^9, 3.702604674822218*^9}, {3.702604913242951*^9, 
   3.7026049148257713`*^9}, {3.702637148832757*^9, 3.702637170795683*^9}, {
   3.702637258196789*^9, 3.7026372898581448`*^9}, {3.702637431853889*^9, 
   3.702637435176393*^9}, {3.702637570367167*^9, 3.7026375764956017`*^9}, {
   3.702637780069415*^9, 3.702637782307193*^9}, {3.7026597660400257`*^9, 
   3.702659769257114*^9}, {3.702659864995763*^9, 3.702659866351164*^9}, {
   3.702683222148241*^9, 3.702683222488493*^9}, 3.7026845884801483`*^9, {
   3.702684746141087*^9, 3.702684746552732*^9}, {3.702695675069509*^9, 
   3.7026956777881327`*^9}, {3.7026957305607452`*^9, 3.702695737926909*^9}, {
   3.70269630613282*^9, 3.702696306472793*^9}, {3.702696503510229*^9, 
   3.702696509254643*^9}, {3.702696853059559*^9, 3.702696884318495*^9}, {
   3.702697269891591*^9, 3.7026972747437353`*^9}, {3.702697808974243*^9, 
   3.7026978114274607`*^9}, {3.70269792777709*^9, 3.702697959489936*^9}, {
   3.702698271721086*^9, 3.702698274524032*^9}, {3.7027005883546124`*^9, 
   3.7027005923621073`*^9}, {3.702701558548768*^9, 3.702701560858753*^9}, {
   3.7027024842457952`*^9, 3.702702485531762*^9}, 3.702702986018485*^9, {
   3.702703835144135*^9, 3.7027038353561*^9}, 3.7027054349525957`*^9, {
   3.702706615399864*^9, 3.7027066182501583`*^9}, {3.702708884496859*^9, 
   3.702708886181444*^9}, {3.702721985030258*^9, 3.7027219882000113`*^9}, {
   3.702724928039158*^9, 3.702724931186866*^9}, {3.702725426719936*^9, 
   3.702725429764462*^9}, {3.702727712878235*^9, 3.702727714645068*^9}, {
   3.702727767988468*^9, 3.702727768256044*^9}, 3.70272862903754*^9, {
   3.7027286944015217`*^9, 3.7027286948116713`*^9}, {3.702728875460835*^9, 
   3.702728887642188*^9}, 3.70272911319226*^9, {3.702733188066002*^9, 
   3.7027331883564777`*^9}, 3.702733537389166*^9, {3.702733665199657*^9, 
   3.702733665523652*^9}, 3.702734146836747*^9, {3.7027342523217583`*^9, 
   3.702734252534932*^9}, 3.702734323376067*^9, {3.702746111283703*^9, 
   3.702746113633271*^9}, {3.702746272304015*^9, 3.702746274952227*^9}, {
   3.702751694606956*^9, 3.7027517275665913`*^9}, {3.702776334481266*^9, 
   3.702776337445428*^9}, {3.702777248860635*^9, 3.702777251757118*^9}, {
   3.702785611257811*^9, 3.7027856211330748`*^9}, {3.702806839138578*^9, 
   3.702806840374284*^9}, {3.7028202730177917`*^9, 3.702820274908327*^9}, {
   3.7028209224764338`*^9, 3.702820922710919*^9}, {3.702820954192719*^9, 
   3.702820954437063*^9}, {3.702821061781996*^9, 3.702821065132842*^9}, {
   3.702821123772341*^9, 3.702821126613688*^9}, {3.70282116735529*^9, 
   3.702821171254588*^9}, {3.7028240001025543`*^9, 3.702824003528173*^9}, {
   3.702824162431761*^9, 3.702824164552782*^9}, {3.702899100652224*^9, 
   3.702899101591248*^9}, {3.702908099848566*^9, 3.702908152415694*^9}, 
   3.702909138728657*^9, {3.702913100017565*^9, 3.702913100253669*^9}, 
   3.7029131374067163`*^9, 3.702919973233938*^9, {3.7029865677644033`*^9, 
   3.70298658694488*^9}, {3.704735718442852*^9, 3.7047357186717157`*^9}, 
   3.704735784986566*^9, {3.704735990517077*^9, 3.7047359908165607`*^9}, 
   3.704736026691176*^9, {3.704736729946877*^9, 3.704736730509121*^9}, {
   3.704761703375286*^9, 3.704761704725349*^9}, 3.704764361253539*^9, {
   3.7050897510491247`*^9, 3.7050897535655413`*^9}, {3.705089807644816*^9, 
   3.705089818711872*^9}, {3.7060552929173326`*^9, 3.70605529390913*^9}, {
   3.710159421452835*^9, 3.710159425493452*^9}, {3.710163709013483*^9, 
   3.7101637122976427`*^9}, {3.710163955046075*^9, 3.7101639572810917`*^9}, {
   3.710179219500955*^9, 3.710179220720817*^9}, {3.710774278310836*^9, 
   3.7107742795395308`*^9}, {3.710774366686047*^9, 3.710774367596382*^9}, {
   3.710774426754599*^9, 3.7107744276890383`*^9}, {3.7107769403969593`*^9, 
   3.710776941829914*^9}, {3.710864956011348*^9, 3.7108649587311163`*^9}, {
   3.710865114609601*^9, 3.710865149512567*^9}, {3.71086532484015*^9, 
   3.710865325831327*^9}, {3.711312254826334*^9, 3.711312256007635*^9}, {
   3.711313473578124*^9, 3.7113134746325493`*^9}, {3.711313538362739*^9, 
   3.711313539370935*^9}, {3.712086459949098*^9, 3.712086464261816*^9}, {
   3.7120865169720087`*^9, 3.712086518479251*^9}},
 Background->RGBColor[1, 0.925, 0.925],
 ExpressionUUID -> "fe05df54-b7e8-4a03-a21d-82333737c476"],

Cell["\<\
Calculate
- the total number of photons
- the number of channels
- the number of words corresponding to the output distribution
- the factor due to the normalization of the wavefunction and POVM
- input word
- output word\
\>", "Text",
 CellChangeTimes->{{3.6436089861925793`*^9, 3.643609058415332*^9}, {
  3.647133663193893*^9, 3.647133667730901*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"nphotons", " ", "=", " ", 
   RowBox[{"Total", "[", "inputdist", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nchannels", " ", "=", " ", 
   RowBox[{"Length", "[", "inputdist", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uniquewords", " ", "=", " ", 
   RowBox[{
    RowBox[{"nphotons", "!"}], "/", 
    RowBox[{"Apply", "[", 
     RowBox[{"Times", ",", 
      RowBox[{"Map", "[", 
       RowBox[{"Factorial", ",", "outputdist"}], "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"normalization", " ", "=", " ", 
   RowBox[{
    RowBox[{"Apply", "[", 
     RowBox[{"Times", ",", 
      RowBox[{"Map", "[", 
       RowBox[{"Factorial", ",", "inputdist"}], "]"}]}], "]"}], "*", 
    RowBox[{"Apply", "[", 
     RowBox[{"Times", ",", 
      RowBox[{"Map", "[", 
       RowBox[{"Factorial", ",", "outputdist"}], "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"inputword", " ", "=", " ", 
  RowBox[{"Flatten", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ConstantArray", "[", 
      RowBox[{"i", ",", 
       RowBox[{"inputdist", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "inputdist", "]"}]}], "}"}]}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"inputword", " ", "=", " ", 
  RowBox[{"Permute", "[", 
   RowBox[{"inputword", ",", "inputpermutation"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"outputword", " ", "=", " ", 
  RowBox[{"Flatten", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ConstantArray", "[", 
      RowBox[{"i", ",", 
       RowBox[{"outputdist", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "outputdist", "]"}]}], "}"}]}], "]"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.6436007033739243`*^9, 3.6436007073488817`*^9}, {
   3.6436008799881687`*^9, 3.643600886061687*^9}, {3.64360246023202*^9, 
   3.643602462759058*^9}, {3.64360361735153*^9, 3.6436036423127403`*^9}, {
   3.643607106690818*^9, 3.6436071186030416`*^9}, {3.643612387199192*^9, 
   3.6436123979765787`*^9}, {3.6436127046115303`*^9, 3.643612709647593*^9}, {
   3.643645419416998*^9, 3.643645431513942*^9}, {3.647128571916294*^9, 
   3.6471285757914553`*^9}, {3.64713234987523*^9, 3.647132352985072*^9}, {
   3.6472137032742233`*^9, 3.647213705770382*^9}, {3.6738450608830967`*^9, 
   3.6738450626169*^9}, 3.692512066344832*^9, {3.6960992605084887`*^9, 
   3.696099271682272*^9}, {3.696099369837681*^9, 3.6960993727602997`*^9}, {
   3.696191836353341*^9, 3.696191839683031*^9}, {3.696191966108968*^9, 
   3.6961919670729103`*^9}, {3.6961925062785177`*^9, 3.696192507506144*^9}, {
   3.6961925378733883`*^9, 3.696192538782093*^9}, {3.6961926616007423`*^9, 
   3.696192664959443*^9}, {3.6961926995026903`*^9, 3.6961927007503653`*^9}, {
   3.696193020385069*^9, 3.696193023590469*^9}, {3.696193152156657*^9, 
   3.696193153216682*^9}, {3.6962671731039*^9, 3.696267173227747*^9}, {
   3.6962684520717707`*^9, 3.696268452176271*^9}, {3.696269065949791*^9, 
   3.696269066954226*^9}, {3.69627085015924*^9, 3.696270851784555*^9}, {
   3.6962708989467278`*^9, 3.696270900115822*^9}, {3.696271005762088*^9, 
   3.6962710066238127`*^9}, {3.696271061233728*^9, 3.696271062389233*^9}, {
   3.6962715077861233`*^9, 3.696271508913896*^9}, {3.6962715441969233`*^9, 
   3.696271545040305*^9}, {3.696271682936751*^9, 3.696271683789673*^9}, {
   3.696271825376959*^9, 3.6962718262698793`*^9}, {3.696272016787965*^9, 
   3.6962720181423264`*^9}, {3.6962720495960407`*^9, 3.696272050631528*^9}, {
   3.6962721259712133`*^9, 3.696272127032815*^9}, {3.69627957864473*^9, 
   3.696279579573985*^9}, {3.696279946225854*^9, 3.696279946494183*^9}, {
   3.696282416660492*^9, 3.696282416878262*^9}, {3.696563291172612*^9, 
   3.6965632932423553`*^9}},
 ExpressionUUID -> "969c8a4f-b00d-4d7c-a07a-738fa79e0813"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "2", ",", "3"}], "}"}]], "Output",
 CellChangeTimes->{{3.702469571032873*^9, 3.702469597296749*^9}, 
   3.702469688989553*^9, 3.70247019810108*^9, 3.702470261841568*^9, {
   3.702471397616684*^9, 3.702471403880574*^9}, {3.702472501547501*^9, 
   3.7024725213700542`*^9}, {3.70248103592286*^9, 3.702481053481544*^9}, 
   3.702482359086129*^9, {3.7024824429833717`*^9, 3.702482456521924*^9}, {
   3.7024828005790653`*^9, 3.7024828108098183`*^9}, 3.702507449190795*^9, {
   3.7025094086655416`*^9, 3.702509421213887*^9}, 3.70250958332957*^9, 
   3.702509622305529*^9, {3.7025097210941277`*^9, 3.702509748318342*^9}, {
   3.702509786378057*^9, 3.7025098025726957`*^9}, 3.702509832829151*^9, 
   3.702509865385399*^9, {3.702509904005179*^9, 3.702509946090067*^9}, 
   3.7025113988765707`*^9, {3.7025114392442207`*^9, 3.7025114632800617`*^9}, {
   3.7025130486447678`*^9, 3.7025130740150337`*^9}, 3.702513320753933*^9, 
   3.7025168190355663`*^9, {3.7025169353278913`*^9, 3.702516960448949*^9}, {
   3.702562518957118*^9, 3.7025625325190763`*^9}, {3.7025645902791157`*^9, 
   3.7025646033306513`*^9}, 3.702571412346579*^9, 3.702571605263884*^9, 
   3.702598716286675*^9, 3.702598889831387*^9, 3.7025989293215*^9, 
   3.702599810655203*^9, {3.702600972115129*^9, 3.7026009889695807`*^9}, {
   3.702601021591724*^9, 3.702601036717586*^9}, 3.70260260621784*^9, {
   3.7026371535098553`*^9, 3.702637172514566*^9}, 3.7026374811081743`*^9, 
   3.702659771935375*^9, 3.702659869752652*^9, 3.7026832777046747`*^9, 
   3.702684589107842*^9, 3.702684747936557*^9, 3.702695684343931*^9, 
   3.702695738381248*^9, 3.7026963075062857`*^9, 3.7026965104243813`*^9, {
   3.702696872709827*^9, 3.702696885838612*^9}, 3.70269727581358*^9, 
   3.702697814055936*^9, {3.702697932998901*^9, 3.702697960250832*^9}, 
   3.70270059337376*^9, 3.702702487406662*^9, 3.702702987336054*^9, 
   3.702703836135223*^9, 3.702705435829104*^9, 3.7027088873222923`*^9, 
   3.702722029525415*^9, 3.702727715823975*^9, 3.702727768780787*^9, 
   3.7027286298492393`*^9, {3.7027288557506657`*^9, 3.702728888859825*^9}, 
   3.70272911371634*^9, 3.70273319402*^9, 3.702733538859668*^9, 
   3.7027336676555767`*^9, 3.702734147650754*^9, 3.70273425319405*^9, 
   3.702735892668199*^9, 3.702743440513303*^9, 3.702746276043922*^9, 
   3.70275172865172*^9, 3.702753892510138*^9, 3.702785614112587*^9, 
   3.702820277726775*^9, 3.702820923516975*^9, 3.702820956268908*^9, 
   3.7028210666927557`*^9, 3.70282112846847*^9, 3.702821172206377*^9, 
   3.702824004926608*^9, 3.702824165639739*^9, 3.7028991040739613`*^9, {
   3.702908116688802*^9, 3.702908153379405*^9}, 3.702909139299223*^9, 
   3.702913102165073*^9, 3.702913139472206*^9, 3.702919974218903*^9, 
   3.702982160231192*^9, {3.7029865703275146`*^9, 3.702986588326756*^9}, 
   3.704734384145322*^9, 3.70473572717207*^9, 3.704735792995459*^9, {
   3.704736002637966*^9, 3.70473603076194*^9}, 3.704736731991805*^9, 
   3.7047369231382103`*^9, 3.704737109974566*^9, 3.704761706698764*^9, 
   3.704764363978464*^9, {3.705089797222213*^9, 3.705089813331683*^9}, 
   3.706055295993286*^9, 3.708804140126786*^9, 3.710027179720771*^9, 
   3.7101594293941813`*^9, 3.710163713897545*^9, 3.710163959308848*^9, 
   3.710179230147686*^9, 3.710774282732366*^9, 3.710774371254599*^9, 
   3.710774429372019*^9, 3.710776944097926*^9, 3.710864979147684*^9, 
   3.710865120925139*^9, 3.710865151132959*^9, 3.71086532723147*^9, 
   3.7108654771628933`*^9, 3.711312259454773*^9, 3.711313476810034*^9, 
   3.711313540674445*^9, 3.71208646930584*^9, 3.712086520912491*^9},
 ExpressionUUID -> "626dc0bc-7948-45de-b7ff-7ceaa8132ecd"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "2", ",", "3"}], "}"}]], "Output",
 CellChangeTimes->{{3.702469571032873*^9, 3.702469597296749*^9}, 
   3.702469688989553*^9, 3.70247019810108*^9, 3.702470261841568*^9, {
   3.702471397616684*^9, 3.702471403880574*^9}, {3.702472501547501*^9, 
   3.7024725213700542`*^9}, {3.70248103592286*^9, 3.702481053481544*^9}, 
   3.702482359086129*^9, {3.7024824429833717`*^9, 3.702482456521924*^9}, {
   3.7024828005790653`*^9, 3.7024828108098183`*^9}, 3.702507449190795*^9, {
   3.7025094086655416`*^9, 3.702509421213887*^9}, 3.70250958332957*^9, 
   3.702509622305529*^9, {3.7025097210941277`*^9, 3.702509748318342*^9}, {
   3.702509786378057*^9, 3.7025098025726957`*^9}, 3.702509832829151*^9, 
   3.702509865385399*^9, {3.702509904005179*^9, 3.702509946090067*^9}, 
   3.7025113988765707`*^9, {3.7025114392442207`*^9, 3.7025114632800617`*^9}, {
   3.7025130486447678`*^9, 3.7025130740150337`*^9}, 3.702513320753933*^9, 
   3.7025168190355663`*^9, {3.7025169353278913`*^9, 3.702516960448949*^9}, {
   3.702562518957118*^9, 3.7025625325190763`*^9}, {3.7025645902791157`*^9, 
   3.7025646033306513`*^9}, 3.702571412346579*^9, 3.702571605263884*^9, 
   3.702598716286675*^9, 3.702598889831387*^9, 3.7025989293215*^9, 
   3.702599810655203*^9, {3.702600972115129*^9, 3.7026009889695807`*^9}, {
   3.702601021591724*^9, 3.702601036717586*^9}, 3.70260260621784*^9, {
   3.7026371535098553`*^9, 3.702637172514566*^9}, 3.7026374811081743`*^9, 
   3.702659771935375*^9, 3.702659869752652*^9, 3.7026832777046747`*^9, 
   3.702684589107842*^9, 3.702684747936557*^9, 3.702695684343931*^9, 
   3.702695738381248*^9, 3.7026963075062857`*^9, 3.7026965104243813`*^9, {
   3.702696872709827*^9, 3.702696885838612*^9}, 3.70269727581358*^9, 
   3.702697814055936*^9, {3.702697932998901*^9, 3.702697960250832*^9}, 
   3.70270059337376*^9, 3.702702487406662*^9, 3.702702987336054*^9, 
   3.702703836135223*^9, 3.702705435829104*^9, 3.7027088873222923`*^9, 
   3.702722029525415*^9, 3.702727715823975*^9, 3.702727768780787*^9, 
   3.7027286298492393`*^9, {3.7027288557506657`*^9, 3.702728888859825*^9}, 
   3.70272911371634*^9, 3.70273319402*^9, 3.702733538859668*^9, 
   3.7027336676555767`*^9, 3.702734147650754*^9, 3.70273425319405*^9, 
   3.702735892668199*^9, 3.702743440513303*^9, 3.702746276043922*^9, 
   3.70275172865172*^9, 3.702753892510138*^9, 3.702785614112587*^9, 
   3.702820277726775*^9, 3.702820923516975*^9, 3.702820956268908*^9, 
   3.7028210666927557`*^9, 3.70282112846847*^9, 3.702821172206377*^9, 
   3.702824004926608*^9, 3.702824165639739*^9, 3.7028991040739613`*^9, {
   3.702908116688802*^9, 3.702908153379405*^9}, 3.702909139299223*^9, 
   3.702913102165073*^9, 3.702913139472206*^9, 3.702919974218903*^9, 
   3.702982160231192*^9, {3.7029865703275146`*^9, 3.702986588326756*^9}, 
   3.704734384145322*^9, 3.70473572717207*^9, 3.704735792995459*^9, {
   3.704736002637966*^9, 3.70473603076194*^9}, 3.704736731991805*^9, 
   3.7047369231382103`*^9, 3.704737109974566*^9, 3.704761706698764*^9, 
   3.704764363978464*^9, {3.705089797222213*^9, 3.705089813331683*^9}, 
   3.706055295993286*^9, 3.708804140126786*^9, 3.710027179720771*^9, 
   3.7101594293941813`*^9, 3.710163713897545*^9, 3.710163959308848*^9, 
   3.710179230147686*^9, 3.710774282732366*^9, 3.710774371254599*^9, 
   3.710774429372019*^9, 3.710776944097926*^9, 3.710864979147684*^9, 
   3.710865120925139*^9, 3.710865151132959*^9, 3.71086532723147*^9, 
   3.7108654771628933`*^9, 3.711312259454773*^9, 3.711313476810034*^9, 
   3.711313540674445*^9, 3.71208646930584*^9, 3.712086520914122*^9},
 ExpressionUUID -> "626dc0bc-7948-45de-b7ff-7ceaa8132ecd"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "2", ",", "3"}], "}"}]], "Output",
 CellChangeTimes->{{3.702469571032873*^9, 3.702469597296749*^9}, 
   3.702469688989553*^9, 3.70247019810108*^9, 3.702470261841568*^9, {
   3.702471397616684*^9, 3.702471403880574*^9}, {3.702472501547501*^9, 
   3.7024725213700542`*^9}, {3.70248103592286*^9, 3.702481053481544*^9}, 
   3.702482359086129*^9, {3.7024824429833717`*^9, 3.702482456521924*^9}, {
   3.7024828005790653`*^9, 3.7024828108098183`*^9}, 3.702507449190795*^9, {
   3.7025094086655416`*^9, 3.702509421213887*^9}, 3.70250958332957*^9, 
   3.702509622305529*^9, {3.7025097210941277`*^9, 3.702509748318342*^9}, {
   3.702509786378057*^9, 3.7025098025726957`*^9}, 3.702509832829151*^9, 
   3.702509865385399*^9, {3.702509904005179*^9, 3.702509946090067*^9}, 
   3.7025113988765707`*^9, {3.7025114392442207`*^9, 3.7025114632800617`*^9}, {
   3.7025130486447678`*^9, 3.7025130740150337`*^9}, 3.702513320753933*^9, 
   3.7025168190355663`*^9, {3.7025169353278913`*^9, 3.702516960448949*^9}, {
   3.702562518957118*^9, 3.7025625325190763`*^9}, {3.7025645902791157`*^9, 
   3.7025646033306513`*^9}, 3.702571412346579*^9, 3.702571605263884*^9, 
   3.702598716286675*^9, 3.702598889831387*^9, 3.7025989293215*^9, 
   3.702599810655203*^9, {3.702600972115129*^9, 3.7026009889695807`*^9}, {
   3.702601021591724*^9, 3.702601036717586*^9}, 3.70260260621784*^9, {
   3.7026371535098553`*^9, 3.702637172514566*^9}, 3.7026374811081743`*^9, 
   3.702659771935375*^9, 3.702659869752652*^9, 3.7026832777046747`*^9, 
   3.702684589107842*^9, 3.702684747936557*^9, 3.702695684343931*^9, 
   3.702695738381248*^9, 3.7026963075062857`*^9, 3.7026965104243813`*^9, {
   3.702696872709827*^9, 3.702696885838612*^9}, 3.70269727581358*^9, 
   3.702697814055936*^9, {3.702697932998901*^9, 3.702697960250832*^9}, 
   3.70270059337376*^9, 3.702702487406662*^9, 3.702702987336054*^9, 
   3.702703836135223*^9, 3.702705435829104*^9, 3.7027088873222923`*^9, 
   3.702722029525415*^9, 3.702727715823975*^9, 3.702727768780787*^9, 
   3.7027286298492393`*^9, {3.7027288557506657`*^9, 3.702728888859825*^9}, 
   3.70272911371634*^9, 3.70273319402*^9, 3.702733538859668*^9, 
   3.7027336676555767`*^9, 3.702734147650754*^9, 3.70273425319405*^9, 
   3.702735892668199*^9, 3.702743440513303*^9, 3.702746276043922*^9, 
   3.70275172865172*^9, 3.702753892510138*^9, 3.702785614112587*^9, 
   3.702820277726775*^9, 3.702820923516975*^9, 3.702820956268908*^9, 
   3.7028210666927557`*^9, 3.70282112846847*^9, 3.702821172206377*^9, 
   3.702824004926608*^9, 3.702824165639739*^9, 3.7028991040739613`*^9, {
   3.702908116688802*^9, 3.702908153379405*^9}, 3.702909139299223*^9, 
   3.702913102165073*^9, 3.702913139472206*^9, 3.702919974218903*^9, 
   3.702982160231192*^9, {3.7029865703275146`*^9, 3.702986588326756*^9}, 
   3.704734384145322*^9, 3.70473572717207*^9, 3.704735792995459*^9, {
   3.704736002637966*^9, 3.70473603076194*^9}, 3.704736731991805*^9, 
   3.7047369231382103`*^9, 3.704737109974566*^9, 3.704761706698764*^9, 
   3.704764363978464*^9, {3.705089797222213*^9, 3.705089813331683*^9}, 
   3.706055295993286*^9, 3.708804140126786*^9, 3.710027179720771*^9, 
   3.7101594293941813`*^9, 3.710163713897545*^9, 3.710163959308848*^9, 
   3.710179230147686*^9, 3.710774282732366*^9, 3.710774371254599*^9, 
   3.710774429372019*^9, 3.710776944097926*^9, 3.710864979147684*^9, 
   3.710865120925139*^9, 3.710865151132959*^9, 3.71086532723147*^9, 
   3.7108654771628933`*^9, 3.711312259454773*^9, 3.711313476810034*^9, 
   3.711313540674445*^9, 3.71208646930584*^9, 3.712086520915518*^9},
 ExpressionUUID -> "626dc0bc-7948-45de-b7ff-7ceaa8132ecd"]
}, Open  ]],

Cell["\<\
The list is a vector with each index corresponding to each frequency \
variable. The entries are the channels (expressed as delay variables) in \
which the inputs photons were. We call these the phases.\
\>", "Text",
 CellChangeTimes->{{3.643609067721588*^9, 3.6436091384181833`*^9}, {
  3.643609902873415*^9, 3.643609907960125*^9}, {3.683505581831818*^9, 
  3.683505582507188*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"inputtaus", " ", "=", " ", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Subscript", "[", 
     RowBox[{"\[Tau]", ",", "i"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "nphotons"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{"(*", 
   RowBox[{"inputtaus", "=", 
    RowBox[{"Permute", "[", 
     RowBox[{"inputtaus", ",", "inputpermutation"}], "]"}]}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.643600629434431*^9, 3.64360064343703*^9}, {
   3.643602416465149*^9, 3.643602421079155*^9}, 3.6436029013083973`*^9, {
   3.67304497311657*^9, 3.673044975790825*^9}, {3.673046052325045*^9, 
   3.673046079166574*^9}, {3.673329626775543*^9, 3.673329627218115*^9}, 
   3.673330118841947*^9, {3.673330425986174*^9, 3.67333047108928*^9}, {
   3.673330904707602*^9, 3.6733309158774157`*^9}, {3.673330997968594*^9, 
   3.6733310226852694`*^9}, {3.6733313686677923`*^9, 
   3.6733313768104486`*^9}, {3.673332432680971*^9, 3.6733324377449837`*^9}, {
   3.673332853071681*^9, 3.67333286448102*^9}, {3.6835087978469543`*^9, 
   3.683508804191559*^9}, {3.684274644980596*^9, 3.684274651772459*^9}, {
   3.69619186438135*^9, 3.696191931024104*^9}, {3.696191970863138*^9, 
   3.6961919712915583`*^9}, 3.696192510409196*^9, {3.6961925422937737`*^9, 
   3.696192542571875*^9}, {3.696192668208301*^9, 3.696192668329112*^9}, {
   3.696192703274898*^9, 3.696192703415341*^9}, {3.696193026878469*^9, 
   3.696193027189204*^9}, {3.6961931563069696`*^9, 3.696193156435804*^9}, {
   3.696268428076783*^9, 3.696268428210168*^9}, {3.696269069265308*^9, 
   3.6962690695275583`*^9}, {3.696270748279986*^9, 3.696270749076486*^9}, {
   3.6962708552879353`*^9, 3.696270855755619*^9}, {3.696270894855493*^9, 
   3.696270895569908*^9}, {3.696271002339291*^9, 3.696271002718774*^9}, {
   3.696272011634452*^9, 3.6962720531016607`*^9}, {3.696272129323411*^9, 
   3.696272129726449*^9}, {3.696279582790657*^9, 3.6962795836646748`*^9}, 
   3.696279949184925*^9, {3.6962824199754133`*^9, 3.696282420237813*^9}, 
   3.696282459473501*^9, {3.696356417860567*^9, 3.696356420930139*^9}, 
   3.696563286212397*^9, {3.702513015082049*^9, 3.70251301762225*^9}, {
   3.702513316507017*^9, 3.702513318517189*^9}, {3.7026046867736473`*^9, 
   3.70260468937008*^9}, {3.7026048685962963`*^9, 3.702604869906116*^9}, {
   3.702637141373564*^9, 3.702637143834428*^9}, {3.7026372101029387`*^9, 
   3.702637212949531*^9}, {3.702637263990807*^9, 3.7026372663005953`*^9}, {
   3.702637339948943*^9, 3.702637342389942*^9}, {3.702637448359185*^9, 
   3.702637450723886*^9}, {3.702637638172937*^9, 3.702637640246686*^9}, {
   3.702637772258209*^9, 3.702637776733778*^9}},
 ExpressionUUID -> "79b01b21-3d02-4d96-85d1-4887f0201875"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   SubscriptBox["\[Tau]", "1"], ",", 
   SubscriptBox["\[Tau]", "2"], ",", 
   SubscriptBox["\[Tau]", "3"]}], "}"}]], "Output",
 CellChangeTimes->{{3.702469571066551*^9, 3.7024695973219*^9}, 
   3.702469688997642*^9, 3.702470198109639*^9, 3.702470261852824*^9, {
   3.702472501570518*^9, 3.7024725213781013`*^9}, {3.7024810359556007`*^9, 
   3.7024810534898443`*^9}, 3.702482359120418*^9, {3.702482442991192*^9, 
   3.7024824565412893`*^9}, {3.7024828005866537`*^9, 3.702482810831984*^9}, 
   3.702507449209249*^9, {3.7025094086869087`*^9, 3.702509421237359*^9}, 
   3.7025095833372097`*^9, 3.702509622313506*^9, {3.7025097211020203`*^9, 
   3.702509748360331*^9}, {3.702509786405898*^9, 3.702509802596884*^9}, 
   3.7025098328494053`*^9, 3.702509865393355*^9, {3.702509904012313*^9, 
   3.7025099460987062`*^9}, 3.702511398884507*^9, {3.70251143925359*^9, 
   3.702511463288756*^9}, {3.7025130486786823`*^9, 3.702513074147172*^9}, 
   3.702513320765224*^9, 3.702516819046139*^9, {3.702516935342767*^9, 
   3.702516960462463*^9}, {3.702562519035554*^9, 3.702562532591228*^9}, {
   3.702564590325602*^9, 3.702564603338447*^9}, 3.702571412378295*^9, 
   3.702571605287694*^9, 3.7025987163023767`*^9, 3.702598889866816*^9, 
   3.702598929368586*^9, 3.702599810689785*^9, {3.702600972126295*^9, 
   3.702600988987357*^9}, {3.702601021627713*^9, 3.702601036748989*^9}, 
   3.7026026062501907`*^9, 3.702604730820381*^9, {3.702637153536448*^9, 
   3.702637172540749*^9}, 3.702637481148099*^9, 3.7026597720261297`*^9, 
   3.702659869810087*^9, 3.70268327781706*^9, 3.702684589131488*^9, 
   3.702684747962545*^9, 3.7026956843724203`*^9, 3.702695738405423*^9, 
   3.7026963075256147`*^9, 3.7026965104313707`*^9, {3.702696872735921*^9, 
   3.702696885865271*^9}, 3.7026972758358393`*^9, 3.702697814081976*^9, {
   3.7026979330071793`*^9, 3.7026979602697353`*^9}, 3.702700593386548*^9, 
   3.7027024874171677`*^9, 3.702702987360408*^9, 3.702703836146832*^9, 
   3.7027054358554*^9, 3.702708887335176*^9, 3.7027220295602703`*^9, 
   3.702727715831965*^9, 3.7027277688068523`*^9, 3.702728629875709*^9, {
   3.702728855787526*^9, 3.702728888883897*^9}, 3.702729113725113*^9, 
   3.702733194032655*^9, 3.702733538883297*^9, 3.702733667678587*^9, 
   3.702734147661643*^9, 3.702734253204674*^9, 3.7027358927036743`*^9, 
   3.7027434405438633`*^9, 3.702746276119092*^9, 3.702751728659936*^9, 
   3.702753892517868*^9, 3.702785614119998*^9, 3.702820277813575*^9, 
   3.702820923538072*^9, 3.7028209562760963`*^9, 3.7028210667212133`*^9, 
   3.702821128491691*^9, 3.702821172219864*^9, 3.702824005015736*^9, 
   3.7028241656677856`*^9, 3.702899104158515*^9, {3.702908116765766*^9, 
   3.7029081533867617`*^9}, 3.702909139306452*^9, 3.702913102185976*^9, 
   3.702913139498784*^9, 3.7029199742945633`*^9, 3.7029821603189297`*^9, {
   3.702986570402878*^9, 3.702986588407845*^9}, 3.704734384225649*^9, 
   3.7047357271837187`*^9, 3.7047357930151463`*^9, {3.7047360026734133`*^9, 
   3.704736030768834*^9}, 3.704736732016445*^9, 3.70473692318202*^9, 
   3.704737110024096*^9, 3.704761706775302*^9, 3.70476436406339*^9, {
   3.705089797306612*^9, 3.70508981340371*^9}, 3.706055296078619*^9, 
   3.708804140209395*^9, 3.710027179733686*^9, 3.710159429401743*^9, 
   3.71016371396984*^9, 3.710163959330681*^9, 3.710179230155438*^9, 
   3.710774282806719*^9, 3.7107743713300333`*^9, 3.7107744294474363`*^9, 
   3.710776944176388*^9, 3.710864979155192*^9, 3.710865120950247*^9, 
   3.710865151140366*^9, 3.7108653272652683`*^9, 3.7108654772005444`*^9, 
   3.711312259530633*^9, 3.711313476821583*^9, 3.7113135406821632`*^9, 
   3.7120864693911877`*^9, 3.7120865209903183`*^9},
 ExpressionUUID -> "59593d84-7ae3-4d8f-bcc0-2ad73b7e38de"]
}, Open  ]],

Cell["The words corresponding to the output configuration", "Text",
 CellChangeTimes->{{3.6436091974241457`*^9, 3.643609208614133*^9}, 
   3.682697142287814*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"outputwords", " ", "=", " ", 
   RowBox[{"Permutations", "[", "outputword", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"noutputwords", " ", "=", " ", 
   RowBox[{"Length", "[", "outputwords", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"vvector", " ", "=", " ", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Apply", "[", 
     RowBox[{"Times", ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Subscript", "[", 
         RowBox[{"U", ",", 
          RowBox[{"ToExpression", "[", 
           RowBox[{
            RowBox[{"ToString", "[", 
             RowBox[{"inputword", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "]"}], "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{
              RowBox[{"outputwords", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "j", "]"}], "]"}], "]"}]}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "nphotons"}], "}"}]}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "uniquewords"}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.643600779310021*^9, 3.6436007799852133`*^9}, {
   3.643601688138*^9, 3.643601689761088*^9}, {3.643602410563664*^9, 
   3.643602413203109*^9}, {3.643645425458413*^9, 3.6436454258217983`*^9}, {
   3.647122481388741*^9, 3.647122485322937*^9}, {3.647132347964672*^9, 
   3.647132356978148*^9}, {3.673055518403865*^9, 3.673055552661477*^9}, {
   3.673055617051785*^9, 3.673055643487081*^9}, {3.6733292860282173`*^9, 
   3.673329288745943*^9}, {3.6733296158883867`*^9, 3.673329624361185*^9}, {
   3.6738414139182262`*^9, 3.673841415691887*^9}, 3.692512564977085*^9, 
   3.696279478051526*^9, 3.696561180921638*^9, {3.7021029207247972`*^9, 
   3.70210292459621*^9}},
 ExpressionUUID -> "3403f762-acdb-4c91-ac93-18fb2c92a9e6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SubscriptBox["U", "11"], " ", 
    SubscriptBox["U", "22"], " ", 
    SubscriptBox["U", "33"]}], ",", 
   RowBox[{
    SubscriptBox["U", "11"], " ", 
    SubscriptBox["U", "23"], " ", 
    SubscriptBox["U", "32"]}], ",", 
   RowBox[{
    SubscriptBox["U", "12"], " ", 
    SubscriptBox["U", "21"], " ", 
    SubscriptBox["U", "33"]}], ",", 
   RowBox[{
    SubscriptBox["U", "12"], " ", 
    SubscriptBox["U", "23"], " ", 
    SubscriptBox["U", "31"]}], ",", 
   RowBox[{
    SubscriptBox["U", "13"], " ", 
    SubscriptBox["U", "21"], " ", 
    SubscriptBox["U", "32"]}], ",", 
   RowBox[{
    SubscriptBox["U", "13"], " ", 
    SubscriptBox["U", "22"], " ", 
    SubscriptBox["U", "31"]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.702102921284745*^9, 3.702102925194409*^9}, {
   3.702469571097262*^9, 3.702469597344307*^9}, 3.7024696890228167`*^9, 
   3.70247019813354*^9, 3.702470261899097*^9, 3.702471411723023*^9, {
   3.702472501595199*^9, 3.702472521403191*^9}, {3.702481035979806*^9, 
   3.702481053536524*^9}, 3.702482359142049*^9, {3.702482443014935*^9, 
   3.702482456561247*^9}, {3.7024828006096563`*^9, 3.702482810854204*^9}, 
   3.7025074492319107`*^9, {3.702509408709651*^9, 3.70250942126073*^9}, 
   3.7025095833627768`*^9, 3.702509622339176*^9, {3.702509721127123*^9, 
   3.702509748398759*^9}, {3.7025097864291887`*^9, 3.702509802650258*^9}, 
   3.702509832868596*^9, 3.702509865418057*^9, {3.702509904033249*^9, 
   3.7025099461225357`*^9}, 3.702511398907666*^9, {3.7025114392756577`*^9, 
   3.702511463310958*^9}, {3.7025130487138853`*^9, 3.702513074326756*^9}, 
   3.702513320898572*^9, 3.702516819073312*^9, {3.702516935368917*^9, 
   3.702516960487207*^9}, {3.702562519219626*^9, 3.702562532662828*^9}, {
   3.702564590367076*^9, 3.7025646033643913`*^9}, 3.702571412400845*^9, 
   3.702571605309882*^9, 3.702598716348098*^9, 3.7025988898953257`*^9, 
   3.7025989294161386`*^9, 3.702599810714862*^9, {3.702600972154995*^9, 
   3.702600989018108*^9}, {3.7026010216619263`*^9, 3.702601036781596*^9}, 
   3.702602606279875*^9, {3.702637153557206*^9, 3.702637172560337*^9}, 
   3.702637481180889*^9, 3.7026597720756083`*^9, 3.702659869859982*^9, 
   3.702683277907979*^9, 3.702684589151823*^9, 3.702684747983704*^9, 
   3.7026956845150623`*^9, 3.7026957384276943`*^9, 3.7026963075462837`*^9, 
   3.702696510449204*^9, {3.7026968727558823`*^9, 3.702696885885605*^9}, 
   3.7026972758411207`*^9, 3.7026978141000137`*^9, {3.702697933026799*^9, 
   3.7026979602865667`*^9}, 3.702700593407655*^9, 3.702702487465765*^9, 
   3.702702987380065*^9, 3.702703836170362*^9, 3.702705435876021*^9, 
   3.7027088873600197`*^9, 3.702722029583507*^9, 3.7027277158589487`*^9, 
   3.7027277688292017`*^9, 3.7027286298967733`*^9, {3.702728855823297*^9, 
   3.702728888904394*^9}, 3.702729113745615*^9, 3.7027331940603333`*^9, 
   3.702733538903901*^9, 3.70273366770054*^9, 3.7027341476828327`*^9, 
   3.7027342532828693`*^9, 3.702735892734174*^9, 3.702743440565647*^9, 
   3.702746276194077*^9, 3.702751728688878*^9, 3.702753892539318*^9, 
   3.7027856141411333`*^9, 3.702820277888503*^9, 3.702820923556645*^9, 
   3.7028209562996407`*^9, 3.702821066741699*^9, 3.702821128511713*^9, 
   3.702821172242818*^9, 3.702824005098921*^9, 3.702824165691134*^9, 
   3.702899104233726*^9, {3.702908116844606*^9, 3.702908153409834*^9}, 
   3.7029091393300343`*^9, 3.702913102206628*^9, 3.702913139520639*^9, 
   3.702919974373934*^9, 3.702982160427745*^9, {3.702986570473403*^9, 
   3.7029865884804697`*^9}, 3.704734384300465*^9, 3.704735727204135*^9, 
   3.704735793034461*^9, {3.7047360027037477`*^9, 3.704736030804833*^9}, 
   3.7047367320419397`*^9, 3.704736923215886*^9, 3.70473711006376*^9, 
   3.704761706850811*^9, 3.704764364136935*^9, {3.705089797492031*^9, 
   3.7050898134741163`*^9}, 3.706055296149864*^9, 3.7088041402822437`*^9, 
   3.71002717975893*^9, 3.710159429427257*^9, 3.710163714044733*^9, 
   3.7101639593512173`*^9, 3.710179230179173*^9, 3.710774282882193*^9, 
   3.710774371403153*^9, 3.710774429518581*^9, 3.710776944250049*^9, 
   3.710864979179668*^9, 3.710865120972909*^9, 3.710865151161578*^9, 
   3.710865327297039*^9, 3.710865477225857*^9, 3.711312259603551*^9, 
   3.7113134768426323`*^9, 3.711313540704885*^9, 3.712086469468367*^9, 
   3.712086521116015*^9},
 ExpressionUUID -> "bea4d877-1f55-46a4-840a-f15a19b13e21"]
}, Open  ]],

Cell["\<\
Detection results in various transformations from the input frequencies to \
the detected ones. Each entry in this list corresponds to one such \
transformation.\
\>", "Text",
 CellChangeTimes->{{3.6436091716487513`*^9, 3.6436091788641663`*^9}, {
   3.643609216350312*^9, 3.643609281187804*^9}, 3.682697147439858*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"permutationcombs", " ", "=", " ", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Apply", "[", 
      RowBox[{"Outer", ",", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", "List", "}"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{"Factorial", "[", 
             RowBox[{"outputdist", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "nchannels"}], "}"}]}], "]"}]}], "]"}]}], "]"}],
      ",", 
     RowBox[{"Range", "[", "nchannels", "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.643600890279058*^9, 3.6436008937062893`*^9}, {
   3.643601636159626*^9, 3.643601638795483*^9}, {3.6436024365717173`*^9, 
   3.6436024368298407`*^9}, {3.643602826006589*^9, 3.643602829860251*^9}, {
   3.643611352856986*^9, 3.643611381543642*^9}, {3.6436114189163303`*^9, 
   3.6436114190435658`*^9}, {3.6436114635900993`*^9, 
   3.6436115276708527`*^9}, {3.643650704879425*^9, 3.6436507081319933`*^9}, 
   3.673841424599286*^9, 3.692512285022995*^9, 3.6965611754981403`*^9},
 ExpressionUUID -> "eb6c40b8-4e08-43b7-a4f0-14b1927e50c3"],

Cell["\<\
Here are the actual possible transformations corresponding to each output \
port.\
\>", "Text",
 CellChangeTimes->{{3.643609296504184*^9, 3.6436093214118023`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"outputwordperms", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Permutations", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Position", "[", 
        RowBox[{"outputword", ",", "i"}], "]"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "nchannels"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.643601876629016*^9, 3.64360190585225*^9}, {
   3.6436024272602377`*^9, 3.643602429697255*^9}, 3.652220424342286*^9, {
   3.673329352138795*^9, 3.673329381430142*^9}, 3.673841425586051*^9, 
   3.692512047865033*^9, 3.696561176315899*^9},
 ExpressionUUID -> "6f6e70b8-8318-4517-b93c-c7d4db9fc2c5"],

Cell["\<\
Using the above, create a list of list of phases. Each element is a list of \
phases corresponding to one word.\
\>", "Text",
 CellChangeTimes->{{3.643609871331644*^9, 3.643609919442646*^9}, 
   3.6776082960586863`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"phases", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"freqperm", " ", "=", " ", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{
              RowBox[{"outputwords", "[", 
               RowBox[{"[", "m", "]"}], "]"}], ",", "k"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "nchannels"}], "}"}]}], "]"}], "]"}]}], ";", 
        RowBox[{"Permute", "[", 
         RowBox[{"inputtaus", ",", 
          RowBox[{
           RowBox[{"Range", "[", "nphotons", "]"}], "/.", 
           RowBox[{"Thread", "[", 
            RowBox[{"Rule", "[", 
             RowBox[{"freqperm", ",", 
              RowBox[{"Flatten", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"outputwordperms", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"permutationcombs", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", "nchannels"}], "}"}]}], "]"}], "]"}]}], 
             "]"}], "]"}]}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "permutationcombs", "]"}]}], "}"}]}], "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "uniquewords"}], "}"}]}], "]"}]}], " ", 
  ";"}]], "Input",
 CellChangeTimes->{{3.643604215051797*^9, 3.643604240261505*^9}, {
   3.64360433268126*^9, 3.643604436016824*^9}, {3.6436045132224913`*^9, 
   3.643604536643573*^9}, {3.643604606011339*^9, 3.643604606811653*^9}, {
   3.643604643907631*^9, 3.6436046448532248`*^9}, 3.6436117095389233`*^9, 
   3.643656834019087*^9, {3.6471221788441753`*^9, 3.647122199176426*^9}, {
   3.6733292977231083`*^9, 3.67332931375158*^9}, 3.673329385749482*^9, 
   3.673841427297411*^9, 3.6925121018332033`*^9, 3.696561199627715*^9},
 ExpressionUUID -> "18d426b3-a1b1-4df0-a16b-fe49368c243a"],

Cell["\<\
The rate matrix can be calculate simply by multiplying appropriate phases and \
integrating.\
\>", "Text",
 CellChangeTimes->{{3.643609926112221*^9, 3.6436099667824373`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"MrWizard1", " ", "from", " ", 
     RowBox[{"http", ":"}]}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"mathematica", ".", "stackexchange", ".", "com"}], "/", 
        "questions"}], "/", "7887"}], "/", "best"}], "-", "way", "-", "to", 
     "-", "create", "-", "symmetric", "-", "matrices"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"FastSymmetricMatrixCalculator", "[", 
      RowBox[{"n_", ",", "f_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{"#", ",", 
         RowBox[{"Rest", "/@", 
          RowBox[{"#", "~", "Flatten", "~", 
           RowBox[{"{", "2", "}"}]}]}], ",", "2"}], "]"}], "&"}], "@", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"i", "~", "f", "~", "j"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "n"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "i"}], "}"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"REntry", "[", 
       RowBox[{"n1_", ",", "n2_"}], "]"}], " ", ":=", " ", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{"Simplify", "[", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"d", "[", 
                 RowBox[{"[", "k", "]"}], "]"}], "===", "0"}], ",", "0", ",", 
               
               RowBox[{
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"s", "^", "2"}]}], 
                 RowBox[{
                  RowBox[{
                   RowBox[{"d", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "^", "2"}], "/", "2"}]}], 
                " ", "+", " ", 
                RowBox[{"I", " ", "w0", " ", 
                 RowBox[{"d", "[", 
                  RowBox[{"[", "k", "]"}], "]"}]}]}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "nphotons"}], "}"}]}], "]"}], "]"}], "]"}], 
         "/", "normalization"}], ",", 
        RowBox[{"{", 
         RowBox[{"d", ",", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Outer", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"#1", "-", "#2"}], "&"}], ",", 
              RowBox[{"phases", "[", 
               RowBox[{"[", "n1", "]"}], "]"}], ",", 
              RowBox[{"phases", "[", 
               RowBox[{"[", "n2", "]"}], "]"}], ",", "1"}], "]"}], ",", "1"}],
            "]"}]}], "  ", "}"}]}], "]"}]}], ";"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"R", " ", "=", " ", 
     RowBox[{"FastSymmetricMatrixCalculator", "[", 
      RowBox[{"uniquewords", ",", "REntry"}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6436034293631153`*^9, 3.643603430729287*^9}, {
   3.6436036452948017`*^9, 3.643603646616407*^9}, {3.643606749900938*^9, 
   3.643606754291605*^9}, {3.643606853799705*^9, 3.643606870624839*^9}, {
   3.6436070047673798`*^9, 3.643607020849152*^9}, {3.643607123244136*^9, 
   3.6436072505466433`*^9}, 3.643607431812676*^9, 3.6436083348400183`*^9, {
   3.6436094051022587`*^9, 3.643609479465283*^9}, {3.643609685141212*^9, 
   3.643609706450014*^9}, {3.643609749758381*^9, 3.6436097963542147`*^9}, {
   3.6436099946469603`*^9, 3.643610001864996*^9}, 3.643611361637236*^9, {
   3.6436115478747587`*^9, 3.6436115699038963`*^9}, 3.643612863218288*^9, 
   3.643645436792832*^9, 3.643667989551588*^9, 3.6471204444742603`*^9, {
   3.673329514837044*^9, 3.673329539917852*^9}, {3.673330205063508*^9, 
   3.673330283418886*^9}, {3.6734994688949623`*^9, 3.673499516133524*^9}, {
   3.6734995528961363`*^9, 3.673499578823101*^9}, {3.673501461833869*^9, 
   3.673501469003357*^9}, {3.673501958239484*^9, 3.673501979263432*^9}},
 ExpressionUUID -> "09b6abd8-3d0a-486c-a199-4a73887b95bb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"R", " ", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.673329426795864*^9, 3.673329445491034*^9}, 
   3.67350202341892*^9, 3.696270863246983*^9},
 ExpressionUUID -> "d6aeaf1d-b9f7-436e-a9a6-0a9e28a04431"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["s", "2"]}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["\[Tau]", "2"], "-", 
           SubscriptBox["\[Tau]", "3"]}], ")"}], "2"]}]], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["s", "2"]}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["\[Tau]", "1"], "-", 
           SubscriptBox["\[Tau]", "2"]}], ")"}], "2"]}]], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["s", "2"]}], " ", 
        RowBox[{"(", 
         RowBox[{
          SubsuperscriptBox["\[Tau]", "1", "2"], "+", 
          SubsuperscriptBox["\[Tau]", "2", "2"], "-", 
          RowBox[{
           SubscriptBox["\[Tau]", "2"], " ", 
           SubscriptBox["\[Tau]", "3"]}], "+", 
          SubsuperscriptBox["\[Tau]", "3", "2"], "-", 
          RowBox[{
           SubscriptBox["\[Tau]", "1"], " ", 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["\[Tau]", "2"], "+", 
             SubscriptBox["\[Tau]", "3"]}], ")"}]}]}], ")"}]}]], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["s", "2"]}], " ", 
        RowBox[{"(", 
         RowBox[{
          SubsuperscriptBox["\[Tau]", "1", "2"], "+", 
          SubsuperscriptBox["\[Tau]", "2", "2"], "-", 
          RowBox[{
           SubscriptBox["\[Tau]", "2"], " ", 
           SubscriptBox["\[Tau]", "3"]}], "+", 
          SubsuperscriptBox["\[Tau]", "3", "2"], "-", 
          RowBox[{
           SubscriptBox["\[Tau]", "1"], " ", 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["\[Tau]", "2"], "+", 
             SubscriptBox["\[Tau]", "3"]}], ")"}]}]}], ")"}]}]], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["s", "2"]}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["\[Tau]", "1"], "-", 
           SubscriptBox["\[Tau]", "3"]}], ")"}], "2"]}]]},
     {
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["s", "2"]}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["\[Tau]", "2"], "-", 
           SubscriptBox["\[Tau]", "3"]}], ")"}], "2"]}]], "1", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["s", "2"]}], " ", 
        RowBox[{"(", 
         RowBox[{
          SubsuperscriptBox["\[Tau]", "1", "2"], "+", 
          SubsuperscriptBox["\[Tau]", "2", "2"], "-", 
          RowBox[{
           SubscriptBox["\[Tau]", "2"], " ", 
           SubscriptBox["\[Tau]", "3"]}], "+", 
          SubsuperscriptBox["\[Tau]", "3", "2"], "-", 
          RowBox[{
           SubscriptBox["\[Tau]", "1"], " ", 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["\[Tau]", "2"], "+", 
             SubscriptBox["\[Tau]", "3"]}], ")"}]}]}], ")"}]}]], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["s", "2"]}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["\[Tau]", "1"], "-", 
           SubscriptBox["\[Tau]", "3"]}], ")"}], "2"]}]], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["s", "2"]}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["\[Tau]", "1"], "-", 
           SubscriptBox["\[Tau]", "2"]}], ")"}], "2"]}]], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["s", "2"]}], " ", 
        RowBox[{"(", 
         RowBox[{
          SubsuperscriptBox["\[Tau]", "1", "2"], "+", 
          SubsuperscriptBox["\[Tau]", "2", "2"], "-", 
          RowBox[{
           SubscriptBox["\[Tau]", "2"], " ", 
           SubscriptBox["\[Tau]", "3"]}], "+", 
          SubsuperscriptBox["\[Tau]", "3", "2"], "-", 
          RowBox[{
           SubscriptBox["\[Tau]", "1"], " ", 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["\[Tau]", "2"], "+", 
             SubscriptBox["\[Tau]", "3"]}], ")"}]}]}], ")"}]}]]},
     {
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["s", "2"]}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["\[Tau]", "1"], "-", 
           SubscriptBox["\[Tau]", "2"]}], ")"}], "2"]}]], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["s", "2"]}], " ", 
        RowBox[{"(", 
         RowBox[{
          SubsuperscriptBox["\[Tau]", "1", "2"], "+", 
          SubsuperscriptBox["\[Tau]", "2", "2"], "-", 
          RowBox[{
           SubscriptBox["\[Tau]", "2"], " ", 
           SubscriptBox["\[Tau]", "3"]}], "+", 
          SubsuperscriptBox["\[Tau]", "3", "2"], "-", 
          RowBox[{
           SubscriptBox["\[Tau]", "1"], " ", 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["\[Tau]", "2"], "+", 
             SubscriptBox["\[Tau]", "3"]}], ")"}]}]}], ")"}]}]], "1", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["s", "2"]}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["\[Tau]", "2"], "-", 
           SubscriptBox["\[Tau]", "3"]}], ")"}], "2"]}]], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["s", "2"]}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["\[Tau]", "1"], "-", 
           SubscriptBox["\[Tau]", "3"]}], ")"}], "2"]}]], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["s", "2"]}], " ", 
        RowBox[{"(", 
         RowBox[{
          SubsuperscriptBox["\[Tau]", "1", "2"], "+", 
          SubsuperscriptBox["\[Tau]", "2", "2"], "-", 
          RowBox[{
           SubscriptBox["\[Tau]", "2"], " ", 
           SubscriptBox["\[Tau]", "3"]}], "+", 
          SubsuperscriptBox["\[Tau]", "3", "2"], "-", 
          RowBox[{
           SubscriptBox["\[Tau]", "1"], " ", 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["\[Tau]", "2"], "+", 
             SubscriptBox["\[Tau]", "3"]}], ")"}]}]}], ")"}]}]]},
     {
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["s", "2"]}], " ", 
        RowBox[{"(", 
         RowBox[{
          SubsuperscriptBox["\[Tau]", "1", "2"], "+", 
          SubsuperscriptBox["\[Tau]", "2", "2"], "-", 
          RowBox[{
           SubscriptBox["\[Tau]", "2"], " ", 
           SubscriptBox["\[Tau]", "3"]}], "+", 
          SubsuperscriptBox["\[Tau]", "3", "2"], "-", 
          RowBox[{
           SubscriptBox["\[Tau]", "1"], " ", 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["\[Tau]", "2"], "+", 
             SubscriptBox["\[Tau]", "3"]}], ")"}]}]}], ")"}]}]], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["s", "2"]}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["\[Tau]", "1"], "-", 
           SubscriptBox["\[Tau]", "3"]}], ")"}], "2"]}]], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["s", "2"]}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["\[Tau]", "2"], "-", 
           SubscriptBox["\[Tau]", "3"]}], ")"}], "2"]}]], "1", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["s", "2"]}], " ", 
        RowBox[{"(", 
         RowBox[{
          SubsuperscriptBox["\[Tau]", "1", "2"], "+", 
          SubsuperscriptBox["\[Tau]", "2", "2"], "-", 
          RowBox[{
           SubscriptBox["\[Tau]", "2"], " ", 
           SubscriptBox["\[Tau]", "3"]}], "+", 
          SubsuperscriptBox["\[Tau]", "3", "2"], "-", 
          RowBox[{
           SubscriptBox["\[Tau]", "1"], " ", 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["\[Tau]", "2"], "+", 
             SubscriptBox["\[Tau]", "3"]}], ")"}]}]}], ")"}]}]], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["s", "2"]}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["\[Tau]", "1"], "-", 
           SubscriptBox["\[Tau]", "2"]}], ")"}], "2"]}]]},
     {
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["s", "2"]}], " ", 
        RowBox[{"(", 
         RowBox[{
          SubsuperscriptBox["\[Tau]", "1", "2"], "+", 
          SubsuperscriptBox["\[Tau]", "2", "2"], "-", 
          RowBox[{
           SubscriptBox["\[Tau]", "2"], " ", 
           SubscriptBox["\[Tau]", "3"]}], "+", 
          SubsuperscriptBox["\[Tau]", "3", "2"], "-", 
          RowBox[{
           SubscriptBox["\[Tau]", "1"], " ", 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["\[Tau]", "2"], "+", 
             SubscriptBox["\[Tau]", "3"]}], ")"}]}]}], ")"}]}]], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["s", "2"]}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["\[Tau]", "1"], "-", 
           SubscriptBox["\[Tau]", "2"]}], ")"}], "2"]}]], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["s", "2"]}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["\[Tau]", "1"], "-", 
           SubscriptBox["\[Tau]", "3"]}], ")"}], "2"]}]], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["s", "2"]}], " ", 
        RowBox[{"(", 
         RowBox[{
          SubsuperscriptBox["\[Tau]", "1", "2"], "+", 
          SubsuperscriptBox["\[Tau]", "2", "2"], "-", 
          RowBox[{
           SubscriptBox["\[Tau]", "2"], " ", 
           SubscriptBox["\[Tau]", "3"]}], "+", 
          SubsuperscriptBox["\[Tau]", "3", "2"], "-", 
          RowBox[{
           SubscriptBox["\[Tau]", "1"], " ", 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["\[Tau]", "2"], "+", 
             SubscriptBox["\[Tau]", "3"]}], ")"}]}]}], ")"}]}]], "1", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["s", "2"]}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["\[Tau]", "2"], "-", 
           SubscriptBox["\[Tau]", "3"]}], ")"}], "2"]}]]},
     {
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["s", "2"]}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["\[Tau]", "1"], "-", 
           SubscriptBox["\[Tau]", "3"]}], ")"}], "2"]}]], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["s", "2"]}], " ", 
        RowBox[{"(", 
         RowBox[{
          SubsuperscriptBox["\[Tau]", "1", "2"], "+", 
          SubsuperscriptBox["\[Tau]", "2", "2"], "-", 
          RowBox[{
           SubscriptBox["\[Tau]", "2"], " ", 
           SubscriptBox["\[Tau]", "3"]}], "+", 
          SubsuperscriptBox["\[Tau]", "3", "2"], "-", 
          RowBox[{
           SubscriptBox["\[Tau]", "1"], " ", 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["\[Tau]", "2"], "+", 
             SubscriptBox["\[Tau]", "3"]}], ")"}]}]}], ")"}]}]], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["s", "2"]}], " ", 
        RowBox[{"(", 
         RowBox[{
          SubsuperscriptBox["\[Tau]", "1", "2"], "+", 
          SubsuperscriptBox["\[Tau]", "2", "2"], "-", 
          RowBox[{
           SubscriptBox["\[Tau]", "2"], " ", 
           SubscriptBox["\[Tau]", "3"]}], "+", 
          SubsuperscriptBox["\[Tau]", "3", "2"], "-", 
          RowBox[{
           SubscriptBox["\[Tau]", "1"], " ", 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["\[Tau]", "2"], "+", 
             SubscriptBox["\[Tau]", "3"]}], ")"}]}]}], ")"}]}]], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["s", "2"]}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["\[Tau]", "1"], "-", 
           SubscriptBox["\[Tau]", "2"]}], ")"}], "2"]}]], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["s", "2"]}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["\[Tau]", "2"], "-", 
           SubscriptBox["\[Tau]", "3"]}], ")"}], "2"]}]], "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7024695712690897`*^9, 3.702469597444868*^9}, 
   3.702469689164073*^9, 3.702470198223958*^9, 3.702470262051298*^9, {
   3.7024725016826067`*^9, 3.702472521549137*^9}, {3.702481036127584*^9, 
   3.702481053682851*^9}, 3.7024823592277727`*^9, {3.7024824431017847`*^9, 
   3.702482456637474*^9}, {3.702482800688602*^9, 3.7024828109375668`*^9}, 
   3.7025074494222813`*^9, {3.702509408796074*^9, 3.7025094213471737`*^9}, 
   3.702509583493458*^9, 3.7025096224278803`*^9, {3.702509721264909*^9, 
   3.702509748500906*^9}, {3.7025097865198593`*^9, 3.7025098027313557`*^9}, 
   3.702509832951231*^9, 3.702509865510214*^9, {3.702509904114303*^9, 
   3.702509946208823*^9}, 3.7025113989645433`*^9, {3.702511439334195*^9, 
   3.702511463375119*^9}, {3.702513048770735*^9, 3.702513074542141*^9}, 
   3.702513321014319*^9, 3.702516819187303*^9, {3.702516935532073*^9, 
   3.702516960666936*^9}, {3.702562524657104*^9, 3.702562533016345*^9}, {
   3.70256459056393*^9, 3.7025646034556093`*^9}, 3.7025714125841513`*^9, 
   3.7025716053902493`*^9, 3.702598716452736*^9, 3.7025988900250273`*^9, 
   3.702598929514509*^9, 3.70259981084519*^9, {3.702600972324052*^9, 
   3.702600989128664*^9}, {3.702601021782785*^9, 3.702601036885108*^9}, 
   3.702602606401209*^9, {3.702637153606071*^9, 3.7026371726032677`*^9}, 
   3.702637481242775*^9, 3.702659772363512*^9, 3.702659869988998*^9, 
   3.7026832783447104`*^9, 3.702684589242062*^9, 3.702684748072235*^9, 
   3.7026956847318697`*^9, 3.7026957385000477`*^9, 3.702696307678583*^9, 
   3.7026965105891113`*^9, {3.702696872928708*^9, 3.702696885938746*^9}, 
   3.702697275898634*^9, 3.702697814142564*^9, {3.702697933073244*^9, 
   3.702697960332735*^9}, 3.7027005935160847`*^9, 3.702702487552006*^9, 
   3.702702987431595*^9, 3.702703836225123*^9, 3.702705435941071*^9, 
   3.7027088874305897`*^9, 3.702722029651143*^9, 3.702727715922841*^9, 
   3.702727768880272*^9, 3.702728629945788*^9, {3.70272885591782*^9, 
   3.702728888953486*^9}, 3.702729113797799*^9, 3.702733194148292*^9, 
   3.702733538965506*^9, 3.7027336677505198`*^9, 3.7027341477330437`*^9, 
   3.702734253413776*^9, 3.70273589283851*^9, 3.70274344063971*^9, 
   3.702746276494722*^9, 3.702751728744438*^9, 3.7027538926033287`*^9, 
   3.702785614220619*^9, 3.702820278341159*^9, 3.7028209236345167`*^9, 
   3.702820956387397*^9, 3.702821066898697*^9, 3.702821128599324*^9, 
   3.702821172321789*^9, 3.702824005466093*^9, 3.702824165780676*^9, 
   3.7028991047026987`*^9, {3.7029081171935453`*^9, 3.702908153490609*^9}, 
   3.702909139411808*^9, 3.702913102287528*^9, 3.702913139687344*^9, 
   3.702919974724432*^9, 3.702982160872563*^9, {3.702986570810688*^9, 
   3.702986588816423*^9}, 3.7047343846451197`*^9, 3.704735727359729*^9, 
   3.704735793110817*^9, {3.704736002797977*^9, 3.704736030899247*^9}, 
   3.704736732190085*^9, 3.704736923322109*^9, 3.704737110240995*^9, 
   3.7047617073277197`*^9, 3.704764364483088*^9, {3.705089797951621*^9, 
   3.705089813800819*^9}, 3.706055296593812*^9, 3.708804140647895*^9, 
   3.7100271799813137`*^9, 3.710159429530178*^9, 3.7101637144472313`*^9, 
   3.710163959422464*^9, 3.710179230356226*^9, 3.7107742833257227`*^9, 
   3.7107743718030443`*^9, 3.710774429845725*^9, 3.710776944642223*^9, 
   3.7108649792890253`*^9, 3.7108651211124353`*^9, 3.7108651514025993`*^9, 
   3.71086532742058*^9, 3.710865477353469*^9, 3.7113122600361834`*^9, 
   3.711313477049836*^9, 3.71131354078752*^9, 3.712086469943967*^9, 
   3.7120865215216*^9},
 ExpressionUUID -> "432e3b34-32de-43b9-8d14-bfd644bfecec"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"<<", "Combinatorica`"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$ContextPath", "=", 
   RowBox[{"Rest", "@", "$ContextPath"}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.672895872052487*^9, 3.6730379856603813`*^9, {3.673038113328318*^9, 
   3.673038118106389*^9}, {3.673038745579658*^9, 3.673038755987619*^9}, {
   3.682696973874386*^9, 3.682696976646329*^9}, {3.6826985860957823`*^9, 
   3.682698588250066*^9}},
 ExpressionUUID -> "4ab02dee-6eb7-4f66-a80b-1eaf8e53f6cc"],

Cell[BoxData[
 TemplateBox[{
  "General","compat",
   "\"Combinatorica Graph and Permutations functionality has been superseded \
by preloaded functionality. The package now being loaded may conflict with \
this. Please see the Compatibility Guide for details.\"",2,107,2,
   19741684410549050172,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7120864701369658`*^9, 3.712086521607131*^9}]
}, Open  ]],

Cell["Consider the symmetric group of n photons.", "Text",
 CellChangeTimes->{{3.672715426448371*^9, 3.672715452388085*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"group", "=", 
   RowBox[{"SymmetricGroup", "[", "nphotons", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"elementlist", "=", 
   RowBox[{
    RowBox[{"GroupElements", "[", "group", "]"}], "//", "Sort"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.672714293696475*^9, 3.672714297049781*^9}, {
   3.6727147678939943`*^9, 3.672714794466323*^9}, {3.672714897813896*^9, 
   3.672714898487239*^9}, {3.672715412263976*^9, 3.672715413663268*^9}, {
   3.672715550040304*^9, 3.67271556448378*^9}, {3.672715717031085*^9, 
   3.6727157171266823`*^9}, {3.6727183536075897`*^9, 3.672718354622788*^9}, {
   3.672721775573819*^9, 3.672721775695367*^9}, 3.67272205462395*^9, {
   3.673038226247272*^9, 3.673038288857181*^9}, 3.673038676240206*^9, 
   3.6731386916143293`*^9, 3.673161252397461*^9, {3.6962819102729883`*^9, 
   3.6962819144237337`*^9}},
 ExpressionUUID -> "b00dc504-0340-43bb-baca-d7a50e6b3cae"],

Cell["\<\
Let\[CloseCurlyQuote]s construct the representations of all the two cycles of \
this group. Note that in the sorted elementlist the first element is identity \
and the next few are the two cycles.\
\>", "Text",
 CellChangeTimes->{{3.672715461911591*^9, 3.672715512055171*^9}, {
   3.672715901651445*^9, 3.672715908917356*^9}, 3.696282329810402*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ntwocycles", " ", "=", " ", 
  RowBox[{"Sum", "[", 
   RowBox[{"r", ",", 
    RowBox[{"{", 
     RowBox[{"r", ",", "1", ",", 
      RowBox[{"nphotons", "-", "1"}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TwoCycleRep", "[", 
    RowBox[{"twocycle_", ",", "outputwords_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"mat", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", 
           RowBox[{"Length", "[", "outputwords", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"m", ",", 
           RowBox[{"Length", "[", "outputwords", "]"}]}], "}"}]}], "]"}]}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Permute", "[", 
            RowBox[{
             RowBox[{"outputwords", "[", 
              RowBox[{"[", "m", "]"}], "]"}], ",", "twocycle"}], "]"}], 
           "\[Equal]", 
           RowBox[{"outputwords", "[", 
            RowBox[{"[", "k", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"mat", "[", 
            RowBox[{"[", 
             RowBox[{"m", ",", "k"}], "]"}], "]"}], "=", "1"}]}], "]"}], ",", 
        
        RowBox[{"{", 
         RowBox[{"m", ",", 
          RowBox[{"Length", "[", "outputwords", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"Length", "[", "outputwords", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "mat"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"twocyclesreps", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"TwoCycleRep", "[", 
      RowBox[{
       RowBox[{"elementlist", "[", 
        RowBox[{"[", 
         RowBox[{"i", "+", "1"}], "]"}], "]"}], ",", "outputwords"}], "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "ntwocycles"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "P", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"twocycleslist", " ", "=", " ", 
  RowBox[{"Flatten", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"P", "[", 
        RowBox[{"i", ",", "j"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"i", "+", "1"}], ",", "nphotons"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"nphotons", "-", "1"}]}], "}"}]}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k", "=", "1"}], ";", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", " ", 
     RowBox[{"nphotons", "-", "1"}]}], ",", 
    RowBox[{"i", "++"}], ",", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"j", "=", 
       RowBox[{"i", "+", "1"}]}], ",", 
      RowBox[{"j", "\[LessEqual]", " ", "nphotons"}], ",", 
      RowBox[{"j", "++"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"P", "[", 
         RowBox[{"i", ",", "j"}], "]"}], "=", " ", 
        RowBox[{"twocyclesreps", "[", 
         RowBox[{"[", "k", "]"}], "]"}]}], ";", 
       RowBox[{"k", "=", 
        RowBox[{"k", "+", "1"}]}], ";"}]}], "]"}]}], "]"}], ";", 
  RowBox[{"Clear", "[", "k", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"MatrixForm", "[", 
     RowBox[{"twocyclesreps", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "ntwocycles"}], "}"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.672715647266342*^9, 3.67271566694379*^9}, {
   3.67271569777861*^9, 3.672715721219349*^9}, {3.672715788415512*^9, 
   3.672715894366961*^9}, {3.672716985359144*^9, 3.6727170577378902`*^9}, {
   3.6727184231112633`*^9, 3.672718505586458*^9}, {3.672718536264724*^9, 
   3.672718582604431*^9}, {3.6727195405150557`*^9, 3.672719671965722*^9}, {
   3.6727197503219137`*^9, 3.6727197959316797`*^9}, {3.672719832127782*^9, 
   3.672719832268195*^9}, {3.6727199839497967`*^9, 3.672720028820834*^9}, {
   3.6727212401867857`*^9, 3.6727212498788967`*^9}, {3.6727214580722733`*^9, 
   3.672721616267702*^9}, {3.672721684306921*^9, 3.672721684455736*^9}, {
   3.672721975123267*^9, 3.6727220045230923`*^9}, 3.672722046718919*^9, {
   3.6727221014723253`*^9, 3.672722102832809*^9}, {3.6727231235999823`*^9, 
   3.672723173269178*^9}, {3.672723210428446*^9, 3.672723217890008*^9}, {
   3.672723253237606*^9, 3.672723304303328*^9}, {3.672723623033379*^9, 
   3.672723624982726*^9}, 3.672724179566126*^9, {3.673043379061811*^9, 
   3.673043389286933*^9}, 3.67304345451713*^9, {3.673046407088553*^9, 
   3.673046418317169*^9}, 3.6730466331760073`*^9, {3.673046760676113*^9, 
   3.673046763775494*^9}, 3.673054493109066*^9, 3.6730565031907787`*^9, 
   3.6733784029654703`*^9, 3.6735020358619957`*^9, 3.696568163165979*^9, 
   3.696568215397456*^9, 3.702753007323539*^9, 3.702753352579297*^9},
 ExpressionUUID -> "d8e2111b-c94c-4029-a6ea-45014d0c6593"],

Cell[BoxData["3"], "Output",
 CellChangeTimes->{{3.702469571434325*^9, 3.702469597607641*^9}, 
   3.702469689313055*^9, 3.7024701984190474`*^9, 3.702470262231019*^9, {
   3.702472501831053*^9, 3.702472521703033*^9}, {3.702481036437788*^9, 
   3.702481053854754*^9}, 3.7024823593733473`*^9, {3.702482443243628*^9, 
   3.702482456771883*^9}, {3.70248280082623*^9, 3.702482811116394*^9}, 
   3.7025074497415237`*^9, {3.702509408937708*^9, 3.702509421496746*^9}, 
   3.702509583637816*^9, 3.702509622585362*^9, {3.702509721410931*^9, 
   3.702509748663937*^9}, {3.70250978667229*^9, 3.702509802883184*^9}, 
   3.702509833097247*^9, 3.702509865663475*^9, {3.7025099042574472`*^9, 
   3.702509946359062*^9}, 3.702511399085038*^9, {3.702511439458891*^9, 
   3.702511463505365*^9}, {3.702513048911273*^9, 3.702513074953705*^9}, 
   3.702513321141746*^9, 3.702516819367818*^9, {3.702516935674395*^9, 
   3.702516960813429*^9}, {3.7025625250425034`*^9, 3.702562533319289*^9}, {
   3.70256459073918*^9, 3.702564603618949*^9}, 3.702571412879232*^9, 
   3.702571605543132*^9, 3.702598716622142*^9, 3.7025988901735783`*^9, 
   3.702598929671762*^9, 3.7025998109737043`*^9, {3.702600972546262*^9, 
   3.702600989286364*^9}, {3.702601021940377*^9, 3.702601037042609*^9}, 
   3.702602606541732*^9, {3.702637153855083*^9, 3.702637172720188*^9}, 
   3.702637481359902*^9, 3.702659772705504*^9, 3.7026598701712837`*^9, 
   3.702683279029846*^9, 3.7026845893884697`*^9, 3.702684748231583*^9, 
   3.702695685030855*^9, 3.7026957386389103`*^9, 3.7026963078078623`*^9, 
   3.7026965106835833`*^9, {3.702696873063048*^9, 3.7026968860392103`*^9}, 
   3.702697275995175*^9, 3.702697814240264*^9, {3.70269793317309*^9, 
   3.702697960432835*^9}, 3.70270059362947*^9, 3.7027024876766157`*^9, 
   3.7027029875391293`*^9, 3.702703836339129*^9, 3.702705436051737*^9, 
   3.702708887541789*^9, 3.702722029778183*^9, 3.7027277160341873`*^9, 
   3.702727768997764*^9, 3.702728630050723*^9, {3.70272885606188*^9, 
   3.702728889058939*^9}, 3.702729113908105*^9, 3.702733194292953*^9, 
   3.702733539076459*^9, 3.702733667861034*^9, 3.7027341478412113`*^9, 
   3.702734253530188*^9, 3.702735892964943*^9, 3.702743440755733*^9, 
   3.702746276765903*^9, 3.702751728864326*^9, 3.7027530076451693`*^9, 
   3.702753353176578*^9, 3.7027538927185926`*^9, 3.702785614367388*^9, 
   3.702820278902371*^9, 3.7028209237748337`*^9, 3.7028209565319653`*^9, 
   3.702821067040908*^9, 3.702821128739935*^9, 3.702821172473063*^9, 
   3.702824005958152*^9, 3.702824165948914*^9, 3.702899105294951*^9, {
   3.702908117498822*^9, 3.702908153637764*^9}, 3.702909139559462*^9, 
   3.7029131024501953`*^9, 3.702913139837541*^9, 3.702919975032942*^9, 
   3.702982161395693*^9, {3.702986571112233*^9, 3.702986589124928*^9}, 
   3.704734384944482*^9, 3.7047357274983253`*^9, 3.704735793259575*^9, {
   3.704736002959922*^9, 3.704736031047023*^9}, 3.704736732337728*^9, 
   3.7047369234859447`*^9, 3.704737110416072*^9, 3.704761708395431*^9, 
   3.704764364780661*^9, {3.705089798378912*^9, 3.7050898141008577`*^9}, 
   3.706055297183957*^9, 3.7088041409669867`*^9, 3.710027180230145*^9, 
   3.7101594298587713`*^9, 3.710163714796905*^9, 3.710163959536359*^9, 
   3.710179230699876*^9, 3.710774283917717*^9, 3.710774372102216*^9, 
   3.71077443013492*^9, 3.710776944921033*^9, 3.7108649796437607`*^9, 
   3.710865121254896*^9, 3.7108651515543537`*^9, 3.710865327577627*^9, 
   3.7108654774987373`*^9, 3.71131226064925*^9, 3.711313477369411*^9, 
   3.7113135409148703`*^9, 3.7120864704805937`*^9, 3.712086522002678*^9},
 ExpressionUUID -> "bebff0c7-495b-46c3-905d-6fe84f2ff77f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"P", "[", 
    RowBox[{"1", ",", "2"}], "]"}], ",", 
   RowBox[{"P", "[", 
    RowBox[{"1", ",", "3"}], "]"}], ",", 
   RowBox[{"P", "[", 
    RowBox[{"2", ",", "3"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.702469571434325*^9, 3.702469597607641*^9}, 
   3.702469689313055*^9, 3.7024701984190474`*^9, 3.702470262231019*^9, {
   3.702472501831053*^9, 3.702472521703033*^9}, {3.702481036437788*^9, 
   3.702481053854754*^9}, 3.7024823593733473`*^9, {3.702482443243628*^9, 
   3.702482456771883*^9}, {3.70248280082623*^9, 3.702482811116394*^9}, 
   3.7025074497415237`*^9, {3.702509408937708*^9, 3.702509421496746*^9}, 
   3.702509583637816*^9, 3.702509622585362*^9, {3.702509721410931*^9, 
   3.702509748663937*^9}, {3.70250978667229*^9, 3.702509802883184*^9}, 
   3.702509833097247*^9, 3.702509865663475*^9, {3.7025099042574472`*^9, 
   3.702509946359062*^9}, 3.702511399085038*^9, {3.702511439458891*^9, 
   3.702511463505365*^9}, {3.702513048911273*^9, 3.702513074953705*^9}, 
   3.702513321141746*^9, 3.702516819367818*^9, {3.702516935674395*^9, 
   3.702516960813429*^9}, {3.7025625250425034`*^9, 3.702562533319289*^9}, {
   3.70256459073918*^9, 3.702564603618949*^9}, 3.702571412879232*^9, 
   3.702571605543132*^9, 3.702598716622142*^9, 3.7025988901735783`*^9, 
   3.702598929671762*^9, 3.7025998109737043`*^9, {3.702600972546262*^9, 
   3.702600989286364*^9}, {3.702601021940377*^9, 3.702601037042609*^9}, 
   3.702602606541732*^9, {3.702637153855083*^9, 3.702637172720188*^9}, 
   3.702637481359902*^9, 3.702659772705504*^9, 3.7026598701712837`*^9, 
   3.702683279029846*^9, 3.7026845893884697`*^9, 3.702684748231583*^9, 
   3.702695685030855*^9, 3.7026957386389103`*^9, 3.7026963078078623`*^9, 
   3.7026965106835833`*^9, {3.702696873063048*^9, 3.7026968860392103`*^9}, 
   3.702697275995175*^9, 3.702697814240264*^9, {3.70269793317309*^9, 
   3.702697960432835*^9}, 3.70270059362947*^9, 3.7027024876766157`*^9, 
   3.7027029875391293`*^9, 3.702703836339129*^9, 3.702705436051737*^9, 
   3.702708887541789*^9, 3.702722029778183*^9, 3.7027277160341873`*^9, 
   3.702727768997764*^9, 3.702728630050723*^9, {3.70272885606188*^9, 
   3.702728889058939*^9}, 3.702729113908105*^9, 3.702733194292953*^9, 
   3.702733539076459*^9, 3.702733667861034*^9, 3.7027341478412113`*^9, 
   3.702734253530188*^9, 3.702735892964943*^9, 3.702743440755733*^9, 
   3.702746276765903*^9, 3.702751728864326*^9, 3.7027530076451693`*^9, 
   3.702753353176578*^9, 3.7027538927185926`*^9, 3.702785614367388*^9, 
   3.702820278902371*^9, 3.7028209237748337`*^9, 3.7028209565319653`*^9, 
   3.702821067040908*^9, 3.702821128739935*^9, 3.702821172473063*^9, 
   3.702824005958152*^9, 3.702824165948914*^9, 3.702899105294951*^9, {
   3.702908117498822*^9, 3.702908153637764*^9}, 3.702909139559462*^9, 
   3.7029131024501953`*^9, 3.702913139837541*^9, 3.702919975032942*^9, 
   3.702982161395693*^9, {3.702986571112233*^9, 3.702986589124928*^9}, 
   3.704734384944482*^9, 3.7047357274983253`*^9, 3.704735793259575*^9, {
   3.704736002959922*^9, 3.704736031047023*^9}, 3.704736732337728*^9, 
   3.7047369234859447`*^9, 3.704737110416072*^9, 3.704761708395431*^9, 
   3.704764364780661*^9, {3.705089798378912*^9, 3.7050898141008577`*^9}, 
   3.706055297183957*^9, 3.7088041409669867`*^9, 3.710027180230145*^9, 
   3.7101594298587713`*^9, 3.710163714796905*^9, 3.710163959536359*^9, 
   3.710179230699876*^9, 3.710774283917717*^9, 3.710774372102216*^9, 
   3.71077443013492*^9, 3.710776944921033*^9, 3.7108649796437607`*^9, 
   3.710865121254896*^9, 3.7108651515543537`*^9, 3.710865327577627*^9, 
   3.7108654774987373`*^9, 3.71131226064925*^9, 3.711313477369411*^9, 
   3.7113135409148703`*^9, 3.7120864704805937`*^9, 3.71208652200537*^9},
 ExpressionUUID -> "bebff0c7-495b-46c3-905d-6fe84f2ff77f"]
}, Open  ]],

Cell["\<\
Construct the class operators of the subgroup chain of two cycles.\
\>", "Text",
 CellChangeTimes->{{3.672718697753478*^9, 3.672718714883975*^9}, {
  3.672775537219418*^9, 3.672775539134416*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "Co", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"classoperators", " ", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Co", "[", 
      RowBox[{"2", ",", "k"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "2", ",", "nphotons"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"k", "=", "2"}], ",", 
   RowBox[{"k", "\[LessEqual]", " ", "nphotons"}], ",", 
   RowBox[{"k", "++"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Co", "[", 
      RowBox[{"2", ",", "k"}], "]"}], "=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"P", "[", 
        RowBox[{"i", ",", "j"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"k", "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"i", "+", "1"}], ",", "k"}], "}"}]}], "]"}]}], ";"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"MatrixForm", "[", 
     RowBox[{"classoperators", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"nphotons", "-", "1"}]}], "}"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.672723365218938*^9, 3.672723372029337*^9}, {
   3.672723548315782*^9, 3.6727236519418917`*^9}, 3.6727236819894943`*^9, {
   3.672723803780774*^9, 3.672723822300626*^9}, {3.672723858177106*^9, 
   3.6727239055819063`*^9}, {3.672723945944131*^9, 3.672724115823592*^9}, {
   3.672724159170578*^9, 3.672724174487002*^9}, {3.673046458829303*^9, 
   3.673046462110811*^9}, {3.673046818733779*^9, 3.673046821954443*^9}, 
   3.673502040320488*^9, {3.6965681861730413`*^9, 3.6965681891428823`*^9}},
 ExpressionUUID -> "1d82807d-2c5f-43bb-9a1b-3769f1db522f"],

Cell["\<\
Construct a linear combination of the class operator such that eigenoperator \
has no repeated eigenvalues.\
\>", "Text",
 CellChangeTimes->{{3.672725214292137*^9, 3.672725257180188*^9}, {
   3.672775335420309*^9, 3.672775353291819*^9}, 3.673497548200515*^9, 
   3.6826970034280148`*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"comultiplier", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"k", "+", "7"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", 
       RowBox[{"nphotons", "-", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eigenoperator", " ", "=", " ", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"comultiplier", "[", 
       RowBox[{"[", "i", "]"}], "]"}], 
      RowBox[{"classoperators", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"nphotons", "-", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"eigenoperator", " ", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.672725277266365*^9, 3.672725338294928*^9}, {
   3.673069745086845*^9, 3.673069748013036*^9}, {3.673070091454042*^9, 
   3.673070092872876*^9}, 3.6731392450131063`*^9, {3.673149926256009*^9, 
   3.673149942875896*^9}, {3.673150517909689*^9, 3.673150521269302*^9}, 
   3.67315154088238*^9, {3.673217155969343*^9, 3.673217159244198*^9}, {
   3.673323934588595*^9, 3.673323962097719*^9}, {3.673324120102385*^9, 
   3.6733241272165337`*^9}, {3.682268731656021*^9, 3.682268750546494*^9}, {
   3.684274786428708*^9, 3.6842747892543373`*^9}, {3.696270767662099*^9, 
   3.6962707709678307`*^9}, {3.696568192710021*^9, 3.696568211180072*^9}, 
   3.7020931384950933`*^9},
 ExpressionUUID -> "688a3277-3772-4c1d-9f63-43a834c56c24"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "9", "17", "0", "0", "9"},
     {"9", "0", "0", "9", "17", "0"},
     {"17", "0", "0", "9", "9", "0"},
     {"0", "9", "9", "0", "0", "17"},
     {"0", "17", "9", "0", "0", "9"},
     {"9", "0", "0", "17", "9", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.702102798634453*^9, {3.70246957149815*^9, 3.702469597646678*^9}, 
   3.7024696893526487`*^9, 3.7024701984589043`*^9, 3.7024702623325443`*^9, {
   3.702472501866488*^9, 3.702472521739997*^9}, {3.702481036470669*^9, 
   3.7024810539151487`*^9}, 3.702482359407875*^9, {3.7024824432764177`*^9, 
   3.7024824568022423`*^9}, {3.7024828008568487`*^9, 3.7024828111474752`*^9}, 
   3.702507449771821*^9, {3.702509408975288*^9, 3.702509421530038*^9}, 
   3.702509583674232*^9, 3.702509622623508*^9, {3.702509721444879*^9, 
   3.702509748711699*^9}, {3.7025097867059727`*^9, 3.702509802921899*^9}, 
   3.702509833129798*^9, 3.702509865705212*^9, {3.702509904290942*^9, 
   3.7025099463957167`*^9}, 3.702511399115924*^9, {3.702511439491476*^9, 
   3.70251146353614*^9}, {3.702513048977202*^9, 3.702513075145381*^9}, 
   3.702513321214306*^9, 3.7025168194151297`*^9, {3.702516935720243*^9, 
   3.702516960852552*^9}, {3.702562525256967*^9, 3.702562533528194*^9}, {
   3.7025645908101053`*^9, 3.702564603658967*^9}, 3.7025714129084682`*^9, 
   3.702571605582013*^9, 3.702598716709008*^9, 3.702598890213401*^9, 
   3.702598929762557*^9, 3.7025998110262117`*^9, {3.7026009725863543`*^9, 
   3.7026009893240356`*^9}, {3.702601021978635*^9, 3.70260103708321*^9}, 
   3.702602606581416*^9, {3.702637153887035*^9, 3.702637172751668*^9}, 
   3.702637481394166*^9, 3.7026597728252773`*^9, 3.7026598702250767`*^9, 
   3.7026832793354683`*^9, 3.7026845894429693`*^9, 3.702684748291319*^9, 
   3.7026956850881166`*^9, 3.702695738686535*^9, 3.702696307847979*^9, 
   3.7026965107169447`*^9, {3.7026968730937967`*^9, 3.7026968860689363`*^9}, 
   3.70269727602674*^9, 3.702697814266432*^9, {3.7026979332015543`*^9, 
   3.7026979604606857`*^9}, 3.702700593659669*^9, 3.702702487734129*^9, 
   3.702702987570208*^9, 3.7027038363703814`*^9, 3.702705436085352*^9, 
   3.702708887573497*^9, 3.702722029815074*^9, 3.702727716067397*^9, 
   3.702727769034069*^9, 3.7027286300809813`*^9, {3.702728856107236*^9, 
   3.702728889086627*^9}, 3.702729113938077*^9, 3.702733194333254*^9, 
   3.7027335391575203`*^9, 3.7027336678934793`*^9, 3.702734147869793*^9, 
   3.7027342536073236`*^9, 3.702735893005172*^9, 3.7027434407939863`*^9, 
   3.70274627690086*^9, 3.702751728898031*^9, 3.702753892763031*^9, 
   3.702785614402836*^9, 3.7028202790393867`*^9, 3.702820923810232*^9, 
   3.702820956567165*^9, 3.702821067074726*^9, 3.702821128772276*^9, 
   3.7028211725049067`*^9, 3.7028240061128883`*^9, 3.7028241659849367`*^9, 
   3.702899105433172*^9, {3.702908117703768*^9, 3.702908153669284*^9}, 
   3.702909139591606*^9, 3.702913102489595*^9, 3.702913139872813*^9, 
   3.702919975240218*^9, 3.702982161530347*^9, {3.7029865712492332`*^9, 
   3.7029865893346786`*^9}, 3.704734385152546*^9, 3.704735727532571*^9, 
   3.704735793292259*^9, {3.7047360030346212`*^9, 3.704736031107168*^9}, 
   3.70473673237941*^9, 3.704736923564917*^9, 3.704737110494568*^9, 
   3.70476170880385*^9, 3.7047643649894543`*^9, {3.705089798515469*^9, 
   3.7050898143023987`*^9}, 3.706055297332985*^9, 3.70880414118128*^9, 
   3.710027180265366*^9, 3.7101594298914423`*^9, 3.710163715048674*^9, 
   3.7101639595614767`*^9, 3.7101792307338867`*^9, 3.710774284053647*^9, 
   3.7107743723200483`*^9, 3.71077443026642*^9, 3.710776945140875*^9, 
   3.710864979677024*^9, 3.710865121288876*^9, 3.7108651515925093`*^9, 
   3.710865327619207*^9, 3.710865477537586*^9, 3.711312260792935*^9, 
   3.711313477404353*^9, 3.711313540942877*^9, 3.712086470640321*^9, 
   3.71208652276606*^9},
 ExpressionUUID -> "dd2f5d28-bbf0-4378-84cb-af2d1e3e62cf"]
}, Open  ]],

Cell["\<\
Decompose the input state by employing Young diagrams. The possible Young \
diagrams are\
\>", "Text",
 CellChangeTimes->{{3.672775471874118*^9, 3.6727754752008553`*^9}, {
   3.672775559958302*^9, 3.6727755696344967`*^9}, {3.6727762865126457`*^9, 
   3.672776291244091*^9}, 3.672776566837248*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"nonzerooutputchannels", " ", "=", " ", 
   RowBox[{"Count", "[", 
    RowBox[{"outputdist", ",", 
     RowBox[{"_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"#", "\[NotEqual]", " ", "0"}], "&"}], ")"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"youngdiagrams", " ", "=", " ", 
  RowBox[{"IntegerPartitions", "[", 
   RowBox[{"nphotons", ",", "nonzerooutputchannels"}], "]"}], " "}]}], "Input",\

 CellChangeTimes->{{3.672776295500642*^9, 3.6727763188052053`*^9}, {
  3.6727764597261677`*^9, 3.672776495555107*^9}, {3.672776532929038*^9, 
  3.672776541477309*^9}, {3.702469546319151*^9, 3.702469565748082*^9}},
 ExpressionUUID -> "beafc427-6fdb-47ca-ba24-663d376ab4ad"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "3", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.702102720263647*^9, {3.702469571504545*^9, 3.702469597667719*^9}, 
   3.702469689358555*^9, 3.7024701984849367`*^9, 3.7024702623391037`*^9, {
   3.702472501872813*^9, 3.702472521745941*^9}, {3.702481036475979*^9, 
   3.7024810539213343`*^9}, 3.7024823594141912`*^9, {3.7024824432815332`*^9, 
   3.702482456807288*^9}, {3.702482800861863*^9, 3.702482811152699*^9}, 
   3.702507449791841*^9, {3.7025094089990683`*^9, 3.702509421536895*^9}, 
   3.702509583679328*^9, 3.702509622630158*^9, {3.702509721450493*^9, 
   3.70250974871716*^9}, {3.702509786712037*^9, 3.702509802927597*^9}, 
   3.702509833135075*^9, 3.702509865712016*^9, {3.702509904296897*^9, 
   3.702509946402816*^9}, 3.702511399122987*^9, {3.702511439498904*^9, 
   3.702511463557856*^9}, {3.702513049011065*^9, 3.702513075276635*^9}, 
   3.7025133212797537`*^9, 3.702516819437931*^9, {3.702516935730158*^9, 
   3.7025169608605843`*^9}, {3.7025625253379707`*^9, 
   3.7025625335997477`*^9}, {3.702564590842731*^9, 3.7025646036649303`*^9}, 
   3.702571412927615*^9, 3.702571605603518*^9, 3.702598716716445*^9, 
   3.702598890220459*^9, 3.7025989298027563`*^9, 3.702599811032886*^9, {
   3.702600972607992*^9, 3.702600989354018*^9}, {3.702601022005393*^9, 
   3.702601037091208*^9}, 3.7026026065892878`*^9, {3.702637153911545*^9, 
   3.702637172757167*^9}, 3.702637481423539*^9, 3.7026597728494453`*^9, 
   3.702659870249658*^9, 3.702683279447363*^9, 3.7026845894483232`*^9, 
   3.702684748297906*^9, 3.7026956851096153`*^9, 3.7026957387044897`*^9, 
   3.70269630786836*^9, 3.702696510734766*^9, {3.7026968730991287`*^9, 
   3.7026968860885897`*^9}, 3.702697276046389*^9, 3.702697814284577*^9, {
   3.702697933221096*^9, 3.7026979604801188`*^9}, 3.702700593679463*^9, 
   3.7027024877815638`*^9, 3.702702987592211*^9, 3.7027038363917913`*^9, 
   3.702705436108129*^9, 3.702708887595598*^9, 3.7027220298429737`*^9, 
   3.702727716088472*^9, 3.702727769055739*^9, 3.7027286301021547`*^9, {
   3.702728856114419*^9, 3.7027288891095343`*^9}, 3.702729113956402*^9, 
   3.702733194365699*^9, 3.702733539176951*^9, 3.702733667901492*^9, 
   3.7027341478897533`*^9, 3.702734253672751*^9, 3.702735893024233*^9, 
   3.702743440816712*^9, 3.702746276975391*^9, 3.702751728903998*^9, 
   3.7027538927826366`*^9, 3.702785614408971*^9, 3.7028202791132593`*^9, 
   3.70282092381559*^9, 3.7028209565724907`*^9, 3.7028210670800123`*^9, 
   3.702821128777377*^9, 3.702821172509873*^9, 3.702824006197484*^9, 
   3.702824166004582*^9, 3.702899105513809*^9, {3.702908117724359*^9, 
   3.702908153674363*^9}, 3.702909139597311*^9, 3.702913102495626*^9, 
   3.7029131398779488`*^9, 3.7029199753136044`*^9, 3.702982161604444*^9, {
   3.7029865713997917`*^9, 3.702986589410177*^9}, 3.7047343852960176`*^9, 
   3.704735727537889*^9, 3.704735793297708*^9, {3.704736003039998*^9, 
   3.7047360311134768`*^9}, 3.704736732385928*^9, 3.704736923570503*^9, 
   3.704737110534396*^9, 3.704761708962031*^9, 3.7047643650618896`*^9, {
   3.705089798590308*^9, 3.705089814375095*^9}, 3.706055297403932*^9, 
   3.708804141256712*^9, 3.710027180272072*^9, 3.71015942991461*^9, 
   3.710163715130022*^9, 3.7101639595796824`*^9, 3.7101792307549963`*^9, 
   3.7107742841278143`*^9, 3.710774372392185*^9, 3.710774430423431*^9, 
   3.710776945258978*^9, 3.710864979702924*^9, 3.7108651213112698`*^9, 
   3.710865151598845*^9, 3.7108653276461782`*^9, 3.710865477563748*^9, 
   3.711312260867998*^9, 3.711313477426601*^9, 3.711313540963851*^9, 
   3.7120864707143*^9, 3.71208652280824*^9},
 ExpressionUUID -> "7dc10f71-b2c0-4d78-bff1-dea42f5a62d9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"youngtableaux", " ", "=", " ", 
  RowBox[{"Flatten", "[", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{"Combinatorica`Tableaux", ",", "youngdiagrams"}], "]"}], ",", 
    "1"}], "]"}]}]], "Input",
 CellChangeTimes->{3.682697310060231*^9, 3.682698431166535*^9},
 ExpressionUUID -> "f02909ee-6870-451f-ac5d-20aa91d22b36"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2", ",", "3"}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", "2", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", "3", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "1", "}"}], ",", 
     RowBox[{"{", "2", "}"}], ",", 
     RowBox[{"{", "3", "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.702102724341833*^9, {3.702469571538488*^9, 3.702469597692894*^9}, 
   3.702469689384326*^9, 3.702470198511009*^9, 3.702470262387885*^9, {
   3.702472501895315*^9, 3.702472521770575*^9}, {3.702481036497607*^9, 
   3.70248105396459*^9}, 3.702482359436078*^9, {3.702482443302326*^9, 
   3.702482456826586*^9}, {3.702482800881116*^9, 3.702482811172064*^9}, 
   3.702507449812564*^9, {3.702509409069495*^9, 3.702509421558881*^9}, 
   3.7025095837061367`*^9, 3.702509622653884*^9, {3.702509721471361*^9, 
   3.702509748744157*^9}, {3.7025097867342052`*^9, 3.7025098029501657`*^9}, 
   3.702509833155219*^9, 3.702509865737363*^9, {3.702509904317936*^9, 
   3.7025099464246607`*^9}, 3.702511399143565*^9, {3.702511439520432*^9, 
   3.702511463579711*^9}, {3.70251304904323*^9, 3.702513075409925*^9}, 
   3.7025133213439817`*^9, 3.702516819461575*^9, {3.702516935755754*^9, 
   3.702516960886067*^9}, {3.702562525613941*^9, 3.70256253367439*^9}, {
   3.702564590875744*^9, 3.702564603688119*^9}, 3.702571412950555*^9, 
   3.7025716056278543`*^9, 3.702598716757709*^9, 3.702598890242931*^9, 
   3.7025989298517227`*^9, 3.7025998110590754`*^9, {3.702600972635198*^9, 
   3.702600989382432*^9}, {3.702601022040422*^9, 3.702601037122139*^9}, 
   3.702602606619334*^9, {3.702637153933898*^9, 3.702637172775281*^9}, 
   3.70263748145335*^9, 3.702659772891588*^9, 3.70265987029877*^9, 
   3.702683279558567*^9, 3.702684589470599*^9, 3.702684748319989*^9, 
   3.702695685132595*^9, 3.702695738724235*^9, 3.702696307889535*^9, 
   3.702696510754712*^9, {3.702696873122862*^9, 3.7026968861109257`*^9}, 
   3.702697276068362*^9, 3.702697814302527*^9, {3.702697933241967*^9, 
   3.70269796050146*^9}, 3.702700593700109*^9, 3.702702487829803*^9, 
   3.7027029876133413`*^9, 3.702703836415242*^9, 3.702705436131241*^9, 
   3.702708887620517*^9, 3.7027220298743467`*^9, 3.70272771610914*^9, 
   3.702727769079121*^9, 3.702728630123417*^9, {3.702728856144594*^9, 
   3.702728889129651*^9}, 3.7027291139761066`*^9, 3.702733194392345*^9, 
   3.70273353919978*^9, 3.7027336679231462`*^9, 3.702734147912037*^9, 
   3.7027342537438717`*^9, 3.7027358930467453`*^9, 3.702743440840238*^9, 
   3.702746277120739*^9, 3.7027517289276*^9, 3.702753892802951*^9, 
   3.702785614434416*^9, 3.702820279190179*^9, 3.70282092383799*^9, 
   3.702820956594428*^9, 3.702821067103798*^9, 3.702821128797921*^9, 
   3.702821172530081*^9, 3.702824006272829*^9, 3.702824166027553*^9, 
   3.702899105585989*^9, {3.702908117798485*^9, 3.7029081536946907`*^9}, 
   3.702909139619319*^9, 3.702913102519256*^9, 3.702913139901764*^9, 
   3.702919975386869*^9, 3.702982161678421*^9, {3.702986571477536*^9, 
   3.7029865894884233`*^9}, 3.7047343855509653`*^9, 3.704735727558653*^9, 
   3.704735793319654*^9, {3.704736003077176*^9, 3.704736031145833*^9}, 
   3.704736732412022*^9, 3.704736923611002*^9, 3.704737110573586*^9, 
   3.704761709066126*^9, 3.7047643651362743`*^9, {3.705089798661446*^9, 
   3.705089814450376*^9}, 3.706055297474468*^9, 3.7088041414281054`*^9, 
   3.710027180296143*^9, 3.7101594299379807`*^9, 3.710163715210181*^9, 
   3.710163959599413*^9, 3.710179230778123*^9, 3.7107742842040043`*^9, 
   3.710774372464241*^9, 3.710774430526037*^9, 3.710776945361003*^9, 
   3.710864979727187*^9, 3.7108651213370447`*^9, 3.7108651516279783`*^9, 
   3.7108653276757507`*^9, 3.710865477590829*^9, 3.711312260946509*^9, 
   3.7113134774526463`*^9, 3.711313540985652*^9, 3.7120864707925177`*^9, 
   3.712086523055552*^9},
 ExpressionUUID -> "da344205-c701-4bff-ae20-515034129153"]
}, Open  ]],

Cell["\<\
The eigenvalues of the an irrep is given by the following formula.\
\>", "Text",
 CellChangeTimes->{{3.6727242339832*^9, 3.672724267682274*^9}, 
   3.673056904529566*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"EigenLambda", "[", "nu_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n", ",", "k"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"k", "=", 
      RowBox[{"Length", "[", "nu", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"n", "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"nu", "[", 
         RowBox[{"[", "p", "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"p", ",", "1", ",", "k"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"n", "/", "2"}], "+", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"nu", "[", 
           RowBox[{"[", "p", "]"}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"nu", "[", 
             RowBox[{"[", "p", "]"}], "]"}], "-", 
            RowBox[{"2", "p"}]}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"p", ",", "1", ",", "k"}], "}"}]}], "]"}], "/", "2"}]}]}]}],
    "]"}]}]], "Input",
 CellChangeTimes->{{3.673494605332617*^9, 3.6734946076212807`*^9}},
 ExpressionUUID -> "fcbef7bf-099b-4fe6-8c1d-ec644fe185dc"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TableauReduction", "[", "yt_", "]"}], " ", ":=", " ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x", "=", "yt"}], ",", 
       RowBox[{"y", "=", 
        RowBox[{"{", 
         RowBox[{"Map", "[", 
          RowBox[{"Length", ",", "yt"}], "]"}], "}"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k", "=", 
         RowBox[{"Max", "[", "x", "]"}]}], ",", 
        RowBox[{"k", ">", " ", "2"}], ",", 
        RowBox[{"k", "--"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"x", "=", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{"x", ",", "k", ",", "2"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"y", " ", "=", " ", 
          RowBox[{"Append", "[", 
           RowBox[{"y", ",", 
            RowBox[{"DeleteCases", "[", 
             RowBox[{
              RowBox[{"Map", "[", 
               RowBox[{"Length", ",", "x"}], "]"}], ",", "0"}], "]"}]}], 
           "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Reverse", "[", "y", "]"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.672900761836541*^9, 3.672900764311183*^9}, 
   3.673040302223575*^9, {3.673040340839697*^9, 3.673040359482505*^9}, {
   3.673040398196455*^9, 3.673040398571237*^9}, {3.673041207146638*^9, 
   3.673041212146874*^9}, 3.673329658829343*^9},
 ExpressionUUID -> "3f6ad949-76b1-4e95-a26f-04317c4652f1"],

Cell["\<\
This is where the real work for finding the basis vectors happens. Instead of \
setting up a linear system and solve, I merely find the basis vectors of the \
null space of the (sum-of-class-operator - eigenvalue*Identity) operator. \
This process should yield dim-of-irrep number of eigenvectors which will be \
orthogonal to each other. \
\>", "Text",
 CellChangeTimes->{{3.6733785810083027`*^9, 3.673378660914193*^9}, {
   3.673378718182129*^9, 3.673378811699121*^9}, 3.67350241593253*^9, {
   3.6826972353973427`*^9, 3.682697236369564*^9}, 3.702095915387043*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"irrepeigvals", " ", "=", " ", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"comultiplier", ".", 
      RowBox[{"Map", "[", 
       RowBox[{"EigenLambda", ",", 
        RowBox[{"TableauReduction", "[", "#", "]"}]}], "]"}]}], "&"}], ",", 
    "youngtableaux"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.673494688562192*^9, 3.673494737892872*^9}, {
   3.673494774825961*^9, 3.673494783302642*^9}, {3.673494852455975*^9, 
   3.6734948544922457`*^9}, {3.6734948918134212`*^9, 3.673494939721361*^9}, {
   3.6734950934238157`*^9, 3.67349515104854*^9}, {3.673502975349791*^9, 
   3.67350298279075*^9}, {3.67376118703474*^9, 3.673761200329645*^9}, {
   3.673764505264986*^9, 3.673764508293853*^9}, {3.673764575408494*^9, 
   3.673764580463853*^9}, 3.696560980414649*^9},
 ExpressionUUID -> "2f710512-0659-4a45-bbfe-d10cfb2e34e6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"35", ",", 
   RowBox[{"-", "8"}], ",", "8", ",", 
   RowBox[{"-", "35"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.702102733634089*^9, {3.70246957158751*^9, 3.70246959772503*^9}, 
   3.702469689416494*^9, 3.702470198545958*^9, 3.702470262446917*^9, {
   3.7024725019258623`*^9, 3.70247252180266*^9}, {3.7024810365351553`*^9, 
   3.702481054016942*^9}, 3.702482359466846*^9, {3.702482443408328*^9, 
   3.7024824568532057`*^9}, {3.702482800908188*^9, 3.7024828111986713`*^9}, 
   3.702507449844969*^9, {3.7025094091035967`*^9, 3.702509421646069*^9}, 
   3.702509583791881*^9, 3.702509622685817*^9, {3.7025097215011806`*^9, 
   3.702509748781201*^9}, {3.702509786767726*^9, 3.70250980298067*^9}, 
   3.7025098331839123`*^9, 3.702509865771523*^9, {3.70250990434694*^9, 
   3.702509946455509*^9}, 3.702511399175725*^9, {3.702511439554285*^9, 
   3.702511463616379*^9}, {3.702513049087509*^9, 3.702513075554839*^9}, 
   3.702513321426662*^9, 3.702516819502174*^9, {3.7025169357913933`*^9, 
   3.702516961011862*^9}, {3.70256252581247*^9, 3.702562533860083*^9}, {
   3.7025645909365883`*^9, 3.7025646037234*^9}, 3.702571412987612*^9, 
   3.7025716056627007`*^9, 3.702598716805591*^9, 3.702598890277484*^9, 
   3.702598929910604*^9, 3.702599811099032*^9, {3.70260097268099*^9, 
   3.702600989424217*^9}, {3.702601022085112*^9, 3.702601037164816*^9}, 
   3.702602606659604*^9, {3.702637153972994*^9, 3.702637172816741*^9}, 
   3.702637481496159*^9, 3.7026597729597*^9, 3.7026598703791437`*^9, 
   3.7026832798474083`*^9, 3.702684589500999*^9, 3.70268474835187*^9, 
   3.702695685166912*^9, 3.702695738754414*^9, 3.7026963079167957`*^9, 
   3.70269651078183*^9, {3.702696873153038*^9, 3.702696886140917*^9}, 
   3.702697276098235*^9, 3.702697814360022*^9, {3.702697933274747*^9, 
   3.7026979605307713`*^9}, 3.702700593733794*^9, 3.7027024878899117`*^9, 
   3.702702987648082*^9, 3.70270383644834*^9, 3.7027054361688643`*^9, 
   3.702708887655525*^9, 3.702722029914218*^9, 3.702727716143448*^9, 
   3.702727769112887*^9, 3.702728630158284*^9, {3.7027288561902523`*^9, 
   3.7027288891635437`*^9}, 3.7027291140124187`*^9, 3.702733194429791*^9, 
   3.70273353923391*^9, 3.7027336679576807`*^9, 3.702734147943811*^9, 
   3.702734253822076*^9, 3.702735893080833*^9, 3.702743440879594*^9, 
   3.702746277307568*^9, 3.7027517289615088`*^9, 3.702753892849266*^9, 
   3.702785614466329*^9, 3.7028202793798113`*^9, 3.702820923869446*^9, 
   3.7028209566243773`*^9, 3.7028210671337757`*^9, 3.702821128828882*^9, 
   3.702821172559451*^9, 3.702824006726844*^9, 3.702824166092682*^9, 
   3.702899105776042*^9, {3.702908117986774*^9, 3.702908153724634*^9}, 
   3.702909139651649*^9, 3.7029131025492573`*^9, 3.70291313993321*^9, 
   3.702919975568946*^9, 3.7029821618640947`*^9, {3.7029865716640787`*^9, 
   3.70298658968353*^9}, 3.704734385973803*^9, 3.704735727587151*^9, 
   3.7047357933484*^9, {3.704736003122596*^9, 3.704736031186036*^9}, 
   3.7047367324458323`*^9, 3.704736923661088*^9, 3.704737110630691*^9, 
   3.704761709443346*^9, 3.704764365326214*^9, {3.705089798798699*^9, 
   3.705089814636448*^9}, 3.706055297661099*^9, 3.70880414209881*^9, 
   3.7100271803328743`*^9, 3.7101594299742107`*^9, 3.710163715630248*^9, 
   3.71016395962537*^9, 3.710179230814769*^9, 3.710774284495037*^9, 
   3.710774372645097*^9, 3.710774430711233*^9, 3.710776945494398*^9, 
   3.71086497976703*^9, 3.710865121369301*^9, 3.71086515166835*^9, 
   3.710865327722815*^9, 3.7108654776515293`*^9, 3.711312261133922*^9, 
   3.7113134774867973`*^9, 3.711313541017251*^9, 3.71208647098318*^9, 
   3.7120865236357594`*^9},
 ExpressionUUID -> "0cd0471d-4d24-48e5-bb96-7eaf0107be3c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{
    RowBox[{"T", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"Map", "[", 
       RowBox[{"Normalize", ",", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"ParallelTable", "[", 
           RowBox[{
            RowBox[{"NullSpace", "[", 
             RowBox[{"eigenoperator", "-", 
              RowBox[{
               RowBox[{"irrepeigvals", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "*", 
               RowBox[{"IdentityMatrix", "[", "noutputwords", "]"}]}]}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "[", "irrepeigvals", "]"}]}], "}"}]}], "]"}], 
          ",", "1"}], "]"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"MatrixForm", "[", "T", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.673495165750251*^9, 3.673495180855452*^9}, {
   3.673495213011654*^9, 3.6734952740078897`*^9}, {3.673495354528142*^9, 
   3.673495358475493*^9}, {3.673495442790786*^9, 3.673495448030904*^9}, {
   3.673496368801569*^9, 3.673496372031352*^9}, {3.6735020848735943`*^9, 
   3.673502092020294*^9}, {3.6735022518740683`*^9, 3.673502255153431*^9}, {
   3.673761209426714*^9, 3.673761216478816*^9}, {3.6737645102411003`*^9, 
   3.673764512296406*^9}, {3.673844363562715*^9, 3.673844383004805*^9}, {
   3.673844416289015*^9, 3.6738444238608303`*^9}, 3.673844455190033*^9, {
   3.702483318629691*^9, 3.702483330710142*^9}, {3.702509730601575*^9, 
   3.702509741752491*^9}, {3.702705461589286*^9, 3.702705472579927*^9}, 
   3.702706567968944*^9, 3.7027220766946583`*^9},
 ExpressionUUID -> "b44a35f6-e73e-426c-a30f-4fc565aa69ab"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", 
       SqrtBox["6"]], 
      FractionBox["1", 
       SqrtBox["6"]], 
      FractionBox["1", 
       SqrtBox["6"]], 
      FractionBox["1", 
       SqrtBox["6"]], 
      FractionBox["1", 
       SqrtBox["6"]], 
      FractionBox["1", 
       SqrtBox["6"]]},
     {
      FractionBox["1", "2"], "0", 
      RowBox[{"-", 
       FractionBox["1", "2"]}], 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", 
      FractionBox["1", "2"]},
     {
      RowBox[{"-", 
       FractionBox["1", "2"]}], 
      RowBox[{"-", 
       FractionBox["1", "2"]}], 
      FractionBox["1", "2"], "0", 
      FractionBox["1", "2"], "0"},
     {
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", 
      RowBox[{"-", 
       FractionBox["1", "2"]}], 
      FractionBox["1", "2"], "0", 
      FractionBox["1", "2"]},
     {
      RowBox[{"-", 
       FractionBox["1", "2"]}], 
      FractionBox["1", "2"], 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", 
      FractionBox["1", "2"], "0"},
     {
      RowBox[{"-", 
       FractionBox["1", 
        SqrtBox["6"]]}], 
      FractionBox["1", 
       SqrtBox["6"]], 
      FractionBox["1", 
       SqrtBox["6"]], 
      RowBox[{"-", 
       FractionBox["1", 
        SqrtBox["6"]]}], 
      RowBox[{"-", 
       FractionBox["1", 
        SqrtBox["6"]]}], 
      FractionBox["1", 
       SqrtBox["6"]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.702722077501752*^9, 3.702727716164743*^9, 3.702727769138089*^9, 
   3.702728630183648*^9, {3.702728856225532*^9, 3.7027288891865673`*^9}, 
   3.7027291140351133`*^9, 3.7027331944617767`*^9, 3.702733539258376*^9, 
   3.7027336679808607`*^9, 3.7027341479672327`*^9, 3.702734253890272*^9, 
   3.702735893106892*^9, 3.70274344090487*^9, 3.702746277380253*^9, 
   3.702751728983554*^9, 3.702753892886382*^9, 3.702785614490694*^9, 
   3.702820281000697*^9, 3.702820923904799*^9, 3.702820956658341*^9, 
   3.702821067155704*^9, 3.702821128853176*^9, 3.7028211725849867`*^9, 
   3.702824006913519*^9, 3.702824166116007*^9, 3.7028991076791487`*^9, {
   3.702908118133512*^9, 3.702908153747752*^9}, 3.702909139677157*^9, 
   3.7029131026008368`*^9, 3.7029131399574213`*^9, 3.702919975691012*^9, 
   3.702982163439458*^9, {3.7029865717483473`*^9, 3.702986589761414*^9}, 
   3.704734386071784*^9, 3.704735727608819*^9, 3.704735793382703*^9, {
   3.7047360031609077`*^9, 3.704736031218666*^9}, 3.704736732472073*^9, 
   3.704736923712199*^9, 3.704737110673168*^9, 3.704761710932764*^9, 
   3.704764365414016*^9, {3.705089799683771*^9, 3.705089814723724*^9}, 
   3.706055301259449*^9, 3.7088041422573843`*^9, 3.710027182819353*^9, 
   3.710159431650474*^9, 3.710163715745983*^9, 3.7101639596517763`*^9, 
   3.710179232214559*^9, 3.710774285656672*^9, 3.710774372740996*^9, 
   3.710774430787796*^9, 3.71077694558876*^9, 3.7108649813305693`*^9, 
   3.710865121417241*^9, 3.710865151710864*^9, 3.7108653277584963`*^9, 
   3.710865477867694*^9, 3.711312262017662*^9, 3.711313477532517*^9, 
   3.711313541048141*^9, 3.7120864719877234`*^9, 3.7120865238408213`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{
    RowBox[{"T", ".", 
     RowBox[{"ConjugateTranspose", "[", "T", "]"}]}], " ", "//", "Simplify"}],
    " ", "//", "MatrixForm", " "}]}]], "Input",
 CellChangeTimes->{{3.673495276616877*^9, 3.6734952811368647`*^9}, {
   3.673495387048965*^9, 3.673495389741561*^9}, 3.673503048778273*^9, {
   3.673761222337694*^9, 3.673761225731079*^9}, {3.673764516975292*^9, 
   3.6737645181406107`*^9}, {3.67384446186724*^9, 3.67384446453424*^9}},
 ExpressionUUID -> "73db2042-2fb1-4613-87e4-24e3b1c82968"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0"},
     {"0", "1", 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", "0", "0"},
     {"0", 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "1", "0", "0", "0"},
     {"0", "0", "0", "1", 
      FractionBox["1", "2"], "0"},
     {"0", "0", "0", 
      FractionBox["1", "2"], "1", "0"},
     {"0", "0", "0", "0", "0", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7024695725332212`*^9, 3.702469597757577*^9}, 
   3.7024696894590673`*^9, 3.702470198592558*^9, 3.702470262505226*^9, {
   3.70247250195872*^9, 3.702472521844882*^9}, {3.702481039350348*^9, 
   3.702481054068465*^9}, 3.70248235949671*^9, {3.702482443436769*^9, 
   3.702482456891244*^9}, {3.702482800945355*^9, 3.702482811225078*^9}, 
   3.702507451427225*^9, {3.702509409145323*^9, 3.702509421698133*^9}, 
   3.702509583843608*^9, 3.702509622740262*^9, {3.702509721549728*^9, 
   3.7025097488257303`*^9}, {3.702509786799094*^9, 3.702509803011538*^9}, 
   3.702509833213751*^9, 3.70250986580584*^9, {3.702509904376563*^9, 
   3.7025099464836407`*^9}, 3.702511399208778*^9, {3.702511439584058*^9, 
   3.702511463643887*^9}, {3.702513049126809*^9, 3.7025130757304487`*^9}, 
   3.70251332149933*^9, 3.7025168195767612`*^9, {3.70251693582355*^9, 
   3.702516961048994*^9}, 3.702562534241929*^9, {3.702564590999206*^9, 
   3.702564603766324*^9}, 3.702571414404253*^9, 3.702571605695882*^9, 
   3.7025987168596897`*^9, 3.70259889030899*^9, 3.702598929961123*^9, 
   3.7025998111325912`*^9, {3.7026009727124166`*^9, 3.702600989478689*^9}, {
   3.702601022130927*^9, 3.70260103721587*^9}, 3.7026026066941967`*^9, {
   3.7026371554805593`*^9, 3.7026371728481693`*^9}, 3.7026374815342007`*^9, 
   3.7026597741058064`*^9, 3.702659870434163*^9, 3.702683281579708*^9, 
   3.702684589531782*^9, 3.7026847483853683`*^9, 3.702695687051651*^9, 
   3.702695738784379*^9, 3.7026963079563313`*^9, 3.702696510813963*^9, {
   3.702696873183159*^9, 3.7026968861760674`*^9}, 3.702697276129637*^9, 
   3.7026978144213877`*^9, {3.702697933302209*^9, 3.7026979605568047`*^9}, 
   3.70270059376239*^9, 3.702702487947055*^9, 3.702702987678483*^9, 
   3.7027038364778214`*^9, 3.702705436204142*^9, 3.702708887687434*^9, 
   3.7027220299535303`*^9, 3.70272771618963*^9, 3.702727769161378*^9, 
   3.702728630206642*^9, {3.702728856232589*^9, 3.702728889207855*^9}, 
   3.702729114056081*^9, 3.702733194469194*^9, 3.702733539280095*^9, 
   3.702733668003763*^9, 3.702734147989373*^9, 3.702734253898411*^9, 
   3.702735893131678*^9, 3.702743440929991*^9, 3.702746277450863*^9, 
   3.7027517290041227`*^9, 3.702753892893643*^9, 3.7027856145163937`*^9, 
   3.7028202811841507`*^9, 3.70282092393062*^9, 3.7028209566838818`*^9, 
   3.7028210671786118`*^9, 3.7028211288773947`*^9, 3.7028211726066103`*^9, 
   3.702824007082569*^9, 3.702824166138771*^9, 3.702899107856501*^9, {
   3.702908118158888*^9, 3.702908153771017*^9}, 3.702909139699728*^9, 
   3.7029131026261272`*^9, 3.7029131399808807`*^9, 3.70291997576997*^9, 
   3.702982163573165*^9, {3.702986571822135*^9, 3.702986589837407*^9}, 
   3.7047343862527437`*^9, 3.70473572763093*^9, 3.704735793405765*^9, {
   3.7047360031986723`*^9, 3.704736031246804*^9}, 3.7047367324967737`*^9, 
   3.704736923755869*^9, 3.704737110713388*^9, 3.704761711236402*^9, 
   3.704764365489914*^9, {3.7050897997929277`*^9, 3.7050898148798447`*^9}, 
   3.70605530152351*^9, 3.7088041423283863`*^9, 3.7100271830533113`*^9, 
   3.710159431849275*^9, 3.710163715810121*^9, 3.710163959673052*^9, 
   3.710179232374132*^9, 3.710774285984918*^9, 3.7107743728166122`*^9, 
   3.710774430861067*^9, 3.710776945666333*^9, 3.710864981624256*^9, 
   3.7108651214455833`*^9, 3.710865151742087*^9, 3.710865327784618*^9, 
   3.71086547789677*^9, 3.711312262321115*^9, 3.711313477557288*^9, 
   3.711313541070985*^9, 3.71208647241441*^9, 3.71208652401077*^9},
 ExpressionUUID -> "37903895-94c6-49ae-ad73-50183a24711e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "exps", " ", "is", " ", "just", " ", "all", " ", "the", " ", "unique", " ",
     "exponential", " ", "factors", " ", "occuring", " ", "in", " ", 
    RowBox[{"R", ".", " ", "Simpleratematrix"}], " ", "has", " ", "these", 
    " ", "factors", " ", "replaced", " ", "by", " ", 
    RowBox[{"\\[", "CaptialDelta", "]"}], "_i"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"exps", " ", "=", "  ", 
     RowBox[{"DeleteDuplicates", "[", 
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", "R", "]"}], ",", 
        RowBox[{"Exp", "[", "_", "]"}], ",", "Infinity"}], "]"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"exps", "=", 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["s", "2"]}], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["\[Tau]", "1"], "-", 
            SubscriptBox["\[Tau]", "2"]}], ")"}], "2"]}]], ",", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["s", "2"]}], " ", 
         RowBox[{"(", 
          RowBox[{
           SubsuperscriptBox["\[Tau]", "1", "2"], "-", 
           RowBox[{"2", " ", 
            SubscriptBox["\[Tau]", "1"], " ", 
            SubscriptBox["\[Tau]", "2"]}], "+", 
           SubsuperscriptBox["\[Tau]", "2", "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["\[Tau]", "3"], "-", 
              SubscriptBox["\[Tau]", "4"]}], ")"}], "2"]}], ")"}]}]], ",", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["s", "2"]}], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["\[Tau]", "3"], "-", 
            SubscriptBox["\[Tau]", "4"]}], ")"}], "2"]}]], ",", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["s", "2"]}], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["\[Tau]", "2"], "-", 
            SubscriptBox["\[Tau]", "3"]}], ")"}], "2"]}]], ",", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["s", "2"]}], " ", 
         RowBox[{"(", 
          RowBox[{
           SubsuperscriptBox["\[Tau]", "1", "2"], "+", 
           SubsuperscriptBox["\[Tau]", "2", "2"], "-", 
           RowBox[{
            SubscriptBox["\[Tau]", "2"], " ", 
            SubscriptBox["\[Tau]", "3"]}], "+", 
           SubsuperscriptBox["\[Tau]", "3", "2"], "-", 
           RowBox[{
            SubscriptBox["\[Tau]", "1"], " ", 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["\[Tau]", "2"], "+", 
              SubscriptBox["\[Tau]", "3"]}], ")"}]}]}], ")"}]}]], ",", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["s", "2"]}], " ", 
         RowBox[{"(", 
          RowBox[{
           SubsuperscriptBox["\[Tau]", "1", "2"], "+", 
           SubsuperscriptBox["\[Tau]", "2", "2"], "+", 
           SubsuperscriptBox["\[Tau]", "3", "2"], "-", 
           RowBox[{
            SubscriptBox["\[Tau]", "1"], " ", 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["\[Tau]", "2"], "+", 
              SubscriptBox["\[Tau]", "3"]}], ")"}]}], "-", 
           RowBox[{
            SubscriptBox["\[Tau]", "2"], " ", 
            SubscriptBox["\[Tau]", "4"]}], "-", 
           RowBox[{
            SubscriptBox["\[Tau]", "3"], " ", 
            SubscriptBox["\[Tau]", "4"]}], "+", 
           SubsuperscriptBox["\[Tau]", "4", "2"]}], ")"}]}]], ",", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["s", "2"]}], " ", 
         RowBox[{"(", 
          RowBox[{
           SubsuperscriptBox["\[Tau]", "2", "2"], "+", 
           SubsuperscriptBox["\[Tau]", "3", "2"], "-", 
           RowBox[{
            SubscriptBox["\[Tau]", "3"], " ", 
            SubscriptBox["\[Tau]", "4"]}], "+", 
           SubsuperscriptBox["\[Tau]", "4", "2"], "-", 
           RowBox[{
            SubscriptBox["\[Tau]", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["\[Tau]", "3"], "+", 
              SubscriptBox["\[Tau]", "4"]}], ")"}]}]}], ")"}]}]], ",", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["s", "2"]}], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["\[Tau]", "2"], "-", 
            SubscriptBox["\[Tau]", "4"]}], ")"}], "2"]}]], ",", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["s", "2"]}], " ", 
         RowBox[{"(", 
          RowBox[{
           SubsuperscriptBox["\[Tau]", "1", "2"], "+", 
           SubsuperscriptBox["\[Tau]", "2", "2"], "-", 
           RowBox[{
            SubscriptBox["\[Tau]", "2"], " ", 
            SubscriptBox["\[Tau]", "4"]}], "+", 
           SubsuperscriptBox["\[Tau]", "4", "2"], "-", 
           RowBox[{
            SubscriptBox["\[Tau]", "1"], " ", 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["\[Tau]", "2"], "+", 
              SubscriptBox["\[Tau]", "4"]}], ")"}]}]}], ")"}]}]], ",", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["s", "2"]}], " ", 
         RowBox[{"(", 
          RowBox[{
           SubsuperscriptBox["\[Tau]", "1", "2"], "+", 
           SubsuperscriptBox["\[Tau]", "2", "2"], "-", 
           RowBox[{
            SubscriptBox["\[Tau]", "2"], " ", 
            SubscriptBox["\[Tau]", "3"]}], "+", 
           SubsuperscriptBox["\[Tau]", "3", "2"], "-", 
           RowBox[{
            SubscriptBox["\[Tau]", "3"], " ", 
            SubscriptBox["\[Tau]", "4"]}], "+", 
           SubsuperscriptBox["\[Tau]", "4", "2"], "-", 
           RowBox[{
            SubscriptBox["\[Tau]", "1"], " ", 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["\[Tau]", "2"], "+", 
              SubscriptBox["\[Tau]", "4"]}], ")"}]}]}], ")"}]}]], ",", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["s", "2"]}], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["\[Tau]", "1"], "-", 
            SubscriptBox["\[Tau]", "3"]}], ")"}], "2"]}]], ",", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["s", "2"]}], " ", 
         RowBox[{"(", 
          RowBox[{
           SubsuperscriptBox["\[Tau]", "1", "2"], "+", 
           SubsuperscriptBox["\[Tau]", "3", "2"], "-", 
           RowBox[{
            SubscriptBox["\[Tau]", "3"], " ", 
            SubscriptBox["\[Tau]", "4"]}], "+", 
           SubsuperscriptBox["\[Tau]", "4", "2"], "-", 
           RowBox[{
            SubscriptBox["\[Tau]", "1"], " ", 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["\[Tau]", "3"], "+", 
              SubscriptBox["\[Tau]", "4"]}], ")"}]}]}], ")"}]}]], ",", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["s", "2"]}], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["\[Tau]", "1"], "-", 
            SubscriptBox["\[Tau]", "4"]}], ")"}], "2"]}]], ",", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["s", "2"]}], " ", 
         RowBox[{"(", 
          RowBox[{
           SubsuperscriptBox["\[Tau]", "1", "2"], "+", 
           SubsuperscriptBox["\[Tau]", "2", "2"], "-", 
           RowBox[{"2", " ", 
            SubscriptBox["\[Tau]", "2"], " ", 
            SubscriptBox["\[Tau]", "3"]}], "+", 
           SubsuperscriptBox["\[Tau]", "3", "2"], "-", 
           RowBox[{"2", " ", 
            SubscriptBox["\[Tau]", "1"], " ", 
            SubscriptBox["\[Tau]", "4"]}], "+", 
           SubsuperscriptBox["\[Tau]", "4", "2"]}], ")"}]}]], ",", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["s", "2"]}], " ", 
         RowBox[{"(", 
          RowBox[{
           SubsuperscriptBox["\[Tau]", "1", "2"], "+", 
           SubsuperscriptBox["\[Tau]", "2", "2"], "-", 
           RowBox[{"2", " ", 
            SubscriptBox["\[Tau]", "1"], " ", 
            SubscriptBox["\[Tau]", "3"]}], "+", 
           SubsuperscriptBox["\[Tau]", "3", "2"], "-", 
           RowBox[{"2", " ", 
            SubscriptBox["\[Tau]", "2"], " ", 
            SubscriptBox["\[Tau]", "4"]}], "+", 
           SubsuperscriptBox["\[Tau]", "4", "2"]}], ")"}]}]], ",", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["s", "2"]}], " ", 
         RowBox[{"(", 
          RowBox[{
           SubsuperscriptBox["\[Tau]", "1", "2"], "+", 
           SubsuperscriptBox["\[Tau]", "2", "2"], "+", 
           SubsuperscriptBox["\[Tau]", "3", "2"], "+", 
           SubsuperscriptBox["\[Tau]", "4", "2"], "-", 
           RowBox[{
            SubscriptBox["\[Tau]", "1"], " ", 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["\[Tau]", "3"], "+", 
              SubscriptBox["\[Tau]", "4"]}], ")"}]}], "-", 
           RowBox[{
            SubscriptBox["\[Tau]", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["\[Tau]", "3"], "+", 
              SubscriptBox["\[Tau]", "4"]}], ")"}]}]}], ")"}]}]]}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"simpleratematrix", " ", "=", " ", 
     RowBox[{"R", " ", "/.", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"exps", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", " ", 
         SubscriptBox["\[CapitalDelta]", "i"]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "exps", "]"}]}], "}"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"MatrixForm", "[", "simpleratematrix", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6730461377756577`*^9, 3.67304618327962*^9}, {
   3.673141230401381*^9, 3.6731412439816227`*^9}, {3.6731532933091803`*^9, 
   3.673153296772765*^9}, {3.673156705444436*^9, 3.673156867788455*^9}, {
   3.6733258619649677`*^9, 3.673325896551353*^9}, 3.673330581225546*^9, {
   3.673330638996608*^9, 3.6733306412985563`*^9}, {3.6733306731056356`*^9, 
   3.673330675579123*^9}, {3.673332071259481*^9, 3.673332083465523*^9}, {
   3.6733331082524548`*^9, 3.673333109019341*^9}, {3.673378889811949*^9, 
   3.673378947850202*^9}, {3.673502275366123*^9, 3.673502287039386*^9}, {
   3.673503174142963*^9, 3.673503174424065*^9}, {3.673503479543388*^9, 
   3.673503516189302*^9}, {3.67350358677243*^9, 3.673503631494927*^9}, {
   3.6735036700538473`*^9, 3.6735036729153433`*^9}, {3.6737613269227543`*^9, 
   3.6737613580939627`*^9}, {3.6961919963464108`*^9, 3.69619200015265*^9}, {
   3.6961925234082317`*^9, 3.6961925254218197`*^9}, {3.696271668253909*^9, 
   3.69627167081605*^9}, {3.696560993801252*^9, 3.6965610028943453`*^9}, 
   3.696572616806727*^9, {3.702509762450185*^9, 3.7025097709789743`*^9}},
 ExpressionUUID -> "93d47962-96c5-4314-bdf0-45c48899b180"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", 
      SubscriptBox["\[CapitalDelta]", "4"], 
      SubscriptBox["\[CapitalDelta]", "1"], 
      SubscriptBox["\[CapitalDelta]", "5"], 
      SubscriptBox["\[CapitalDelta]", "5"], 
      SubscriptBox["\[CapitalDelta]", "11"]},
     {
      SubscriptBox["\[CapitalDelta]", "4"], "1", 
      SubscriptBox["\[CapitalDelta]", "5"], 
      SubscriptBox["\[CapitalDelta]", "11"], 
      SubscriptBox["\[CapitalDelta]", "1"], 
      SubscriptBox["\[CapitalDelta]", "5"]},
     {
      SubscriptBox["\[CapitalDelta]", "1"], 
      SubscriptBox["\[CapitalDelta]", "5"], "1", 
      SubscriptBox["\[CapitalDelta]", "4"], 
      SubscriptBox["\[CapitalDelta]", "11"], 
      SubscriptBox["\[CapitalDelta]", "5"]},
     {
      SubscriptBox["\[CapitalDelta]", "5"], 
      SubscriptBox["\[CapitalDelta]", "11"], 
      SubscriptBox["\[CapitalDelta]", "4"], "1", 
      SubscriptBox["\[CapitalDelta]", "5"], 
      SubscriptBox["\[CapitalDelta]", "1"]},
     {
      SubscriptBox["\[CapitalDelta]", "5"], 
      SubscriptBox["\[CapitalDelta]", "1"], 
      SubscriptBox["\[CapitalDelta]", "11"], 
      SubscriptBox["\[CapitalDelta]", "5"], "1", 
      SubscriptBox["\[CapitalDelta]", "4"]},
     {
      SubscriptBox["\[CapitalDelta]", "11"], 
      SubscriptBox["\[CapitalDelta]", "5"], 
      SubscriptBox["\[CapitalDelta]", "5"], 
      SubscriptBox["\[CapitalDelta]", "1"], 
      SubscriptBox["\[CapitalDelta]", "4"], "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.702469572568325*^9, 3.702469597787613*^9}, 
   3.7024696894823236`*^9, 3.7024701986195498`*^9, 3.7024702625944567`*^9, {
   3.702472501980143*^9, 3.702472521867853*^9}, {3.702481039412097*^9, 
   3.702481054110358*^9}, 3.702482359517708*^9, {3.702482443455803*^9, 
   3.702482456913816*^9}, {3.702482800964271*^9, 3.702482811243844*^9}, 
   3.702507451474457*^9, {3.7025094091721487`*^9, 3.7025094217247753`*^9}, 
   3.702509583873909*^9, 3.7025096227712517`*^9, {3.702509721576272*^9, 
   3.702509803034788*^9}, 3.70250983323813*^9, 3.702509865835566*^9, {
   3.7025099044022617`*^9, 3.7025099465062437`*^9}, 3.7025113992357893`*^9, {
   3.702511439613728*^9, 3.702511463671658*^9}, {3.702513049165515*^9, 
   3.702513075863965*^9}, 3.702513321569057*^9, 3.7025168196165323`*^9, {
   3.7025169358486967`*^9, 3.7025169610796547`*^9}, 3.7025625343235817`*^9, {
   3.7025645910403223`*^9, 3.7025646037906923`*^9}, 3.702571414469617*^9, 
   3.702571605720957*^9, 3.702598716909236*^9, 3.7025988903426733`*^9, 
   3.70259893001257*^9, 3.7025998111651697`*^9, {3.70260097274317*^9, 
   3.702600989515133*^9}, {3.702601022171233*^9, 3.702601037254966*^9}, 
   3.7026026067321253`*^9, {3.702637155551133*^9, 3.702637172875864*^9}, 
   3.7026374815673513`*^9, 3.702659774159841*^9, 3.7026598705096083`*^9, 
   3.7026832817234697`*^9, 3.702684589555874*^9, 3.702684748410315*^9, 
   3.702695687105237*^9, 3.702695738809288*^9, 3.70269630798134*^9, 
   3.702696510838593*^9, {3.7026968732060432`*^9, 3.7026968862037287`*^9}, 
   3.702697276156006*^9, 3.702697814441682*^9, {3.702697933328951*^9, 
   3.702697960583531*^9}, 3.702700593790185*^9, 3.7027024880049353`*^9, 
   3.702702987707625*^9, 3.702703836506742*^9, 3.702705436234395*^9, 
   3.702708887717183*^9, 3.702722029989274*^9, 3.702727716219995*^9, 
   3.702727769190145*^9, 3.702728630235345*^9, {3.702728856269464*^9, 
   3.702728889235568*^9}, 3.702729114081159*^9, 3.7027331945003433`*^9, 
   3.702733539316433*^9, 3.702733668034651*^9, 3.702734148016947*^9, 
   3.702734253971353*^9, 3.7027358931616983`*^9, 3.702743440961072*^9, 
   3.702746277528885*^9, 3.702751729030541*^9, 3.702753892933043*^9, 
   3.702785614542202*^9, 3.702820281383554*^9, 3.7028209239547*^9, 
   3.702820956704089*^9, 3.702821067200098*^9, 3.70282112890145*^9, 
   3.702821172638277*^9, 3.702824007256147*^9, 3.702824166160017*^9, 
   3.702899108012828*^9, {3.702908118288385*^9, 3.702908153793415*^9}, 
   3.702909139721591*^9, 3.702913102650405*^9, 3.702913140005712*^9, 
   3.7029199758534527`*^9, 3.702982163671159*^9, {3.702986571903598*^9, 
   3.702986589923561*^9}, 3.704734386328721*^9, 3.7047357276519747`*^9, 
   3.704735793427616*^9, {3.7047360032347403`*^9, 3.704736031278824*^9}, 
   3.704736732521558*^9, 3.7047369237965927`*^9, 3.70473711076167*^9, 
   3.7047617112705193`*^9, 3.704764365573605*^9, {3.705089799964085*^9, 
   3.7050898149591923`*^9}, 3.706055301694187*^9, 3.7088041424200277`*^9, 
   3.710027183100871*^9, 3.710159431916739*^9, 3.71016371595042*^9, 
   3.7101639597011833`*^9, 3.710179232438428*^9, 3.7107742861610317`*^9, 
   3.710774372893145*^9, 3.7107744309396343`*^9, 3.7107769457800198`*^9, 
   3.710864981702629*^9, 3.710865121472046*^9, 3.710865151783709*^9, 
   3.710865327825058*^9, 3.710865477931643*^9, 3.711312262490323*^9, 
   3.711313477589568*^9, 3.711313541100234*^9, 3.7120864725002623`*^9, 
   3.71208652409234*^9},
 ExpressionUUID -> "613e699d-6a1e-4678-9ce9-bb47a6565322"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"UnitaryMatrixQ", "[", "T", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"blockdiagonalrates", "=", 
   RowBox[{
    RowBox[{"T", ".", "simpleratematrix", ".", 
     RowBox[{"Transpose", "[", "T", "]"}]}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "blockdiagonalrates", "]"}]}], "Input",
 CellChangeTimes->{{3.6730461879481583`*^9, 3.673046192593768*^9}, {
   3.67305578886078*^9, 3.673055793442738*^9}, {3.6731413848876963`*^9, 
   3.673141389780972*^9}, {3.673142487769457*^9, 3.6731424894497023`*^9}, 
   3.67315350243153*^9, {3.6731564959517317`*^9, 3.673156527216269*^9}, 
   3.673156875329376*^9, {3.6733259155903473`*^9, 3.673325919547765*^9}, {
   3.673325988832446*^9, 3.673325989518897*^9}, {3.673451884330974*^9, 
   3.673451885584469*^9}, {3.673502291346415*^9, 3.673502291461666*^9}, {
   3.673503729733919*^9, 3.6735037313646727`*^9}, {3.673761372710828*^9, 
   3.673761382231723*^9}, 3.673844476724003*^9},
 Background->RGBColor[1, 0.925, 0.925],
 ExpressionUUID -> "ccc2c7c4-e41c-4667-847a-66d4f5729994"],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{
  3.702102699807111*^9, {3.702469572609651*^9, 3.702469597814529*^9}, 
   3.7024696894920692`*^9, 3.702470198631382*^9, 3.7024702626669493`*^9, {
   3.702472501989353*^9, 3.7024725218779287`*^9}, {3.7024810394252367`*^9, 
   3.702481054120071*^9}, 3.702482359526956*^9, {3.7024824434641457`*^9, 
   3.70248245692345*^9}, {3.7024828009729643`*^9, 3.702482811252488*^9}, 
   3.702507451490596*^9, {3.702509409193912*^9, 3.7025094217357597`*^9}, 
   3.702509583901711*^9, 3.702509622796817*^9, {3.702509721587096*^9, 
   3.702509748863447*^9}, {3.7025097868318043`*^9, 3.70250980304531*^9}, 
   3.702509833247838*^9, 3.702509865845853*^9, {3.70250990441392*^9, 
   3.702509946516859*^9}, 3.702511399257873*^9, {3.7025114396367807`*^9, 
   3.7025114636922903`*^9}, {3.702513049194807*^9, 3.702513075873146*^9}, 
   3.702513321645348*^9, 3.7025168196488113`*^9, {3.7025169358614883`*^9, 
   3.702516961093328*^9}, 3.7025625343986588`*^9, {3.7025645910905943`*^9, 
   3.702564603799528*^9}, 3.702571414482798*^9, 3.702571605731542*^9, 
   3.702598716949603*^9, 3.702598890370256*^9, 3.7025989300544167`*^9, 
   3.70259981119814*^9, {3.7026009727583427`*^9, 3.702600989545725*^9}, {
   3.702601022204421*^9, 3.702601037287463*^9}, 3.702602606760906*^9, {
   3.7026371555599413`*^9, 3.702637172896598*^9}, 3.702637481594002*^9, 
   3.702659774207717*^9, 3.702659870565572*^9, 3.70268328185618*^9, 
   3.702684589565547*^9, 3.702684748420035*^9, 3.70269568713235*^9, 
   3.7026957388186703`*^9, 3.7026963079915037`*^9, 3.7026965108575277`*^9, {
   3.7026968732152767`*^9, 3.702696886224599*^9}, 3.702697276175136*^9, 
   3.7026978144487534`*^9, {3.7026979333495407`*^9, 3.702697960604515*^9}, 
   3.702700593811811*^9, 3.702702488053041*^9, 3.7027029877305403`*^9, 
   3.702703836531743*^9, 3.702705436259502*^9, 3.702708887739964*^9, 
   3.702722030016712*^9, 3.702727716242128*^9, 3.702727769214644*^9, 
   3.7027286302544394`*^9, {3.702728856295911*^9, 3.702728889257238*^9}, 
   3.70272911410163*^9, 3.702733194526597*^9, 3.702733539338163*^9, 
   3.7027336680581827`*^9, 3.702734148039613*^9, 3.702734254042717*^9, 
   3.702735893186496*^9, 3.7027434409887457`*^9, 3.702746277601317*^9, 
   3.7027517290533733`*^9, 3.702753892940598*^9, 3.702785614551621*^9, 
   3.702820281456112*^9, 3.702820923979145*^9, 3.702820956712955*^9, 
   3.702821067208647*^9, 3.70282112891035*^9, 3.702821172661605*^9, 
   3.702824007400095*^9, 3.702824166169695*^9, 3.702899108034464*^9, {
   3.702908118312703*^9, 3.70290815380295*^9}, 3.702909139730379*^9, 
   3.702913102659693*^9, 3.7029131400316973`*^9, 3.702919975931828*^9, 
   3.702982163761396*^9, {3.702986571979438*^9, 3.702986590005972*^9}, 
   3.704734386395664*^9, 3.704735727660625*^9, 3.7047357934365997`*^9, {
   3.704736003244063*^9, 3.704736031288053*^9}, 3.704736732530664*^9, 
   3.7047369238065567`*^9, 3.704737110802569*^9, 3.704761711359599*^9, 
   3.704764365647286*^9, {3.7050897999977913`*^9, 3.705089815034651*^9}, 
   3.706055301720455*^9, 3.70880414250004*^9, 3.710027183113942*^9, 
   3.710159431942307*^9, 3.7101637160139647`*^9, 3.710163959722536*^9, 
   3.710179232449841*^9, 3.710180017738505*^9, 3.710774286336866*^9, 
   3.7107743729716463`*^9, 3.710774431013411*^9, 3.7107769458933487`*^9, 
   3.710864981738213*^9, 3.710865121481317*^9, 3.710865151816251*^9, 
   3.710865327860455*^9, 3.710865477965962*^9, 3.71131226251726*^9, 
   3.7113134776141367`*^9, 3.711313541123025*^9, 3.712086472603045*^9, 
   3.712086524269944*^9},
 ExpressionUUID -> "f9d7b410-c934-4efc-90e4-13102873579e"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"1", "+", 
       SubscriptBox["\[CapitalDelta]", "1"], "+", 
       SubscriptBox["\[CapitalDelta]", "4"], "+", 
       RowBox[{"2", " ", 
        SubscriptBox["\[CapitalDelta]", "5"]}], "+", 
       SubscriptBox["\[CapitalDelta]", "11"]}], "0", "0", "0", "0", "0"},
     {"0", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"2", "-", 
         RowBox[{"2", " ", 
          SubscriptBox["\[CapitalDelta]", "1"]}], "+", 
         SubscriptBox["\[CapitalDelta]", "4"], "-", 
         RowBox[{"2", " ", 
          SubscriptBox["\[CapitalDelta]", "5"]}], "+", 
         SubscriptBox["\[CapitalDelta]", "11"]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", 
         RowBox[{"2", " ", 
          SubscriptBox["\[CapitalDelta]", "1"]}], "-", 
         SubscriptBox["\[CapitalDelta]", "4"], "+", 
         RowBox[{"2", " ", 
          SubscriptBox["\[CapitalDelta]", "5"]}], "-", 
         SubscriptBox["\[CapitalDelta]", "11"]}], ")"}]}], "0", 
      RowBox[{
       FractionBox["3", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["\[CapitalDelta]", "4"], "-", 
         SubscriptBox["\[CapitalDelta]", "11"]}], ")"}]}], "0"},
     {"0", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", 
         RowBox[{"2", " ", 
          SubscriptBox["\[CapitalDelta]", "1"]}], "-", 
         SubscriptBox["\[CapitalDelta]", "4"], "+", 
         RowBox[{"2", " ", 
          SubscriptBox["\[CapitalDelta]", "5"]}], "-", 
         SubscriptBox["\[CapitalDelta]", "11"]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"2", "-", 
         RowBox[{"2", " ", 
          SubscriptBox["\[CapitalDelta]", "1"]}], "+", 
         SubscriptBox["\[CapitalDelta]", "4"], "-", 
         RowBox[{"2", " ", 
          SubscriptBox["\[CapitalDelta]", "5"]}], "+", 
         SubscriptBox["\[CapitalDelta]", "11"]}], ")"}]}], 
      RowBox[{
       FractionBox["3", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["\[CapitalDelta]", "4"], "-", 
         SubscriptBox["\[CapitalDelta]", "11"]}], ")"}]}], "0", "0"},
     {"0", "0", 
      RowBox[{
       FractionBox["3", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["\[CapitalDelta]", "4"], "-", 
         SubscriptBox["\[CapitalDelta]", "11"]}], ")"}]}], 
      RowBox[{"1", "+", 
       SubscriptBox["\[CapitalDelta]", "1"], "-", 
       FractionBox[
        SubscriptBox["\[CapitalDelta]", "4"], "2"], "-", 
       SubscriptBox["\[CapitalDelta]", "5"], "-", 
       FractionBox[
        SubscriptBox["\[CapitalDelta]", "11"], "2"]}], 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", 
         RowBox[{"2", " ", 
          SubscriptBox["\[CapitalDelta]", "1"]}], "-", 
         SubscriptBox["\[CapitalDelta]", "4"], "-", 
         RowBox[{"2", " ", 
          SubscriptBox["\[CapitalDelta]", "5"]}], "-", 
         SubscriptBox["\[CapitalDelta]", "11"]}], ")"}]}], "0"},
     {"0", 
      RowBox[{
       FractionBox["3", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["\[CapitalDelta]", "4"], "-", 
         SubscriptBox["\[CapitalDelta]", "11"]}], ")"}]}], "0", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", 
         RowBox[{"2", " ", 
          SubscriptBox["\[CapitalDelta]", "1"]}], "-", 
         SubscriptBox["\[CapitalDelta]", "4"], "-", 
         RowBox[{"2", " ", 
          SubscriptBox["\[CapitalDelta]", "5"]}], "-", 
         SubscriptBox["\[CapitalDelta]", "11"]}], ")"}]}], 
      RowBox[{"1", "+", 
       SubscriptBox["\[CapitalDelta]", "1"], "-", 
       FractionBox[
        SubscriptBox["\[CapitalDelta]", "4"], "2"], "-", 
       SubscriptBox["\[CapitalDelta]", "5"], "-", 
       FractionBox[
        SubscriptBox["\[CapitalDelta]", "11"], "2"]}], "0"},
     {"0", "0", "0", "0", "0", 
      RowBox[{"1", "-", 
       SubscriptBox["\[CapitalDelta]", "1"], "-", 
       SubscriptBox["\[CapitalDelta]", "4"], "+", 
       RowBox[{"2", " ", 
        SubscriptBox["\[CapitalDelta]", "5"]}], "-", 
       SubscriptBox["\[CapitalDelta]", "11"]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.702102699807111*^9, {3.702469572609651*^9, 3.702469597814529*^9}, 
   3.7024696894920692`*^9, 3.702470198631382*^9, 3.7024702626669493`*^9, {
   3.702472501989353*^9, 3.7024725218779287`*^9}, {3.7024810394252367`*^9, 
   3.702481054120071*^9}, 3.702482359526956*^9, {3.7024824434641457`*^9, 
   3.70248245692345*^9}, {3.7024828009729643`*^9, 3.702482811252488*^9}, 
   3.702507451490596*^9, {3.702509409193912*^9, 3.7025094217357597`*^9}, 
   3.702509583901711*^9, 3.702509622796817*^9, {3.702509721587096*^9, 
   3.702509748863447*^9}, {3.7025097868318043`*^9, 3.70250980304531*^9}, 
   3.702509833247838*^9, 3.702509865845853*^9, {3.70250990441392*^9, 
   3.702509946516859*^9}, 3.702511399257873*^9, {3.7025114396367807`*^9, 
   3.7025114636922903`*^9}, {3.702513049194807*^9, 3.702513075873146*^9}, 
   3.702513321645348*^9, 3.7025168196488113`*^9, {3.7025169358614883`*^9, 
   3.702516961093328*^9}, 3.7025625343986588`*^9, {3.7025645910905943`*^9, 
   3.702564603799528*^9}, 3.702571414482798*^9, 3.702571605731542*^9, 
   3.702598716949603*^9, 3.702598890370256*^9, 3.7025989300544167`*^9, 
   3.70259981119814*^9, {3.7026009727583427`*^9, 3.702600989545725*^9}, {
   3.702601022204421*^9, 3.702601037287463*^9}, 3.702602606760906*^9, {
   3.7026371555599413`*^9, 3.702637172896598*^9}, 3.702637481594002*^9, 
   3.702659774207717*^9, 3.702659870565572*^9, 3.70268328185618*^9, 
   3.702684589565547*^9, 3.702684748420035*^9, 3.70269568713235*^9, 
   3.7026957388186703`*^9, 3.7026963079915037`*^9, 3.7026965108575277`*^9, {
   3.7026968732152767`*^9, 3.702696886224599*^9}, 3.702697276175136*^9, 
   3.7026978144487534`*^9, {3.7026979333495407`*^9, 3.702697960604515*^9}, 
   3.702700593811811*^9, 3.702702488053041*^9, 3.7027029877305403`*^9, 
   3.702703836531743*^9, 3.702705436259502*^9, 3.702708887739964*^9, 
   3.702722030016712*^9, 3.702727716242128*^9, 3.702727769214644*^9, 
   3.7027286302544394`*^9, {3.702728856295911*^9, 3.702728889257238*^9}, 
   3.70272911410163*^9, 3.702733194526597*^9, 3.702733539338163*^9, 
   3.7027336680581827`*^9, 3.702734148039613*^9, 3.702734254042717*^9, 
   3.702735893186496*^9, 3.7027434409887457`*^9, 3.702746277601317*^9, 
   3.7027517290533733`*^9, 3.702753892940598*^9, 3.702785614551621*^9, 
   3.702820281456112*^9, 3.702820923979145*^9, 3.702820956712955*^9, 
   3.702821067208647*^9, 3.70282112891035*^9, 3.702821172661605*^9, 
   3.702824007400095*^9, 3.702824166169695*^9, 3.702899108034464*^9, {
   3.702908118312703*^9, 3.70290815380295*^9}, 3.702909139730379*^9, 
   3.702913102659693*^9, 3.7029131400316973`*^9, 3.702919975931828*^9, 
   3.702982163761396*^9, {3.702986571979438*^9, 3.702986590005972*^9}, 
   3.704734386395664*^9, 3.704735727660625*^9, 3.7047357934365997`*^9, {
   3.704736003244063*^9, 3.704736031288053*^9}, 3.704736732530664*^9, 
   3.7047369238065567`*^9, 3.704737110802569*^9, 3.704761711359599*^9, 
   3.704764365647286*^9, {3.7050897999977913`*^9, 3.705089815034651*^9}, 
   3.706055301720455*^9, 3.70880414250004*^9, 3.710027183113942*^9, 
   3.710159431942307*^9, 3.7101637160139647`*^9, 3.710163959722536*^9, 
   3.710179232449841*^9, 3.710180017738505*^9, 3.710774286336866*^9, 
   3.7107743729716463`*^9, 3.710774431013411*^9, 3.7107769458933487`*^9, 
   3.710864981738213*^9, 3.710865121481317*^9, 3.710865151816251*^9, 
   3.710865327860455*^9, 3.710865477965962*^9, 3.71131226251726*^9, 
   3.7113134776141367`*^9, 3.711313541123025*^9, 3.712086472603045*^9, 
   3.712086524274954*^9},
 ExpressionUUID -> "f9d7b410-c934-4efc-90e4-13102873579e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"vblockdiagonal", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"T", ".", "vvector"}], " ", "//", "FullSimplify"}], " ", "//", 
   "Expand", "  "}]}]], "Input",
 CellChangeTimes->{{3.673055848466523*^9, 3.6730558542183723`*^9}, 
   3.6730561605730886`*^9, {3.6925468421269073`*^9, 3.69254684439359*^9}, {
   3.692547790073318*^9, 3.692547790722875*^9}, {3.6965606125723667`*^9, 
   3.696560616611795*^9}, 3.696563693686602*^9, {3.6965637548104067`*^9, 
   3.6965638239117813`*^9}, 3.702089466451104*^9, {3.7020895115319138`*^9, 
   3.702089593081168*^9}},
 ExpressionUUID -> "cae08992-3441-4e1e-92db-f57e3c3cc033"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{
      SubscriptBox["U", "13"], " ", 
      SubscriptBox["U", "22"], " ", 
      SubscriptBox["U", "31"]}], 
     SqrtBox["6"]], "+", 
    FractionBox[
     RowBox[{
      SubscriptBox["U", "12"], " ", 
      SubscriptBox["U", "23"], " ", 
      SubscriptBox["U", "31"]}], 
     SqrtBox["6"]], "+", 
    FractionBox[
     RowBox[{
      SubscriptBox["U", "13"], " ", 
      SubscriptBox["U", "21"], " ", 
      SubscriptBox["U", "32"]}], 
     SqrtBox["6"]], "+", 
    FractionBox[
     RowBox[{
      SubscriptBox["U", "11"], " ", 
      SubscriptBox["U", "23"], " ", 
      SubscriptBox["U", "32"]}], 
     SqrtBox["6"]], "+", 
    FractionBox[
     RowBox[{
      SubscriptBox["U", "12"], " ", 
      SubscriptBox["U", "21"], " ", 
      SubscriptBox["U", "33"]}], 
     SqrtBox["6"]], "+", 
    FractionBox[
     RowBox[{
      SubscriptBox["U", "11"], " ", 
      SubscriptBox["U", "22"], " ", 
      SubscriptBox["U", "33"]}], 
     SqrtBox["6"]]}], ",", 
   RowBox[{
    RowBox[{
     FractionBox["1", "2"], " ", 
     SubscriptBox["U", "13"], " ", 
     SubscriptBox["U", "22"], " ", 
     SubscriptBox["U", "31"]}], "-", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     SubscriptBox["U", "12"], " ", 
     SubscriptBox["U", "23"], " ", 
     SubscriptBox["U", "31"]}], "-", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     SubscriptBox["U", "12"], " ", 
     SubscriptBox["U", "21"], " ", 
     SubscriptBox["U", "33"]}], "+", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     SubscriptBox["U", "11"], " ", 
     SubscriptBox["U", "22"], " ", 
     SubscriptBox["U", "33"]}]}], ",", 
   RowBox[{
    RowBox[{
     FractionBox["1", "2"], " ", 
     SubscriptBox["U", "13"], " ", 
     SubscriptBox["U", "21"], " ", 
     SubscriptBox["U", "32"]}], "-", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     SubscriptBox["U", "11"], " ", 
     SubscriptBox["U", "23"], " ", 
     SubscriptBox["U", "32"]}], "+", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     SubscriptBox["U", "12"], " ", 
     SubscriptBox["U", "21"], " ", 
     SubscriptBox["U", "33"]}], "-", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     SubscriptBox["U", "11"], " ", 
     SubscriptBox["U", "22"], " ", 
     SubscriptBox["U", "33"]}]}], ",", 
   RowBox[{
    RowBox[{
     FractionBox["1", "2"], " ", 
     SubscriptBox["U", "13"], " ", 
     SubscriptBox["U", "22"], " ", 
     SubscriptBox["U", "31"]}], "+", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     SubscriptBox["U", "12"], " ", 
     SubscriptBox["U", "23"], " ", 
     SubscriptBox["U", "31"]}], "-", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     SubscriptBox["U", "12"], " ", 
     SubscriptBox["U", "21"], " ", 
     SubscriptBox["U", "33"]}], "-", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     SubscriptBox["U", "11"], " ", 
     SubscriptBox["U", "22"], " ", 
     SubscriptBox["U", "33"]}]}], ",", 
   RowBox[{
    RowBox[{
     FractionBox["1", "2"], " ", 
     SubscriptBox["U", "13"], " ", 
     SubscriptBox["U", "21"], " ", 
     SubscriptBox["U", "32"]}], "+", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     SubscriptBox["U", "11"], " ", 
     SubscriptBox["U", "23"], " ", 
     SubscriptBox["U", "32"]}], "-", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     SubscriptBox["U", "12"], " ", 
     SubscriptBox["U", "21"], " ", 
     SubscriptBox["U", "33"]}], "-", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     SubscriptBox["U", "11"], " ", 
     SubscriptBox["U", "22"], " ", 
     SubscriptBox["U", "33"]}]}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{
      SubscriptBox["U", "13"], " ", 
      SubscriptBox["U", "22"], " ", 
      SubscriptBox["U", "31"]}], 
     SqrtBox["6"]], "-", 
    FractionBox[
     RowBox[{
      SubscriptBox["U", "12"], " ", 
      SubscriptBox["U", "23"], " ", 
      SubscriptBox["U", "31"]}], 
     SqrtBox["6"]], "-", 
    FractionBox[
     RowBox[{
      SubscriptBox["U", "13"], " ", 
      SubscriptBox["U", "21"], " ", 
      SubscriptBox["U", "32"]}], 
     SqrtBox["6"]], "+", 
    FractionBox[
     RowBox[{
      SubscriptBox["U", "11"], " ", 
      SubscriptBox["U", "23"], " ", 
      SubscriptBox["U", "32"]}], 
     SqrtBox["6"]], "+", 
    FractionBox[
     RowBox[{
      SubscriptBox["U", "12"], " ", 
      SubscriptBox["U", "21"], " ", 
      SubscriptBox["U", "33"]}], 
     SqrtBox["6"]], "-", 
    FractionBox[
     RowBox[{
      SubscriptBox["U", "11"], " ", 
      SubscriptBox["U", "22"], " ", 
      SubscriptBox["U", "33"]}], 
     SqrtBox["6"]]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.702102548259004*^9, {3.702469573044404*^9, 3.7024695979897738`*^9}, 
   3.7024696897371397`*^9, 3.7024701989279013`*^9, 3.7024702627885036`*^9, {
   3.7024725022651377`*^9, 3.70247252213875*^9}, {3.702481039863409*^9, 
   3.702481054503281*^9}, 3.702482359609002*^9, {3.7024824435191593`*^9, 
   3.702482457143572*^9}, {3.702482801181093*^9, 3.702482811466669*^9}, 
   3.7025074516173267`*^9, {3.702509409231328*^9, 3.702509421779965*^9}, 
   3.702509583937497*^9, 3.702509622814526*^9, {3.702509721650625*^9, 
   3.702509749278335*^9}, {3.702509786915607*^9, 3.702509803143117*^9}, 
   3.702509833591734*^9, 3.702509866082869*^9, {3.702509904488162*^9, 
   3.70250994664415*^9}, 3.702511399329174*^9, {3.702511439707766*^9, 
   3.702511463756476*^9}, {3.7025130492287607`*^9, 3.70251307599174*^9}, 
   3.702513321763381*^9, 3.702516822488304*^9, {3.7025169360758047`*^9, 
   3.702516961183012*^9}, 3.702562535008276*^9, {3.702564591555934*^9, 
   3.702564603847391*^9}, 3.702571414877275*^9, 3.702571605875041*^9, 
   3.702598717029828*^9, 3.702598890465787*^9, 3.702598930162367*^9, 
   3.702599811284278*^9, {3.702600972966442*^9, 3.702600989751164*^9}, {
   3.702601022284992*^9, 3.7026010374465847`*^9}, 3.702602606792397*^9, {
   3.702637155621212*^9, 3.702637172933694*^9}, 3.70263748162076*^9, 
   3.702659774811325*^9, 3.702659870707052*^9, 3.7026832823961697`*^9, 
   3.7026845896973133`*^9, 3.70268474849905*^9, 3.7026956880219088`*^9, 
   3.702695739030746*^9, 3.702696308359304*^9, 3.70269651092421*^9, {
   3.70269687358562*^9, 3.7026968862643433`*^9}, 3.702697276253529*^9, 
   3.702697814473937*^9, {3.702697933376761*^9, 3.70269796062703*^9}, 
   3.702700593838005*^9, 3.702702488105503*^9, 3.7027029877563133`*^9, 
   3.702703836558065*^9, 3.7027054363204603`*^9, 3.702708887806411*^9, 
   3.7027220300947323`*^9, 3.702727716317322*^9, 3.7027277692616177`*^9, 
   3.702728630279418*^9, {3.702728856398497*^9, 3.702728889280198*^9}, 
   3.702729114129899*^9, 3.702733194625496*^9, 3.702733539414297*^9, 
   3.702733668113511*^9, 3.70273414806526*^9, 3.70273425411215*^9, 
   3.702735893253736*^9, 3.702743441062058*^9, 3.702746277671144*^9, 
   3.7027517290789757`*^9, 3.7027538929664593`*^9, 3.702785614602769*^9, 
   3.702820281987664*^9, 3.702820924154626*^9, 3.702820956800338*^9, 
   3.702821067245988*^9, 3.70282112895092*^9, 3.702821172696068*^9, 
   3.7028240076667337`*^9, 3.702824166405993*^9, 3.702899108547483*^9, {
   3.702908118479394*^9, 3.702908153842928*^9}, 3.702909139772642*^9, 
   3.70291310270119*^9, 3.702913140064906*^9, 3.70291997602357*^9, 
   3.7029821642469254`*^9, {3.702986572277936*^9, 3.702986590179833*^9}, 
   3.704734386605525*^9, 3.7047357277593822`*^9, 3.704735793484758*^9, {
   3.7047360033148203`*^9, 3.7047360313464813`*^9}, 3.704736732578783*^9, 
   3.704736923869029*^9, 3.70473711088288*^9, 3.70476171188295*^9, 
   3.704764365810925*^9, {3.705089800864253*^9, 3.705089815339319*^9}, 
   3.706055302204245*^9, 3.70880414297928*^9, 3.7100271835454063`*^9, 
   3.7101594320309753`*^9, 3.710163716360384*^9, 3.7101639597945957`*^9, 
   3.710179232819663*^9, 3.710774286636415*^9, 3.710774373419447*^9, 
   3.710774431177868*^9, 3.7107769460644407`*^9, 3.710864981848781*^9, 
   3.710865121794087*^9, 3.710865151994184*^9, 3.7108653280344067`*^9, 
   3.710865477995193*^9, 3.711312262933425*^9, 3.711313477781114*^9, 
   3.7113135412402573`*^9, 3.712086488572871*^9, 3.712086524900518*^9},
 ExpressionUUID -> "9b428691-9549-4fa0-b97a-cfdd3063ba87"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"rate", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Conjugate", "[", "vvector", "]"}], ".", "simpleratematrix", ".",
      "vvector"}], " ", "//", "Expand"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.673055718616199*^9, 3.673055747396493*^9}, 
   3.673056528777895*^9, {3.673503900302737*^9, 3.673503900436668*^9}, {
   3.673765631831245*^9, 3.673765632693555*^9}, {3.69635660718161*^9, 
   3.696356609210065*^9}, 3.6965663436119547`*^9, 3.70208942914213*^9, 
   3.702089482609939*^9, {3.702598731524047*^9, 3.702598755288136*^9}, {
   3.7025989024890547`*^9, 3.702598903227762*^9}, 3.7026966420884*^9},
 ExpressionUUID -> "1b4a1acd-ef45-46ce-b975-33dc0e663f07"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rateblockdiagonal", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Distribute", "[", 
         RowBox[{"Conjugate", "[", "#", "]"}], "]"}], "&"}], ",", 
       "vblockdiagonal", ",", "1"}], "]"}], ".", "blockdiagonalrates", ".", 
     "vblockdiagonal"}], " ", "//", "Expand"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.673055874897871*^9, 3.673055882524365*^9}, {
   3.673055940381731*^9, 3.6730559493579617`*^9}, {3.673056106269958*^9, 
   3.673056140911076*^9}, 3.673056409854731*^9, 3.673154983862949*^9, {
   3.683509812133548*^9, 3.6835098168816767`*^9}, 3.6963566131713743`*^9, 
   3.7020894338112183`*^9, {3.702089485605872*^9, 3.702089518452489*^9}, {
   3.7020895955774508`*^9, 3.702089598080078*^9}, {3.702598738801599*^9, 
   3.702598751908359*^9}, {3.7025989060021067`*^9, 3.7025989072502823`*^9}, {
   3.7026966449789553`*^9, 3.702696645422584*^9}},
 ExpressionUUID -> "760db617-2278-4d3f-bb43-82f240025ce3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rate", " ", "===", " ", "rateblockdiagonal"}]], "Input",
 CellChangeTimes->{{3.673055993192313*^9, 3.6730560012059317`*^9}, {
   3.6730565454999943`*^9, 3.67305655068393*^9}, 3.6731548760894814`*^9, {
   3.6735039215003433`*^9, 3.673503930618568*^9}},
 ExpressionUUID -> "b0710057-a8ca-49ab-80f8-03c746af1436"],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{{3.7024695731052723`*^9, 3.702469598044797*^9}, 
   3.702469689786594*^9, 3.702470198993948*^9, 3.7024702629102707`*^9, {
   3.702472502316689*^9, 3.7024725222025347`*^9}, {3.70248103993789*^9, 
   3.7024810545804777`*^9}, 3.702482359658296*^9, {3.702482443572591*^9, 
   3.702482457194292*^9}, {3.702482801226618*^9, 3.70248281152883*^9}, 
   3.7025074516578407`*^9, {3.702509409266419*^9, 3.702509421815796*^9}, 
   3.702509583975219*^9, 3.702509622852006*^9, {3.702509721689645*^9, 
   3.7025097493947573`*^9}, {3.702509786963731*^9, 3.702509803192638*^9}, 
   3.70250983364755*^9, 3.702509866141747*^9, {3.7025099045333*^9, 
   3.702509946702199*^9}, 3.702511399364723*^9, {3.7025114397422132`*^9, 
   3.70251146379263*^9}, {3.7025130492743473`*^9, 3.702513076161014*^9}, 
   3.702513321843114*^9, 3.7025168226725883`*^9, {3.702516936128976*^9, 
   3.702516961263446*^9}, 3.702562535219763*^9, {3.702564591641554*^9, 
   3.7025646038936777`*^9}, 3.702571414935647*^9, 3.702571605925271*^9, 
   3.702598717096208*^9, {3.702598890570249*^9, 3.702598930359096*^9}, 
   3.702599811367733*^9, {3.7026009731233377`*^9, 3.702600989864517*^9}, {
   3.702601022382697*^9, 3.702601037571994*^9}, 3.702602606863554*^9, {
   3.702637155690668*^9, 3.7026371729935923`*^9}, 3.702637481682336*^9, 
   3.702659774995311*^9, 3.702659870909536*^9, 3.702683282861154*^9, 
   3.70268458983258*^9, 3.7026847486452*^9, 3.702695688402348*^9, 
   3.702695739148443*^9, 3.702696308529767*^9, 3.7026965109837627`*^9, {
   3.702696873636907*^9, 3.702696886295171*^9}, 3.702697276284186*^9, 
   3.702697814508024*^9, {3.702697933428927*^9, 3.702697960659231*^9}, 
   3.702700593871213*^9, 3.702702488172415*^9, 3.7027029877926617`*^9, 
   3.702703836596036*^9, 3.7027054363662786`*^9, 3.702708887845229*^9, 
   3.702722030132444*^9, 3.702727716352951*^9, 3.702727769297394*^9, 
   3.702728630313191*^9, {3.702728856450592*^9, 3.70272888931455*^9}, 
   3.7027291141635933`*^9, 3.702733194668765*^9, 3.7027335394496326`*^9, 
   3.702733668146188*^9, 3.702734148101221*^9, 3.70273425424091*^9, 
   3.702735893297655*^9, 3.702743441101734*^9, 3.7027462778519287`*^9, 
   3.702751729107607*^9, 3.702753893001706*^9, 3.702785614652659*^9, 
   3.702820282343796*^9, 3.702820924207994*^9, 3.702820956860341*^9, 
   3.702821067297353*^9, 3.702821129003921*^9, 3.702821172748955*^9, 
   3.702824007933311*^9, 3.702824166448392*^9, 3.702899108847611*^9, {
   3.702908118754545*^9, 3.702908153894878*^9}, 3.702909139825037*^9, 
   3.7029131027562428`*^9, 3.702913140125732*^9, 3.702919976289657*^9, 
   3.702982164577964*^9, {3.7029865725289373`*^9, 3.7029865904498987`*^9}, 
   3.704734386865138*^9, 3.704735727813397*^9, 3.7047357935315027`*^9, {
   3.704736003384735*^9, 3.704736031407543*^9}, 3.7047367326515093`*^9, 
   3.704736923962439*^9, 3.704737110979525*^9, 3.704761712224764*^9, 
   3.704764366081058*^9, {3.705089801181427*^9, 3.705089815564747*^9}, 
   3.70605530250099*^9, 3.708804143301461*^9, 3.710027183599667*^9, 
   3.710159432103099*^9, 3.710163716544305*^9, 3.7101639598240633`*^9, 
   3.7101792328672237`*^9, 3.710774287144713*^9, 3.710774373561699*^9, 
   3.710774431440219*^9, 3.710776946472764*^9, 3.710864981976499*^9, 
   3.710865121840117*^9, 3.710865152034054*^9, 3.7108653280978823`*^9, 
   3.710865478037137*^9, 3.711312263232163*^9, 3.711313477855369*^9, 
   3.711313541282577*^9, 3.712086491328084*^9, 3.712086525321682*^9},
 ExpressionUUID -> "57600aea-4a7f-4520-9a3b-ebad4e33037c"]
}, Open  ]],

Cell["We can now express the rate in the form of immanants", "Text",
 CellChangeTimes->{{3.6963566328779163`*^9, 3.6963566415653687`*^9}, {
   3.696356678667386*^9, 3.6963566862072897`*^9}, 3.702483999055971*^9}],

Cell[TextData[{
 "We first write down part of the character table of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["S", "n"], TraditionalForm]]],
 ". Later I will change this to an algorithm that computes it in real time. "
}], "Text",
 CellChangeTimes->{{3.696356694839219*^9, 3.696356751899329*^9}, 
   3.696356832415414*^9, {3.6963569155968122`*^9, 3.6963569174172897`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"For", " ", 
    SubscriptBox["S", "2"]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"classsizes2", "=", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"characterTable2", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"characters2", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"characterTable2", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", "j", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "classsizes2", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"Length", "[", "classsizes2", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", 
         RowBox[{"classsizes2", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"charactersList", "[", "2", "]"}], "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"characters2", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "classsizes2", "]"}]}], "}"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ImmanantNames", "[", "2", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Imm", "[", "2", "]"}], ",", 
       RowBox[{"Imm", "[", 
        RowBox[{"1", ",", "1"}], "]"}]}], "}"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.696356690547925*^9, 3.6963566914636497`*^9}, {
   3.696356755748723*^9, 3.6963567706705313`*^9}, {3.696356813537656*^9, 
   3.696356883202628*^9}, {3.696357005453801*^9, 3.6963570090346823`*^9}, {
   3.696357043560018*^9, 3.6963570437871943`*^9}, {3.696560479330772*^9, 
   3.696560545729574*^9}, 3.702513070258059*^9},
 ExpressionUUID -> "30dc79ea-bdf1-4609-a4d0-61ba12214ec6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"For", " ", 
    SubscriptBox["S", "3"]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"classsizes3", "=", 
     RowBox[{"{", 
      RowBox[{"1", ",", "3", ",", "2"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"characterTable3", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "0", ",", 
         RowBox[{"-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"characters3", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"characterTable3", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", "j", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "classsizes3", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"Length", "[", "classsizes3", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", 
         RowBox[{"classsizes3", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"charactersList", "[", "3", "]"}], "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"characters3", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "classsizes3", "]"}]}], "}"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ImmanantNames", "[", "3", "]"}], "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Imm", "[", "3", "]"}], ",", 
      RowBox[{"Imm", "[", 
       RowBox[{"2", ",", "1"}], "]"}], ",", 
      RowBox[{"Imm", "[", 
       RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.696356778631386*^9, 3.6963567879780293`*^9}, {
   3.6963568207343683`*^9, 3.696356822593347*^9}, {3.696356886440593*^9, 
   3.696356908334959*^9}, {3.6963570119063663`*^9, 3.6963570131032867`*^9}, {
   3.696560484697514*^9, 3.696560499137229*^9}, 3.696560548765717*^9, {
   3.696563560331595*^9, 3.696563564742847*^9}, {3.696566467146896*^9, 
   3.696566471338098*^9}, {3.702599294874192*^9, 3.702599307893548*^9}, {
   3.702599439748068*^9, 3.7025994456943693`*^9}, {3.702701465744335*^9, 
   3.70270147812542*^9}},
 ExpressionUUID -> "03e18fde-9fe4-4249-89ad-cb4c1d65326d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Imm", "[", "3", "]"}], ",", 
   RowBox[{"Imm", "[", 
    RowBox[{"2", ",", "1"}], "]"}], ",", 
   RowBox[{"Imm", "[", 
    RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7025993205407476`*^9, 3.7025994460694113`*^9, 3.702599811403233*^9, {
   3.7026009731595697`*^9, 3.702600989906282*^9}, {3.702601022424419*^9, 
   3.702601037616666*^9}, 3.702602606904036*^9, {3.70263715581536*^9, 
   3.702637173020011*^9}, 3.702637481717553*^9, 3.7026597752123957`*^9, 
   3.702659870958358*^9, 3.702683283023222*^9, 3.702684589859907*^9, 
   3.7026847486758013`*^9, 3.702695688535738*^9, 3.702695739177603*^9, 
   3.702696308558392*^9, 3.702696511014822*^9, {3.702696873666915*^9, 
   3.702696886324432*^9}, 3.70269727631041*^9, 3.702697814537025*^9, {
   3.702697933457466*^9, 3.702697960688333*^9}, 3.702700593903561*^9, 
   3.702701479425228*^9, 3.702702488232492*^9, 3.702702987824275*^9, 
   3.702703836625436*^9, 3.702705436393257*^9, 3.702708887877816*^9, 
   3.7027220301660967`*^9, 3.702727716381719*^9, 3.702727769327433*^9, 
   3.702728630343912*^9, {3.7027288564857397`*^9, 3.702728889341847*^9}, 
   3.702729114193915*^9, 3.702733194704226*^9, 3.702733539483612*^9, 
   3.702733668171404*^9, 3.702734148130327*^9, 3.7027342543185797`*^9, 
   3.702735893331615*^9, 3.702743441134111*^9, 3.7027462779831467`*^9, 
   3.70275172913792*^9, 3.702753893051024*^9, 3.7027856146848516`*^9, 
   3.702820282598114*^9, 3.702820924234296*^9, 3.7028209568903418`*^9, 
   3.7028210673241863`*^9, 3.702821129033411*^9, 3.702821172779683*^9, 
   3.7028240082049103`*^9, 3.7028241664840803`*^9, 3.702899109003633*^9, {
   3.70290811888139*^9, 3.702908153922081*^9}, 3.702909139859056*^9, 
   3.702913102786008*^9, 3.7029131401553164`*^9, 3.702919976422286*^9, 
   3.7029821648816032`*^9, {3.702986572662346*^9, 3.702986590582883*^9}, 
   3.704734387091008*^9, 3.704735727840127*^9, 3.7047357935594788`*^9, {
   3.7047360034316473`*^9, 3.7047360314490347`*^9}, 3.7047367326803627`*^9, 
   3.704736924012123*^9, 3.7047371110317698`*^9, 3.704761712463752*^9, 
   3.7047643662093897`*^9, {3.7050898014102488`*^9, 3.705089815706484*^9}, 
   3.70605530273335*^9, 3.708804143570907*^9, 3.7100271837223873`*^9, 
   3.710159432228356*^9, 3.710163716770227*^9, 3.710163959853363*^9, 
   3.71017923298604*^9, 3.710774287449848*^9, 3.710774373691452*^9, 
   3.7107744315736732`*^9, 3.7107769465608387`*^9, 3.7108649821143*^9, 
   3.7108651218971977`*^9, 3.710865152062101*^9, 3.7108653281688557`*^9, 
   3.710865478074697*^9, 3.71131226345404*^9, 3.711313477883971*^9, 
   3.711313541315503*^9, 3.7120864916601667`*^9, 3.712086525454179*^9, {
   3.712088349840968*^9, 3.712088362871294*^9}},
 ExpressionUUID -> "24a39e7e-ede9-4d00-a5c0-a038e063a534"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"For", " ", 
    SubscriptBox["S", "4"]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"classsizes4", "=", 
     RowBox[{"{", 
      RowBox[{"1", ",", "6", ",", "8", ",", "6", ",", "3"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"characterTable4", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "1", ",", "0", ",", 
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "0", ",", 
         RowBox[{"-", "1"}], ",", "0", ",", "2"}], "}"}]}], "}"}]}], ";"}], 
   " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"last", " ", "entry", " ", "changed", " ", "from", " ", "0"}], 
     "\[Rule]", "2"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"characters4", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"characterTable4", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", "j", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"Length", "[", "classsizes4", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", 
         RowBox[{"classsizes4", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"charactersList", "[", "4", "]"}], "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"characters4", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "3"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ImmanantNames", "[", "4", "]"}], "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Imm", "[", "4", "]"}], ",", 
      RowBox[{"Imm", "[", 
       RowBox[{"3", ",", "1"}], "]"}], ",", 
      RowBox[{"Imm", "[", 
       RowBox[{"2", ",", "2"}], "]"}]}], "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.696356794893372*^9, 3.696356826862709*^9}, {
   3.696356924721615*^9, 3.696356962233029*^9}, {3.696357015428175*^9, 
   3.696357016745276*^9}, 3.696560454251945*^9, {3.6965604863996964`*^9, 
   3.696560508811603*^9}, 3.696560551342292*^9, {3.696563407480871*^9, 
   3.696563475821303*^9}, 3.6965636067496367`*^9, 3.696566476562497*^9, 
   3.702099466166366*^9, {3.702099900112689*^9, 3.702099912520612*^9}, {
   3.702101984531245*^9, 3.7021020009981403`*^9}},
 ExpressionUUID -> "48110d89-70d5-4331-9c90-637af01fc6ca"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Imm", "[", "4", "]"}], ",", 
   RowBox[{"Imm", "[", 
    RowBox[{"3", ",", "1"}], "]"}], ",", 
   RowBox[{"Imm", "[", 
    RowBox[{"2", ",", "2"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.702469573431343*^9, 3.7024695981062517`*^9}, 
   3.7024696898414516`*^9, 3.7024701990538063`*^9, 3.702470263026371*^9, {
   3.70247250236871*^9, 3.702472522260717*^9}, {3.702481040120446*^9, 
   3.7024810546702538`*^9}, 3.702482359707343*^9, {3.7024824436235733`*^9, 
   3.702482457252161*^9}, {3.702482801274932*^9, 3.702482811579352*^9}, 
   3.702507451811213*^9, {3.702509409316684*^9, 3.702509421866331*^9}, 
   3.7025095840383244`*^9, 3.702509622905478*^9, {3.702509721749074*^9, 
   3.702509749491136*^9}, {3.702509787017021*^9, 3.70250980325067*^9}, 
   3.702509833694931*^9, 3.7025098661923637`*^9, {3.70250990458575*^9, 
   3.702509946752054*^9}, 3.702511399416346*^9, {3.702511439790925*^9, 
   3.7025114638433933`*^9}, {3.702513049353671*^9, 3.702513076493505*^9}, 
   3.702513321986574*^9, 3.702516822725328*^9, {3.702516936184752*^9, 
   3.702516961322722*^9}, 3.702562535434312*^9, {3.702564591744172*^9, 
   3.7025646039424887`*^9}, 3.7025714150754337`*^9, 3.702571605976149*^9, 
   3.702598717195499*^9, 3.702598890632825*^9, 3.702598930471117*^9, 
   3.702599811433587*^9, {3.702600973185708*^9, 3.702600989933124*^9}, {
   3.702601022449147*^9, 3.702601037642497*^9}, 3.702602606932819*^9, {
   3.702637155837612*^9, 3.702637173041439*^9}, 3.7026374817500467`*^9, 
   3.7026597752616673`*^9, 3.702659870992676*^9, 3.702683283169942*^9, 
   3.702684589881032*^9, 3.70268474869951*^9, 3.702695688568945*^9, 
   3.702695739198756*^9, 3.702696308579771*^9, 3.7026965110335913`*^9, {
   3.702696873688191*^9, 3.7026968863443413`*^9}, 3.7026972763298283`*^9, 
   3.702697814558277*^9, {3.702697933478633*^9, 3.702697960708411*^9}, 
   3.702700593927168*^9, 3.702702488281559*^9, 3.70270298784608*^9, 
   3.702703836648986*^9, 3.7027054364147053`*^9, 3.702708887900251*^9, 
   3.702722030193019*^9, 3.702727716402233*^9, 3.7027277693533077`*^9, 
   3.702728630366959*^9, {3.70272885651842*^9, 3.702728889361669*^9}, 
   3.70272911421521*^9, 3.702733194732421*^9, 3.7027335395066853`*^9, 
   3.702733668192053*^9, 3.702734148151333*^9, 3.702734254384418*^9, 
   3.702735893368825*^9, 3.702743441159233*^9, 3.702746278121378*^9, 
   3.7027517291583652`*^9, 3.7027538930602703`*^9, 3.702785614705714*^9, 
   3.702820282702845*^9, 3.702820924256742*^9, 3.702820956910079*^9, 
   3.702821067342928*^9, 3.702821129052005*^9, 3.70282117280044*^9, 
   3.7028240082769938`*^9, 3.7028241665067663`*^9, 3.7028991090789757`*^9, {
   3.702908118956962*^9, 3.70290815394034*^9}, 3.7029091398810387`*^9, 
   3.702913102805595*^9, 3.702913140179019*^9, 3.702919976496084*^9, 
   3.7029821649688*^9, {3.7029865727353773`*^9, 3.702986590692729*^9}, 
   3.704734387334568*^9, 3.7047357278593903`*^9, 3.704735793578912*^9, {
   3.704736003470276*^9, 3.704736031485058*^9}, 3.7047367326997623`*^9, 
   3.704736924051*^9, 3.704737111092415*^9, 3.7047617125379744`*^9, 
   3.7047643662825613`*^9, {3.705089801487628*^9, 3.7050898157819223`*^9}, 
   3.706055302811002*^9, 3.708804143714592*^9, 3.7100271837438173`*^9, 
   3.710159432248496*^9, 3.71016371693227*^9, 3.710163959871744*^9, 
   3.710179233008082*^9, 3.71077428758189*^9, 3.710774373763568*^9, 
   3.710774431650227*^9, 3.71077694664744*^9, 3.710864982144794*^9, 
   3.7108651219203167`*^9, 3.71086515208459*^9, 3.710865328198263*^9, 
   3.710865478100978*^9, 3.711312263528429*^9, 3.711313477904531*^9, 
   3.7113135413364363`*^9, 3.712086491845758*^9, 3.712086525531723*^9},
 ExpressionUUID -> "eb0b755e-6f38-4d03-9f5b-1ec80cf2a2bd"]
}, Open  ]],

Cell["The characters we will use are", "Text",
 CellChangeTimes->{{3.6963569780997047`*^9, 3.6963569828180647`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"characters", " ", "=", " ", 
  RowBox[{"charactersList", "[", "nphotons", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ImmanantNameList", "=", 
  RowBox[{"ImmanantNames", "[", "nphotons", "]"}]}]}], "Input",
 CellChangeTimes->{{3.696357023575088*^9, 3.696357036713956*^9}, {
   3.696560425423113*^9, 3.696560429025312*^9}, 3.6965605621062737`*^9},
 ExpressionUUID -> "f411a493-4c80-4ddd-9da2-bfa401ed7def"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", 
     RowBox[{"-", "1"}], ",", 
     RowBox[{"-", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"-", "1"}], ",", 
     RowBox[{"-", "1"}], ",", 
     RowBox[{"-", "1"}], ",", "1", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.70246957350666*^9, 3.702469598125866*^9}, 
   3.702469689847972*^9, 3.702470199060418*^9, 3.702470263071858*^9, {
   3.702472502375183*^9, 3.702472522268121*^9}, {3.702481040161978*^9, 
   3.702481054678212*^9}, 3.702482359713894*^9, {3.702482443643218*^9, 
   3.702482457274021*^9}, {3.7024828012960567`*^9, 3.702482811601026*^9}, 
   3.702507451833776*^9, {3.7025094093239603`*^9, 3.702509421873364*^9}, 
   3.702509584060586*^9, 3.702509622911889*^9, {3.702509721770509*^9, 
   3.702509749532445*^9}, {3.702509787024456*^9, 3.7025098032726183`*^9}, 
   3.7025098337015743`*^9, 3.702509866198942*^9, {3.7025099045940447`*^9, 
   3.702509946759478*^9}, 3.7025113994240017`*^9, {3.7025114397988586`*^9, 
   3.702511463851725*^9}, {3.702513049389246*^9, 3.7025130765956173`*^9}, 
   3.702513321995468*^9, 3.702516822733946*^9, {3.702516936194252*^9, 
   3.702516961345142*^9}, 3.7025625355153723`*^9, {3.7025645917917128`*^9, 
   3.7025646039481287`*^9}, 3.702571415082892*^9, 3.702571605983074*^9, 
   3.7025987172034483`*^9, 3.70259889065689*^9, 3.702598930517106*^9, 
   3.702599328069216*^9, 3.702599453443843*^9, 3.702599811441573*^9, {
   3.702600973194243*^9, 3.702600989985774*^9}, {3.702601022459326*^9, 
   3.7026010376544847`*^9}, 3.7026026069427557`*^9, {3.7026371558605747`*^9, 
   3.702637173060828*^9}, 3.70263748175662*^9, 3.70265977531171*^9, 
   3.7026598710240507`*^9, 3.702683283220749*^9, 3.702684589887805*^9, 
   3.702684748720882*^9, 3.7026956885765753`*^9, 3.702695739205332*^9, 
   3.702696308585784*^9, 3.702696511039404*^9, {3.7026968737322283`*^9, 
   3.702696886350237*^9}, 3.7026972763356533`*^9, 3.70269781456498*^9, {
   3.702697933484941*^9, 3.7026979607153473`*^9}, 3.702700593948084*^9, 
   3.702701483113101*^9, 3.702702488333783*^9, 3.702702987855691*^9, 
   3.702703836672422*^9, 3.702705436436215*^9, 3.7027088879091263`*^9, 
   3.7027220302020683`*^9, 3.702727716409515*^9, 3.702727769359865*^9, 
   3.7027286303736877`*^9, {3.702728856554009*^9, 3.702728889368223*^9}, 
   3.70272911422253*^9, 3.702733194741808*^9, 3.702733539514882*^9, 
   3.702733668211561*^9, 3.702734148158787*^9, 3.702734254452466*^9, 
   3.702735893404624*^9, 3.702743441168928*^9, 3.702746278194063*^9, 
   3.702751729165781*^9, 3.702753893085347*^9, 3.7027856147121353`*^9, 
   3.702820282804529*^9, 3.702820924275375*^9, 3.7028209569174747`*^9, 
   3.7028210673483067`*^9, 3.702821129059359*^9, 3.702821172806501*^9, 
   3.702824008351431*^9, 3.702824166526342*^9, 3.702899109162224*^9, {
   3.702908119030533*^9, 3.702908153945854*^9}, 3.702909139902322*^9, 
   3.702913102811822*^9, 3.70291314020497*^9, 3.70291997656709*^9, 
   3.702982165169403*^9, {3.702986572809469*^9, 3.702986590766552*^9}, 
   3.704734387406107*^9, 3.704735727864932*^9, 3.70473579358517*^9, {
   3.7047360035086517`*^9, 3.704736031517619*^9}, 3.704736732707114*^9, 
   3.704736924084649*^9, 3.704737111152668*^9, 3.7047617126129303`*^9, 
   3.704764366356715*^9, {3.7050898015605583`*^9, 3.705089815856297*^9}, 
   3.706055302889278*^9, 3.708804143808283*^9, 3.710027183751377*^9, 
   3.710159432255965*^9, 3.710163717309195*^9, 3.7101639598898563`*^9, 
   3.710179233016136*^9, 3.710774287667789*^9, 3.71077437383744*^9, 
   3.7107744317238693`*^9, 3.71077694673116*^9, 3.710864982153674*^9, 
   3.710865121925707*^9, 3.7108651521200542`*^9, 3.7108653282594852`*^9, 
   3.7108654781104403`*^9, 3.711312263601386*^9, 3.711313477911004*^9, 
   3.711313541342515*^9, 3.712086491924892*^9, 3.71208652560542*^9},
 ExpressionUUID -> "c81c3833-d11f-4a8b-a83a-c3fffef255fe"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Imm", "[", "3", "]"}], ",", 
   RowBox[{"Imm", "[", 
    RowBox[{"2", ",", "1"}], "]"}], ",", 
   RowBox[{"Imm", "[", 
    RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.70246957350666*^9, 3.702469598125866*^9}, 
   3.702469689847972*^9, 3.702470199060418*^9, 3.702470263071858*^9, {
   3.702472502375183*^9, 3.702472522268121*^9}, {3.702481040161978*^9, 
   3.702481054678212*^9}, 3.702482359713894*^9, {3.702482443643218*^9, 
   3.702482457274021*^9}, {3.7024828012960567`*^9, 3.702482811601026*^9}, 
   3.702507451833776*^9, {3.7025094093239603`*^9, 3.702509421873364*^9}, 
   3.702509584060586*^9, 3.702509622911889*^9, {3.702509721770509*^9, 
   3.702509749532445*^9}, {3.702509787024456*^9, 3.7025098032726183`*^9}, 
   3.7025098337015743`*^9, 3.702509866198942*^9, {3.7025099045940447`*^9, 
   3.702509946759478*^9}, 3.7025113994240017`*^9, {3.7025114397988586`*^9, 
   3.702511463851725*^9}, {3.702513049389246*^9, 3.7025130765956173`*^9}, 
   3.702513321995468*^9, 3.702516822733946*^9, {3.702516936194252*^9, 
   3.702516961345142*^9}, 3.7025625355153723`*^9, {3.7025645917917128`*^9, 
   3.7025646039481287`*^9}, 3.702571415082892*^9, 3.702571605983074*^9, 
   3.7025987172034483`*^9, 3.70259889065689*^9, 3.702598930517106*^9, 
   3.702599328069216*^9, 3.702599453443843*^9, 3.702599811441573*^9, {
   3.702600973194243*^9, 3.702600989985774*^9}, {3.702601022459326*^9, 
   3.7026010376544847`*^9}, 3.7026026069427557`*^9, {3.7026371558605747`*^9, 
   3.702637173060828*^9}, 3.70263748175662*^9, 3.70265977531171*^9, 
   3.7026598710240507`*^9, 3.702683283220749*^9, 3.702684589887805*^9, 
   3.702684748720882*^9, 3.7026956885765753`*^9, 3.702695739205332*^9, 
   3.702696308585784*^9, 3.702696511039404*^9, {3.7026968737322283`*^9, 
   3.702696886350237*^9}, 3.7026972763356533`*^9, 3.70269781456498*^9, {
   3.702697933484941*^9, 3.7026979607153473`*^9}, 3.702700593948084*^9, 
   3.702701483113101*^9, 3.702702488333783*^9, 3.702702987855691*^9, 
   3.702703836672422*^9, 3.702705436436215*^9, 3.7027088879091263`*^9, 
   3.7027220302020683`*^9, 3.702727716409515*^9, 3.702727769359865*^9, 
   3.7027286303736877`*^9, {3.702728856554009*^9, 3.702728889368223*^9}, 
   3.70272911422253*^9, 3.702733194741808*^9, 3.702733539514882*^9, 
   3.702733668211561*^9, 3.702734148158787*^9, 3.702734254452466*^9, 
   3.702735893404624*^9, 3.702743441168928*^9, 3.702746278194063*^9, 
   3.702751729165781*^9, 3.702753893085347*^9, 3.7027856147121353`*^9, 
   3.702820282804529*^9, 3.702820924275375*^9, 3.7028209569174747`*^9, 
   3.7028210673483067`*^9, 3.702821129059359*^9, 3.702821172806501*^9, 
   3.702824008351431*^9, 3.702824166526342*^9, 3.702899109162224*^9, {
   3.702908119030533*^9, 3.702908153945854*^9}, 3.702909139902322*^9, 
   3.702913102811822*^9, 3.70291314020497*^9, 3.70291997656709*^9, 
   3.702982165169403*^9, {3.702986572809469*^9, 3.702986590766552*^9}, 
   3.704734387406107*^9, 3.704735727864932*^9, 3.70473579358517*^9, {
   3.7047360035086517`*^9, 3.704736031517619*^9}, 3.704736732707114*^9, 
   3.704736924084649*^9, 3.704737111152668*^9, 3.7047617126129303`*^9, 
   3.704764366356715*^9, {3.7050898015605583`*^9, 3.705089815856297*^9}, 
   3.706055302889278*^9, 3.708804143808283*^9, 3.710027183751377*^9, 
   3.710159432255965*^9, 3.710163717309195*^9, 3.7101639598898563`*^9, 
   3.710179233016136*^9, 3.710774287667789*^9, 3.71077437383744*^9, 
   3.7107744317238693`*^9, 3.71077694673116*^9, 3.710864982153674*^9, 
   3.710865121925707*^9, 3.7108651521200542`*^9, 3.7108653282594852`*^9, 
   3.7108654781104403`*^9, 3.711312263601386*^9, 3.711313477911004*^9, 
   3.711313541342515*^9, 3.712086491924892*^9, 3.712086525606999*^9},
 ExpressionUUID -> "c81c3833-d11f-4a8b-a83a-c3fffef255fe"]
}, Open  ]],

Cell["The scattering matrix is", "Text",
 CellChangeTimes->{{3.696560646049252*^9, 3.696560653055833*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ScM", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Subscript", "[", 
     RowBox[{"U", ",", 
      RowBox[{"ToExpression", "[", 
       RowBox[{
        RowBox[{"ToString", "[", 
         RowBox[{"inputword", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "]"}], "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"outputword", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "]"}]}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "nphotons"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "nphotons"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{3.704736887704945*^9, 3.704737104338397*^9},
 ExpressionUUID -> "b69d99d1-388c-4625-9322-3b0ba985c094"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["U", "11"], ",", 
     SubscriptBox["U", "12"], ",", 
     SubscriptBox["U", "13"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["U", "21"], ",", 
     SubscriptBox["U", "22"], ",", 
     SubscriptBox["U", "23"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["U", "31"], ",", 
     SubscriptBox["U", "32"], ",", 
     SubscriptBox["U", "33"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7021025255036983`*^9, {3.702469573560174*^9, 3.702469598148991*^9}, 
   3.702469689871325*^9, 3.702470199087467*^9, 3.702470263124529*^9, {
   3.702472502397482*^9, 3.7024725222922077`*^9}, {3.702481040206386*^9, 
   3.702481054720562*^9}, 3.702482359736003*^9, {3.702482443664476*^9, 
   3.702482457296117*^9}, {3.702482801316992*^9, 3.702482811623136*^9}, 
   3.7025074518576593`*^9, {3.702509409343603*^9, 3.702509421895688*^9}, 
   3.702509584086128*^9, 3.7025096229366083`*^9, {3.7025097217938347`*^9, 
   3.702509749580389*^9}, {3.702509787047621*^9, 3.7025098032947063`*^9}, 
   3.702509833723239*^9, 3.702509866222825*^9, {3.702509904618021*^9, 
   3.702509946781075*^9}, 3.702511399447633*^9, {3.702511439821327*^9, 
   3.702511463876033*^9}, {3.7025130494312773`*^9, 3.7025130766060143`*^9}, 
   3.702513322060644*^9, 3.702516822759572*^9, {3.702516936220909*^9, 
   3.702516961366679*^9}, 3.7025625356001463`*^9, {3.702564591838043*^9, 
   3.702564603968893*^9}, 3.702571415104857*^9, 3.702571606005558*^9, 
   3.7025987172468*^9, 3.7025988906838617`*^9, 3.702598930563942*^9, 
   3.702599811468026*^9, {3.702600973227408*^9, 3.702600990017808*^9}, {
   3.702601022493949*^9, 3.702601037689423*^9}, 3.702602606970274*^9, {
   3.7026371558822517`*^9, 3.702637173081859*^9}, 3.7026374817867413`*^9, 
   3.702659775360311*^9, 3.702659871077437*^9, 3.70268328334147*^9, 
   3.702684589910598*^9, 3.702684748745475*^9, 3.702695688642271*^9, 
   3.702695739226633*^9, 3.7026963086084003`*^9, 3.7026965110627937`*^9, {
   3.702696873755682*^9, 3.70269688637289*^9}, 3.70269727635818*^9, 
   3.702697530790914*^9, 3.702697669636136*^9, 3.702697814586956*^9, {
   3.702697933507193*^9, 3.702697960738061*^9}, 3.702699602156242*^9, 
   3.702700593973733*^9, 3.702701490864348*^9, 3.702702488424429*^9, 
   3.702702987880556*^9, 3.702703836697212*^9, 3.7027054364607563`*^9, 
   3.702708887934997*^9, 3.702722030231187*^9, 3.702727716435616*^9, 
   3.7027277693833942`*^9, 3.7027286303978357`*^9, {3.702728856582999*^9, 
   3.702728889388701*^9}, 3.7027291142459517`*^9, 3.702733194771696*^9, 
   3.7027335395397987`*^9, 3.7027336682337112`*^9, 3.702734148183797*^9, 
   3.702734254523034*^9, 3.7027358934301863`*^9, 3.702743441195568*^9, 
   3.702746278267559*^9, 3.702751729184889*^9, 3.702753893112096*^9, 
   3.702785614736136*^9, {3.70280750366343*^9, 3.7028075170796003`*^9}, 
   3.70282028290875*^9, 3.702820924296665*^9, 3.702820956941174*^9, 
   3.702821067367831*^9, 3.702821129080373*^9, 3.702821172827013*^9, 
   3.702824008442265*^9, 3.702824166550152*^9, 3.70289910924179*^9, {
   3.702908119104392*^9, 3.702908153967095*^9}, 3.702909139924326*^9, 
   3.70291310283394*^9, 3.702913140228929*^9, 3.7029199766390133`*^9, 
   3.70298216534638*^9, {3.70298657288476*^9, 3.702986590839356*^9}, 
   3.704734387480484*^9, 3.7047357278855658`*^9, 3.704735793607132*^9, {
   3.7047360035556707`*^9, 3.704736031555066*^9}, 3.7047367327276163`*^9, 
   3.704736889222896*^9, 3.704736924155712*^9, {3.704737104857223*^9, 
   3.7047371111905117`*^9}, 3.704761712692348*^9, 3.704764366429976*^9, {
   3.705089801665221*^9, 3.705089815929932*^9}, 3.706055302966545*^9, 
   3.708804143905509*^9, 3.7100271837729607`*^9, 3.710159432282796*^9, 
   3.710163717452462*^9, 3.7101639599095182`*^9, 3.710179233037301*^9, 
   3.71077428775735*^9, 3.710774373911417*^9, 3.710774431797936*^9, 
   3.7107769468153753`*^9, 3.7108649821826067`*^9, 3.710865121946878*^9, 
   3.710865152142379*^9, 3.710865328286919*^9, 3.710865478140182*^9, 
   3.711312263677449*^9, 3.711313477935091*^9, 3.711313541364211*^9, 
   3.712086492005175*^9, 3.712086525681192*^9},
 ExpressionUUID -> "31854dd3-6b2f-4e69-8cde-4b1b42da9b6c"]
}, Open  ]],

Cell["Now we calculate all the immanants", "Text",
 CellChangeTimes->{{3.696560658929514*^9, 3.696560665475808*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"CalculateImmanant", "[", 
   RowBox[{
   "nphotons_", ",", "groupElements_", ",", "chars_", ",", 
    "scatteringMatrix_", ",", 
    RowBox[{"Cyc_:", 
     RowBox[{"Cycles", "[", 
      RowBox[{"{", 
       RowBox[{"{", "}"}], "}"}], "]"}]}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ScMs", " ", "=", 
       RowBox[{"scatteringMatrix", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"Permute", "[", 
           RowBox[{
            RowBox[{"Range", "[", "nphotons", "]"}], ",", "Cyc"}], "]"}], ",", 
          RowBox[{"Range", "[", "nphotons", "]"}]}], "]"}], "]"}]}], ",", 
      "ScMc"}], "}"}], ",", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"chars", "[", 
        RowBox[{"[", "i", "]"}], "]"}], 
       RowBox[{"Product", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ScMc", "=", 
           RowBox[{"ScMs", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"Range", "[", "nphotons", "]"}], ",", 
              RowBox[{"Permute", "[", 
               RowBox[{
                RowBox[{"Range", "[", "nphotons", "]"}], ",", 
                RowBox[{"groupElements", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"ScMc", "[", 
           RowBox[{"[", 
            RowBox[{"j", ",", "j"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "nphotons"}], "}"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "[", "groupElements", "]"}]}], "}"}]}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.702683778849682*^9, 3.7026838339774446`*^9}, {
   3.702683947992323*^9, 3.702684018174716*^9}, {3.702684095247572*^9, 
   3.7026841771775627`*^9}, 3.702684721398746*^9, {3.7026995608047028`*^9, 
   3.702699587456568*^9}, {3.702700152921221*^9, 3.702700220979978*^9}, {
   3.702704970731341*^9, 3.702704971777636*^9}, 3.7027050330533457`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ImmanantList", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"CalculateImmanant", "[", 
      RowBox[{"nphotons", ",", "elementlist", ",", 
       RowBox[{"characters", "[", 
        RowBox[{"[", "irrep", "]"}], "]"}], ",", "ScM"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"irrep", ",", 
       RowBox[{"Length", "[", "characters", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7026841917933807`*^9, 3.7026842558062077`*^9}, {
  3.7026996211341763`*^9, 3.702699624310766*^9}, {3.7027002627101393`*^9, 
  3.702700274132279*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"ImmanantList", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"characters", "[", 
            RowBox[{"[", "irrep", "]"}], "]"}], "[", 
           RowBox[{"[", "i", "]"}], "]"}], 
          RowBox[{"Product", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"ScM", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"PermutationReplace", "[", 
               RowBox[{"j", ",", 
                RowBox[{"elementlist", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "nphotons"}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "elementlist", "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"irrep", ",", 
         RowBox[{"Length", "[", "characters", "]"}]}], "}"}]}], "]"}]}], 
    ";"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"MatrixForm", "[", "ImmanantList", "]"}]}]], "Input",
 CellChangeTimes->{{3.696572683852449*^9, 3.696572699036129*^9}, {
  3.7027002654525547`*^9, 3.702700270626781*^9}},
 ExpressionUUID -> "cd77cc9d-b1ac-4912-88af-667714a4dd0d"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
        RowBox[{
         SubscriptBox["U", "13"], " ", 
         SubscriptBox["U", "22"], " ", 
         SubscriptBox["U", "31"]}], "+", 
        RowBox[{
         SubscriptBox["U", "12"], " ", 
         SubscriptBox["U", "23"], " ", 
         SubscriptBox["U", "31"]}], "+", 
        RowBox[{
         SubscriptBox["U", "13"], " ", 
         SubscriptBox["U", "21"], " ", 
         SubscriptBox["U", "32"]}], "+", 
        RowBox[{
         SubscriptBox["U", "11"], " ", 
         SubscriptBox["U", "23"], " ", 
         SubscriptBox["U", "32"]}], "+", 
        RowBox[{
         SubscriptBox["U", "12"], " ", 
         SubscriptBox["U", "21"], " ", 
         SubscriptBox["U", "33"]}], "+", 
        RowBox[{
         SubscriptBox["U", "11"], " ", 
         SubscriptBox["U", "22"], " ", 
         SubscriptBox["U", "33"]}]}]},
      {
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SubscriptBox["U", "12"]}], " ", 
         SubscriptBox["U", "23"], " ", 
         SubscriptBox["U", "31"]}], "-", 
        RowBox[{
         SubscriptBox["U", "13"], " ", 
         SubscriptBox["U", "21"], " ", 
         SubscriptBox["U", "32"]}], "+", 
        RowBox[{"2", " ", 
         SubscriptBox["U", "11"], " ", 
         SubscriptBox["U", "22"], " ", 
         SubscriptBox["U", "33"]}]}]},
      {
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SubscriptBox["U", "13"]}], " ", 
         SubscriptBox["U", "22"], " ", 
         SubscriptBox["U", "31"]}], "+", 
        RowBox[{
         SubscriptBox["U", "12"], " ", 
         SubscriptBox["U", "23"], " ", 
         SubscriptBox["U", "31"]}], "+", 
        RowBox[{
         SubscriptBox["U", "13"], " ", 
         SubscriptBox["U", "21"], " ", 
         SubscriptBox["U", "32"]}], "-", 
        RowBox[{
         SubscriptBox["U", "11"], " ", 
         SubscriptBox["U", "23"], " ", 
         SubscriptBox["U", "32"]}], "-", 
        RowBox[{
         SubscriptBox["U", "12"], " ", 
         SubscriptBox["U", "21"], " ", 
         SubscriptBox["U", "33"]}], "+", 
        RowBox[{
         SubscriptBox["U", "11"], " ", 
         SubscriptBox["U", "22"], " ", 
         SubscriptBox["U", "33"]}]}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.70210252866599*^9, {3.702469573606523*^9, 3.702469598174209*^9}, 
   3.702469689896864*^9, 3.70247019914922*^9, 3.702470263177185*^9, {
   3.702472502426856*^9, 3.702472522318516*^9}, {3.70248104025429*^9, 
   3.70248105476606*^9}, 3.7024823597599287`*^9, {3.7024824436883287`*^9, 
   3.702482457320046*^9}, {3.702482801340312*^9, 3.702482811646394*^9}, 
   3.7025074518807783`*^9, {3.702509409365211*^9, 3.702509421920805*^9}, 
   3.70250958411305*^9, 3.7025096229630413`*^9, {3.7025097218178577`*^9, 
   3.70250974962869*^9}, {3.702509787072858*^9, 3.702509803319311*^9}, 
   3.7025098337466087`*^9, 3.702509866247826*^9, {3.702509904642543*^9, 
   3.7025099468058662`*^9}, 3.7025113994721127`*^9, {3.702511439843444*^9, 
   3.7025114638989687`*^9}, {3.702513049467602*^9, 3.702513076714541*^9}, 
   3.702513322130457*^9, 3.70251682278734*^9, {3.7025169362477427`*^9, 
   3.702516961393189*^9}, 3.702562535682716*^9, {3.702564591889758*^9, 
   3.702564603994445*^9}, 3.702571415130542*^9, 3.702571606031299*^9, 
   3.702598717292844*^9, 3.7025988907110653`*^9, 3.702598930608341*^9, 
   3.702599333892889*^9, 3.702599457479052*^9, 3.702599811495677*^9, {
   3.7026009732581778`*^9, 3.702600990046905*^9}, {3.702601022530196*^9, 
   3.7026010377622232`*^9}, 3.70260260700671*^9, {3.702637155905315*^9, 
   3.702637173103869*^9}, 3.702637481820539*^9, 3.7026597754182253`*^9, 
   3.702659871126357*^9, 3.702683283430738*^9, 3.702684589967259*^9, 
   3.702684748803454*^9, 3.7026956888275337`*^9, 3.702695739266213*^9, 
   3.702696308660018*^9, 3.702696511113398*^9, {3.702696873810977*^9, 
   3.7026968864227533`*^9}, 3.7026972764198723`*^9, 3.7026978146378317`*^9, {
   3.702697933556038*^9, 3.7026979607858877`*^9}, 3.702700278519672*^9, 
   3.7027005940148478`*^9, 3.70270248848668*^9, 3.702702987913805*^9, 
   3.7027038367312317`*^9, 3.702705436513558*^9, 3.702708887972909*^9, 
   3.702722030276641*^9, 3.702727716468129*^9, 3.702727769419984*^9, 
   3.702728630432251*^9, {3.7027288566298656`*^9, 3.70272888941962*^9}, 
   3.702729114282497*^9, 3.702733194934273*^9, 3.702733539575141*^9, 
   3.702733668295185*^9, 3.7027341482174377`*^9, 3.702734254603488*^9, 
   3.7027358934765863`*^9, 3.7027434412339907`*^9, 3.702746278449828*^9, 
   3.7027517292157183`*^9, 3.7027538931514387`*^9, 3.702785614773738*^9, 
   3.702807740515649*^9, 3.702820283204534*^9, 3.702820924337406*^9, 
   3.702820956974681*^9, 3.702821067398563*^9, 3.702821129117402*^9, 
   3.7028211728617907`*^9, 3.702824008640438*^9, 3.702824166584571*^9, 
   3.702899109456727*^9, {3.702908119292468*^9, 3.7029081540003653`*^9}, 
   3.702909140008835*^9, 3.702913102866897*^9, 3.7029131402660217`*^9, 
   3.702919976822856*^9, 3.702982165778029*^9, {3.702986573075472*^9, 
   3.702986591026782*^9}, 3.7047343876688232`*^9, 3.7047357279285917`*^9, 
   3.704735793640128*^9, {3.7047360036508303`*^9, 3.704736031633979*^9}, 
   3.704736732764698*^9, 3.7047369242115097`*^9, 3.7047371112397947`*^9, 
   3.7047617128995533`*^9, 3.704764366622343*^9, {3.70508980186106*^9, 
   3.705089816105599*^9}, 3.706055303165921*^9, 3.70880414413167*^9, 
   3.710027183810252*^9, 3.7101594323213577`*^9, 3.710163717804047*^9, 
   3.71016395994104*^9, 3.710179233074732*^9, 3.710774288124269*^9, 
   3.710774374100006*^9, 3.710774431987303*^9, 3.710776947012528*^9, 
   3.710864982232028*^9, 3.710865121979355*^9, 3.710865152176935*^9, 
   3.710865328334062*^9, 3.710865478210486*^9, 3.711312263870645*^9, 
   3.711313477974477*^9, 3.711313541398382*^9, 3.71208649228913*^9, 
   3.712086525867305*^9},
 ExpressionUUID -> "88b0aa74-ad7d-4ce9-a344-2d76e8903e83"]
}, Open  ]],

Cell["\<\
Now we figure out how to write the interferometer vector in terms of the \
immanants\
\>", "Text",
 CellChangeTimes->{{3.696560691917637*^9, 3.696560707009755*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"monomialList", "[", 
    RowBox[{"poly_", ",", "vars_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Times", "@@", 
      RowBox[{"(", 
       RowBox[{"vars", "^", "#"}], ")"}]}], "&"}], "/@", 
    RowBox[{
     RowBox[{"CoefficientRules", "[", 
      RowBox[{"poly", ",", "vars"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{3.6965727081338387`*^9},
 ExpressionUUID -> "46e90dba-6f29-494a-a364-8e0b4bd7124e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"monList", " ", "=", " ", 
  RowBox[{"monomialList", "[", 
   RowBox[{
    RowBox[{"ImmanantList", "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", 
    RowBox[{"Variables", "[", 
     RowBox[{"ImmanantList", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.696572717105715*^9, 3.696572721435886*^9}},
 ExpressionUUID -> "4da3e050-15c8-43c1-95ec-47e299d93f98"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SubscriptBox["U", "13"], " ", 
    SubscriptBox["U", "22"], " ", 
    SubscriptBox["U", "31"]}], ",", 
   RowBox[{
    SubscriptBox["U", "13"], " ", 
    SubscriptBox["U", "21"], " ", 
    SubscriptBox["U", "32"]}], ",", 
   RowBox[{
    SubscriptBox["U", "11"], " ", 
    SubscriptBox["U", "22"], " ", 
    SubscriptBox["U", "33"]}], ",", 
   RowBox[{
    SubscriptBox["U", "12"], " ", 
    SubscriptBox["U", "23"], " ", 
    SubscriptBox["U", "31"]}], ",", 
   RowBox[{
    SubscriptBox["U", "12"], " ", 
    SubscriptBox["U", "21"], " ", 
    SubscriptBox["U", "33"]}], ",", 
   RowBox[{
    SubscriptBox["U", "11"], " ", 
    SubscriptBox["U", "23"], " ", 
    SubscriptBox["U", "32"]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7024695736469517`*^9, 3.702469598209696*^9}, 
   3.7024696899272633`*^9, 3.70247019918149*^9, 3.702470263264222*^9, {
   3.702472502453932*^9, 3.702472522383155*^9}, {3.702481040362249*^9, 
   3.7024810548162117`*^9}, 3.702482359787347*^9, {3.70248244371052*^9, 
   3.702482457346408*^9}, {3.7024828013669443`*^9, 3.7024828116742764`*^9}, 
   3.702507451917893*^9, {3.702509409392292*^9, 3.702509421948741*^9}, 
   3.70250958414637*^9, 3.702509622993919*^9, {3.702509721867682*^9, 
   3.702509749679776*^9}, {3.70250978710113*^9, 3.702509803346019*^9}, 
   3.702509833771097*^9, 3.702509866277288*^9, {3.702509904669529*^9, 
   3.702509946834807*^9}, 3.702511399498434*^9, {3.702511439867676*^9, 
   3.702511463924506*^9}, {3.702513049518121*^9, 3.7025130768202753`*^9}, 
   3.702513322207575*^9, 3.702516822842688*^9, {3.702516936277145*^9, 
   3.7025169615001793`*^9}, 3.702562535723707*^9, {3.702564591941956*^9, 
   3.7025646040194283`*^9}, 3.702571415168523*^9, 3.702571606056492*^9, 
   3.7025987173836937`*^9, 3.702598890742663*^9, 3.702598930660886*^9, 
   3.702599811527594*^9, {3.7026009732941523`*^9, 3.7026009900810633`*^9}, {
   3.702601022568626*^9, 3.70260103779771*^9}, 3.70260260703787*^9, {
   3.702637155943285*^9, 3.70263717313022*^9}, 3.702637481859312*^9, 
   3.702659775511527*^9, 3.702659871166533*^9, 3.702683283692457*^9, 
   3.7026845900002327`*^9, 3.702684748834087*^9, 3.702695688887876*^9, 
   3.702695739291092*^9, 3.702696308683353*^9, 3.702696511144964*^9, {
   3.7026968738375397`*^9, 3.702696886446253*^9}, 3.702697276485214*^9, 
   3.7026978146637173`*^9, {3.7026979335815163`*^9, 3.702697960811349*^9}, 
   3.702700594046734*^9, 3.7027024885437393`*^9, 3.7027029879422626`*^9, 
   3.702703836763262*^9, 3.702705436542103*^9, 3.702708888004566*^9, 
   3.70272203030707*^9, 3.7027277164957848`*^9, 3.702727769448257*^9, 
   3.702728630460349*^9, {3.7027288567107553`*^9, 3.7027288894462833`*^9}, 
   3.702729114310666*^9, 3.702733195011047*^9, 3.702733539603859*^9, 
   3.702733668322217*^9, 3.702734148243599*^9, 3.702734254679371*^9, 
   3.702735893511406*^9, 3.702743441266449*^9, 3.702746278573236*^9, 
   3.702751729241263*^9, 3.702753893181961*^9, 3.702785614803144*^9, 
   3.702807733035729*^9, 3.702820283378852*^9, 3.702820924368663*^9, 
   3.7028209570009317`*^9, 3.702821067422336*^9, 3.7028211291427717`*^9, 
   3.702821172888876*^9, 3.702824008765061*^9, 3.7028241666333733`*^9, 
   3.702899109588756*^9, {3.702908119423311*^9, 3.702908154032116*^9}, 
   3.702909140039577*^9, 3.702913102898658*^9, 3.7029131402984467`*^9, 
   3.7029199769522943`*^9, 3.702982165907791*^9, {3.7029865734712543`*^9, 
   3.702986591153409*^9}, 3.7047343877968807`*^9, 3.704735727952649*^9, 
   3.704735793665694*^9, {3.7047360037033854`*^9, 3.704736031684857*^9}, 
   3.704736732794656*^9, 3.704736924258088*^9, 3.704737111281798*^9, 
   3.704761713120817*^9, 3.704764366750094*^9, {3.705089802071022*^9, 
   3.705089816257098*^9}, 3.706055303299275*^9, 3.708804144442389*^9, 
   3.710027183841131*^9, 3.7101594323708487`*^9, 3.710163717954979*^9, 
   3.7101639599628067`*^9, 3.7101792331144447`*^9, 3.7107742882669086`*^9, 
   3.710774374226506*^9, 3.7107744321125927`*^9, 3.710776947217757*^9, 
   3.71086498233617*^9, 3.7108651220044117`*^9, 3.710865152205653*^9, 
   3.710865328392396*^9, 3.7108654782438993`*^9, 3.711312264001362*^9, 
   3.7113134780028257`*^9, 3.7113135414252462`*^9, 3.7120864924489183`*^9, 
   3.712086526088887*^9},
 ExpressionUUID -> "5de50c49-39a5-4478-b568-675198b6f38b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"irrepDims", "=", 
  RowBox[{"Map", "[", 
   RowBox[{"Length", ",", 
    RowBox[{"Map", "[", 
     RowBox[{"Combinatorica`Tableaux", ",", "youngdiagrams"}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.696572480538945*^9, 3.6965725159850273`*^9}, {
  3.6965726258600397`*^9, 3.696572638949171*^9}},
 ExpressionUUID -> "53f963a6-a60e-4737-a125-075ff8b3cb23"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "2", ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{
  3.7021025342473373`*^9, {3.702469573676421*^9, 3.702469598230955*^9}, 
   3.702469689952113*^9, 3.702470199209836*^9, 3.702470263307701*^9, {
   3.7024725024783993`*^9, 3.7024725224070787`*^9}, {3.702481040406065*^9, 
   3.7024810548582*^9}, 3.702482359810047*^9, {3.702482443729267*^9, 
   3.702482457364822*^9}, {3.7024828013896923`*^9, 3.702482811696183*^9}, 
   3.7025074519427023`*^9, {3.702509409412942*^9, 3.702509421971794*^9}, 
   3.702509584172759*^9, 3.7025096230168133`*^9, {3.702509721886551*^9, 
   3.702509749724962*^9}, {3.7025097871246758`*^9, 3.702509803367877*^9}, 
   3.702509833867795*^9, 3.702509866299788*^9, {3.702509904691218*^9, 
   3.70250994685968*^9}, 3.7025113995226717`*^9, {3.702511439888521*^9, 
   3.702511463945045*^9}, {3.702513049558812*^9, 3.702513076925982*^9}, 
   3.7025133222856417`*^9, 3.702516822868346*^9, 3.702516897887908*^9, {
   3.7025169363017263`*^9, 3.702516961524254*^9}, 3.702562535844243*^9, {
   3.702564591994836*^9, 3.702564604043441*^9}, 3.702571415191681*^9, 
   3.7025716060772247`*^9, 3.702598717431542*^9, 3.7025988907679167`*^9, 
   3.7025989307082443`*^9, 3.70259947126579*^9, 3.702599811554577*^9, {
   3.702600973321323*^9, 3.702600990111751*^9}, {3.702601022638105*^9, 
   3.70260103782959*^9}, 3.702602607065364*^9, {3.702637155964389*^9, 
   3.702637173151204*^9}, 3.7026374818896313`*^9, 3.702659775561358*^9, 
   3.702659871208947*^9, 3.702683283781415*^9, 3.702684590022644*^9, 
   3.702684748856689*^9, 3.7026956889270973`*^9, 3.702695739330591*^9, 
   3.7026963087027273`*^9, 3.702696511165729*^9, {3.702696873859109*^9, 
   3.702696886466014*^9}, 3.702697276505932*^9, 3.702697814684361*^9, {
   3.70269793360305*^9, 3.702697960832108*^9}, 3.70270059406914*^9, 
   3.70270248859378*^9, 3.7027029879643993`*^9, 3.702703836783885*^9, 
   3.702705436565371*^9, 3.702708888027301*^9, 3.702722030330525*^9, 
   3.702727716517077*^9, 3.7027277694708757`*^9, 3.7027286304828377`*^9, {
   3.702728856743637*^9, 3.702728889465042*^9}, 3.702729114332012*^9, 
   3.7027331950402412`*^9, 3.702733539625971*^9, 3.702733668343508*^9, 
   3.702734148265623*^9, 3.702734254746455*^9, 3.702735893533288*^9, 
   3.7027434412927437`*^9, 3.702746278640749*^9, 3.702751729263586*^9, 
   3.70275389320928*^9, 3.702785614826449*^9, 3.7028202834803467`*^9, 
   3.702820924390442*^9, 3.702820957024619*^9, 3.702821067443391*^9, 
   3.702821129164609*^9, 3.702821172911623*^9, 3.702824008835305*^9, 
   3.7028241666555758`*^9, 3.7028991096602907`*^9, {3.702908119498817*^9, 
   3.7029081540569773`*^9}, 3.7029091400629597`*^9, 3.702913102922331*^9, 
   3.702913140322098*^9, 3.702919977022496*^9, 3.7029821659880333`*^9, {
   3.702986573861979*^9, 3.702986591224051*^9}, 3.704734387872059*^9, 
   3.7047357279721403`*^9, 3.704735793688538*^9, {3.70473600374317*^9, 
   3.7047360317231483`*^9}, 3.704736732817443*^9, 3.7047369242922077`*^9, 
   3.7047371113191833`*^9, 3.704761713200461*^9, 3.704764366823689*^9, {
   3.705089802145836*^9, 3.705089816332242*^9}, 3.7060553034361467`*^9, 
   3.708804144468481*^9, 3.7100271838669643`*^9, 3.7101594323922863`*^9, 
   3.710163718115281*^9, 3.710163959981236*^9, 3.710179233138042*^9, 
   3.7107742883521852`*^9, 3.7107743743714123`*^9, 3.710774432184361*^9, 
   3.710776947296014*^9, 3.710864982370139*^9, 3.710865122026795*^9, 
   3.710865152231448*^9, 3.710865328418931*^9, 3.710865478271241*^9, 
   3.711312264076221*^9, 3.711313478028246*^9, 3.711313541449132*^9, 
   3.7120864925353394`*^9, 3.712086526164947*^9},
 ExpressionUUID -> "8824ee74-28d8-49b4-ae25-7fcdd61f88d5"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"irrepMultiplicity", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.702097699648929*^9, 3.702097711639776*^9}},
 ExpressionUUID -> "5a18cbaf-becf-4e41-ad6c-118a5ed935c2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"DeleteDuplicates", "[", 
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"ScMs", " ", "=", 
           RowBox[{"ScM", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"Permute", "[", 
               RowBox[{
                RowBox[{"Range", "[", "nphotons", "]"}], ",", 
                RowBox[{"elementlist", "[", 
                 RowBox[{"[", "k", "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"Range", "[", "nphotons", "]"}]}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"elementlist", "[", 
             RowBox[{"[", "k", "]"}], "]"}], ",", 
            RowBox[{"CalculateImmanant", "[", 
             RowBox[{"nphotons", ",", "elementlist", ",", 
              RowBox[{"characters", "[", 
               RowBox[{"[", "immInd", "]"}], "]"}], ",", "ScMs"}], "]"}]}], 
           "}"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", 
           RowBox[{"Length", "[", "elementlist", "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "=!=", "0"}], "&"}]}], "]"}], ",", 
     RowBox[{
      RowBox[{"NumericQ", "[", 
       RowBox[{"Simplify", "[", 
        RowBox[{
         RowBox[{"#1", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "/", 
         RowBox[{"#2", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "&"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"immInd", ",", 
     RowBox[{"Length", "[", "irrepDims", "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7025990270782213`*^9, 3.702599048381713*^9}, {
  3.702599592475772*^9, 3.702599600836609*^9}, {3.70270030063932*^9, 
  3.702700372267334*^9}},
 ExpressionUUID -> "823de8d6-85eb-4c28-8768-52b724fe50ba"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Cycles", "[", 
       RowBox[{"{", "}"}], "]"}], ",", 
      RowBox[{
       RowBox[{
        SubscriptBox["U", "13"], " ", 
        SubscriptBox["U", "22"], " ", 
        SubscriptBox["U", "31"]}], "+", 
       RowBox[{
        SubscriptBox["U", "12"], " ", 
        SubscriptBox["U", "23"], " ", 
        SubscriptBox["U", "31"]}], "+", 
       RowBox[{
        SubscriptBox["U", "13"], " ", 
        SubscriptBox["U", "21"], " ", 
        SubscriptBox["U", "32"]}], "+", 
       RowBox[{
        SubscriptBox["U", "11"], " ", 
        SubscriptBox["U", "23"], " ", 
        SubscriptBox["U", "32"]}], "+", 
       RowBox[{
        SubscriptBox["U", "12"], " ", 
        SubscriptBox["U", "21"], " ", 
        SubscriptBox["U", "33"]}], "+", 
       RowBox[{
        SubscriptBox["U", "11"], " ", 
        SubscriptBox["U", "22"], " ", 
        SubscriptBox["U", "33"]}]}]}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cycles", "[", 
        RowBox[{"{", "}"}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SubscriptBox["U", "12"]}], " ", 
         SubscriptBox["U", "23"], " ", 
         SubscriptBox["U", "31"]}], "-", 
        RowBox[{
         SubscriptBox["U", "13"], " ", 
         SubscriptBox["U", "21"], " ", 
         SubscriptBox["U", "32"]}], "+", 
        RowBox[{"2", " ", 
         SubscriptBox["U", "11"], " ", 
         SubscriptBox["U", "22"], " ", 
         SubscriptBox["U", "33"]}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cycles", "[", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}], "}"}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SubscriptBox["U", "13"]}], " ", 
         SubscriptBox["U", "22"], " ", 
         SubscriptBox["U", "31"]}], "-", 
        RowBox[{
         SubscriptBox["U", "11"], " ", 
         SubscriptBox["U", "23"], " ", 
         SubscriptBox["U", "32"]}], "+", 
        RowBox[{"2", " ", 
         SubscriptBox["U", "12"], " ", 
         SubscriptBox["U", "21"], " ", 
         SubscriptBox["U", "33"]}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cycles", "[", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"1", ",", "3"}], "}"}], "}"}], "]"}], ",", 
       RowBox[{
        RowBox[{"2", " ", 
         SubscriptBox["U", "13"], " ", 
         SubscriptBox["U", "22"], " ", 
         SubscriptBox["U", "31"]}], "-", 
        RowBox[{
         SubscriptBox["U", "11"], " ", 
         SubscriptBox["U", "23"], " ", 
         SubscriptBox["U", "32"]}], "-", 
        RowBox[{
         SubscriptBox["U", "12"], " ", 
         SubscriptBox["U", "21"], " ", 
         SubscriptBox["U", "33"]}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cycles", "[", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"2", ",", "3"}], "}"}], "}"}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SubscriptBox["U", "13"]}], " ", 
         SubscriptBox["U", "22"], " ", 
         SubscriptBox["U", "31"]}], "+", 
        RowBox[{"2", " ", 
         SubscriptBox["U", "11"], " ", 
         SubscriptBox["U", "23"], " ", 
         SubscriptBox["U", "32"]}], "-", 
        RowBox[{
         SubscriptBox["U", "12"], " ", 
         SubscriptBox["U", "21"], " ", 
         SubscriptBox["U", "33"]}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cycles", "[", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "3"}], "}"}], "}"}], "]"}], ",", 
       RowBox[{
        RowBox[{"2", " ", 
         SubscriptBox["U", "12"], " ", 
         SubscriptBox["U", "23"], " ", 
         SubscriptBox["U", "31"]}], "-", 
        RowBox[{
         SubscriptBox["U", "13"], " ", 
         SubscriptBox["U", "21"], " ", 
         SubscriptBox["U", "32"]}], "-", 
        RowBox[{
         SubscriptBox["U", "11"], " ", 
         SubscriptBox["U", "22"], " ", 
         SubscriptBox["U", "33"]}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cycles", "[", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"1", ",", "3", ",", "2"}], "}"}], "}"}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SubscriptBox["U", "12"]}], " ", 
         SubscriptBox["U", "23"], " ", 
         SubscriptBox["U", "31"]}], "+", 
        RowBox[{"2", " ", 
         SubscriptBox["U", "13"], " ", 
         SubscriptBox["U", "21"], " ", 
         SubscriptBox["U", "32"]}], "-", 
        RowBox[{
         SubscriptBox["U", "11"], " ", 
         SubscriptBox["U", "22"], " ", 
         SubscriptBox["U", "33"]}]}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Cycles", "[", 
       RowBox[{"{", "}"}], "]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         SubscriptBox["U", "13"]}], " ", 
        SubscriptBox["U", "22"], " ", 
        SubscriptBox["U", "31"]}], "+", 
       RowBox[{
        SubscriptBox["U", "12"], " ", 
        SubscriptBox["U", "23"], " ", 
        SubscriptBox["U", "31"]}], "+", 
       RowBox[{
        SubscriptBox["U", "13"], " ", 
        SubscriptBox["U", "21"], " ", 
        SubscriptBox["U", "32"]}], "-", 
       RowBox[{
        SubscriptBox["U", "11"], " ", 
        SubscriptBox["U", "23"], " ", 
        SubscriptBox["U", "32"]}], "-", 
       RowBox[{
        SubscriptBox["U", "12"], " ", 
        SubscriptBox["U", "21"], " ", 
        SubscriptBox["U", "33"]}], "+", 
       RowBox[{
        SubscriptBox["U", "11"], " ", 
        SubscriptBox["U", "22"], " ", 
        SubscriptBox["U", "33"]}]}]}], "}"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.702599048890242*^9, 3.702599479096141*^9, 3.702599602886113*^9, 
   3.702599811594243*^9, {3.7026009734435883`*^9, 3.702600990223967*^9}, {
   3.702601022752862*^9, 3.7026010379420347`*^9}, 3.702602607124571*^9, {
   3.7026371559974623`*^9, 3.702637173180792*^9}, 3.70263748192848*^9, 
   3.7026597757306013`*^9, 3.70265987130416*^9, 3.702683284056898*^9, 
   3.702684590117235*^9, 3.702684748949772*^9, 3.702695689264385*^9, 
   3.702695739429317*^9, 3.702696308807262*^9, 3.7026965111985073`*^9, {
   3.702696873959189*^9, 3.702696886497271*^9}, 3.7026972765370817`*^9, 
   3.702697734513693*^9, 3.7026978147151203`*^9, {3.702697933639554*^9, 
   3.7026979609015913`*^9}, 3.7027003762011013`*^9, 3.702700594099791*^9, 
   3.702701511171014*^9, 3.702702488653912*^9, 3.702702987996305*^9, 
   3.702703836813923*^9, 3.7027054365999413`*^9, 3.7027088880612497`*^9, 
   3.702722030364725*^9, 3.7027277165482407`*^9, 3.702727769505396*^9, 
   3.702728630509655*^9, {3.70272885678999*^9, 3.702728889494039*^9}, 
   3.70272911436401*^9, 3.7027331950789824`*^9, 3.7027335396585817`*^9, 
   3.702733668402326*^9, 3.70273414830023*^9, 3.702734254848427*^9, 
   3.7027358935649853`*^9, 3.702743441327241*^9, 3.702746278766869*^9, 
   3.7027517292919397`*^9, 3.70275389324572*^9, 3.7027856149257927`*^9, 
   3.702820283738377*^9, 3.702820924514894*^9, 3.702820957123125*^9, 
   3.702821067537426*^9, 3.702821129259268*^9, 3.702821173010234*^9, 
   3.7028240090277567`*^9, 3.7028241667657948`*^9, 3.702899109960122*^9, {
   3.702908119701878*^9, 3.702908154166608*^9}, 3.702909140164072*^9, {
   3.7029130734563026`*^9, 3.702913103017168*^9}, 3.7029131404282017`*^9, 
   3.702919977214673*^9, 3.702982166199203*^9, {3.702986574085971*^9, 
   3.7029865914974527`*^9}, 3.704734388071989*^9, 3.704735728063889*^9, 
   3.704735793781056*^9, {3.70473600386414*^9, 3.7047360318670387`*^9}, 
   3.704736732920534*^9, 3.704736924410182*^9, 3.704737111432293*^9, 
   3.70476171341794*^9, 3.7047643671091127`*^9, {3.705089802587599*^9, 
   3.705089816630146*^9}, 3.70605530365641*^9, 3.708804144684207*^9, 
   3.7100271840032377`*^9, 3.7101594324231157`*^9, 3.7101637183768806`*^9, 
   3.710163960008374*^9, 3.710179233236249*^9, 3.7107742886538677`*^9, 
   3.710774374574745*^9, 3.710774432468079*^9, 3.710776947569521*^9, 
   3.7108649824169493`*^9, 3.7108651221198673`*^9, 3.71086515234894*^9, 
   3.710865328565775*^9, 3.710865478379511*^9, 3.711312264353889*^9, 
   3.7113134781308393`*^9, 3.711313541546438*^9, {3.7120865094034567`*^9, 
   3.712086526444787*^9}},
 Background->RGBColor[0.9, 1, 1],
 ExpressionUUID -> "4807465e-6919-4ca0-9fee-715332873d0b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"vimmanants", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", 
       RowBox[{"Length", "[", "vblockdiagonal", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FullImmNames", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"previousend", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"indexedMonList", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"monList", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
      RowBox[{"a", "[", "i", "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "monList", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"immInd", "=", "1"}], ",", 
   RowBox[{"immInd", "\[LessEqual]", 
    RowBox[{"Length", "[", "irrepDims", "]"}]}], ",", 
   RowBox[{"immInd", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"start", "=", 
     RowBox[{"previousend", "+", "1"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"end", "=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"irrepDims", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "immInd"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"previousend", "=", "end"}], ";", "\[IndentingNewLine]", 
    RowBox[{"immPermutations", "=", 
     RowBox[{"DeleteDuplicates", "[", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"ScMs", " ", "=", 
             RowBox[{"ScM", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"Permute", "[", 
                 RowBox[{
                  RowBox[{"Range", "[", "nphotons", "]"}], ",", 
                  RowBox[{"elementlist", "[", 
                   RowBox[{"[", "k", "]"}], "]"}]}], "]"}], ",", 
                RowBox[{"Range", "[", "nphotons", "]"}]}], "]"}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"elementlist", "[", 
               RowBox[{"[", "k", "]"}], "]"}], ",", 
              RowBox[{"CalculateImmanant", "[", 
               RowBox[{"nphotons", ",", "elementlist", ",", 
                RowBox[{"characters", "[", 
                 RowBox[{"[", "immInd", "]"}], "]"}], ",", "ScMs"}], "]"}]}], 
             "}"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", 
             RowBox[{"Length", "[", "elementlist", "]"}]}], "}"}]}], "]"}], 
         ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "=!=", "0"}], "&"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{"NumericQ", "[", 
         RowBox[{"Simplify", "[", 
          RowBox[{
           RowBox[{"#1", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "/", 
           RowBox[{"#2", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "&"}]}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Print", "[", "immPermutations", "]"}], ";"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "immPermutations", "]"}], "\[Equal]", "0"}], 
      ",", 
      RowBox[{"Continue", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"W", "=", 
     RowBox[{"Transpose", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Coefficient", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Transpose", "[", "immPermutations", "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "/.", "indexedMonList"}], ",", 
          RowBox[{"a", "[", "i", "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "monList", "]"}]}], "}"}]}], "]"}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"V", "=", 
     RowBox[{"Transpose", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Coefficient", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Expand", "[", 
            RowBox[{"vblockdiagonal", "[", 
             RowBox[{"[", 
              RowBox[{"start", ";;", "end"}], "]"}], "]"}], "]"}], "/.", 
           "indexedMonList"}], ",", 
          RowBox[{"a", "[", "i", "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "monList", "]"}]}], "}"}]}], "]"}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"X", "=", 
     RowBox[{
      RowBox[{"V", ".", 
       RowBox[{"PseudoInverse", "[", "W", "]"}]}], " ", "//", 
      "FullSimplify"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"ImmNames", "=", 
     RowBox[{"Outer", "[", 
      RowBox[{
       RowBox[{"ImmanantNameList", "[", 
        RowBox[{"[", "immInd", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"Transpose", "[", "immPermutations", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"FullImmNames", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"FullImmNames", ",", "ImmNames"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"vimmanants", "[", 
      RowBox[{"[", 
       RowBox[{"start", ";;", "end"}], "]"}], "]"}], "=", 
     RowBox[{"X", ".", "ImmNames"}]}], ";"}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"vimmanants", " "}]}], "Input",
 CellChangeTimes->{{3.69657451455643*^9, 3.696574758229512*^9}, {
   3.696574819043564*^9, 3.6965748442090273`*^9}, {3.70209785063113*^9, 
   3.7020978529404993`*^9}, 3.7021001342350903`*^9, {3.702100164281538*^9, 
   3.702100263688777*^9}, {3.702100315223975*^9, 3.702100557464065*^9}, {
   3.702100593205151*^9, 3.702100707016325*^9}, {3.7021009261714354`*^9, 
   3.7021009370637913`*^9}, {3.702100985625704*^9, 3.7021010075688133`*^9}, 
   3.702101051141081*^9, {3.702101102743196*^9, 3.702101153826097*^9}, {
   3.702101223930401*^9, 3.702101281964261*^9}, {3.7021013260345383`*^9, 
   3.702101343033052*^9}, {3.702101584812252*^9, 3.702101629066619*^9}, {
   3.7021016707542343`*^9, 3.7021017038195267`*^9}, {3.7021017560010157`*^9, 
   3.702101843836026*^9}, {3.7021019434283953`*^9, 3.702101961288335*^9}, {
   3.702102099929513*^9, 3.702102126824431*^9}, {3.7021022108953543`*^9, 
   3.7021022173455133`*^9}, {3.7024696118410473`*^9, 3.702469638262862*^9}, {
   3.702513271288937*^9, 3.7025132739886713`*^9}, {3.702599611185337*^9, 
   3.702599616410652*^9}, {3.702697456718696*^9, 3.702697462387684*^9}, {
   3.702697759528157*^9, 3.7026977914059258`*^9}, {3.702700395486019*^9, 
   3.7027004176341753`*^9}, {3.70270060731347*^9, 3.7027006084959393`*^9}, {
   3.7027015365060253`*^9, 3.7027015389413137`*^9}, 3.702734207561974*^9, {
   3.702824069146576*^9, 3.702824071467801*^9}, {3.702824119155278*^9, 
   3.702824150547896*^9}, {3.70473632644388*^9, 3.704736400226698*^9}, {
   3.704736605072877*^9, 3.704736608610643*^9}, {3.710031836937419*^9, 
   3.710031849993269*^9}},
 ExpressionUUID -> "00e37d83-8df8-4370-bb68-1f7ce793e217"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"Imm", "[", "3", "]"}], "[", 
     RowBox[{"Cycles", "[", 
      RowBox[{"{", "}"}], "]"}], "]"}], 
    SqrtBox["6"]], ",", 
   RowBox[{
    RowBox[{
     FractionBox["1", "6"], " ", 
     RowBox[{
      RowBox[{"Imm", "[", 
       RowBox[{"2", ",", "1"}], "]"}], "[", 
      RowBox[{"Cycles", "[", 
       RowBox[{"{", "}"}], "]"}], "]"}]}], "-", 
    RowBox[{
     FractionBox["1", "6"], " ", 
     RowBox[{
      RowBox[{"Imm", "[", 
       RowBox[{"2", ",", "1"}], "]"}], "[", 
      RowBox[{"Cycles", "[", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}], "}"}], "]"}], "]"}]}], "+", 
    RowBox[{
     FractionBox["1", "6"], " ", 
     RowBox[{
      RowBox[{"Imm", "[", 
       RowBox[{"2", ",", "1"}], "]"}], "[", 
      RowBox[{"Cycles", "[", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"1", ",", "3"}], "}"}], "}"}], "]"}], "]"}]}], "-", 
    RowBox[{
     FractionBox["1", "6"], " ", 
     RowBox[{
      RowBox[{"Imm", "[", 
       RowBox[{"2", ",", "1"}], "]"}], "[", 
      RowBox[{"Cycles", "[", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3"}], "}"}], "}"}], "]"}], "]"}]}]}], 
   ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "6"]}], " ", 
     RowBox[{
      RowBox[{"Imm", "[", 
       RowBox[{"2", ",", "1"}], "]"}], "[", 
      RowBox[{"Cycles", "[", 
       RowBox[{"{", "}"}], "]"}], "]"}]}], "+", 
    RowBox[{
     FractionBox["1", "6"], " ", 
     RowBox[{
      RowBox[{"Imm", "[", 
       RowBox[{"2", ",", "1"}], "]"}], "[", 
      RowBox[{"Cycles", "[", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}], "}"}], "]"}], "]"}]}], "-", 
    RowBox[{
     FractionBox["1", "6"], " ", 
     RowBox[{
      RowBox[{"Imm", "[", 
       RowBox[{"2", ",", "1"}], "]"}], "[", 
      RowBox[{"Cycles", "[", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"2", ",", "3"}], "}"}], "}"}], "]"}], "]"}]}], "+", 
    RowBox[{
     FractionBox["1", "6"], " ", 
     RowBox[{
      RowBox[{"Imm", "[", 
       RowBox[{"2", ",", "1"}], "]"}], "[", 
      RowBox[{"Cycles", "[", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"1", ",", "3", ",", "2"}], "}"}], "}"}], "]"}], "]"}]}]}], 
   ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.702469620213305*^9, 3.702469690111709*^9, 3.702470199369883*^9, 
   3.7024702635212*^9, {3.702472502637438*^9, 3.702472522555933*^9}, {
   3.7024810406248827`*^9, 3.7024810550358963`*^9}, 3.7024823599482193`*^9, {
   3.702482443858686*^9, 3.702482457505911*^9}, {3.7024828015221653`*^9, 
   3.7024828118199987`*^9}, 3.702507452336228*^9, {3.7025094095894136`*^9, 
   3.702509422144205*^9}, 3.702509584368134*^9, 3.702509623195375*^9, {
   3.702509722061316*^9, 3.702509749931596*^9}, {3.7025097872542067`*^9, 
   3.702509803496346*^9}, 3.7025098341234913`*^9, 3.7025098664293737`*^9, {
   3.702509904827201*^9, 3.7025099469932413`*^9}, 3.702511399560492*^9, {
   3.702511439927433*^9, 3.702511463984136*^9}, {3.702513049688911*^9, 
   3.702513077187722*^9}, 3.702513322364647*^9, 3.702516860760598*^9, {
   3.702516936453177*^9, 3.702516961659232*^9}, 3.7025625362305317`*^9, {
   3.7025645921652803`*^9, 3.702564604161964*^9}, 3.702571415371625*^9, 
   3.702571606269236*^9, 3.702598717558968*^9, 3.702598890844105*^9, 
   3.702598930990426*^9, 3.70259948772005*^9, 3.702599617572946*^9, 
   3.702599811642664*^9, {3.7026009735278263`*^9, 3.7026009903165913`*^9}, {
   3.702601022835567*^9, 3.702601038030017*^9}, 3.702602607185472*^9, {
   3.702637156041293*^9, 3.7026371732170362`*^9}, 3.7026374819658127`*^9, 
   3.702659775878715*^9, 3.702659871406039*^9, 3.702683284325307*^9, 
   3.702684590266654*^9, 3.702684749080132*^9, 3.702695689518532*^9, 
   3.702695739536364*^9, 3.702696308915716*^9, 3.7026965112430267`*^9, {
   3.7026968740717583`*^9, 3.702696886530855*^9}, 3.7026972765670357`*^9, {
   3.70269745460544*^9, 3.702697463037537*^9}, {3.702697775885028*^9, 
   3.7026978147466087`*^9}, {3.702697933669732*^9, 3.7026979609359083`*^9}, 
   3.7027004335546827`*^9, {3.702700594130772*^9, 3.7027006096210213`*^9}, {
   3.7027015312814207`*^9, 3.702701541066266*^9}, 3.702702488714005*^9, 
   3.702702988027087*^9, 3.702703836843364*^9, 3.702705436635816*^9, 
   3.7027088880937223`*^9, 3.702722030405223*^9, 3.702727716580647*^9, 
   3.702727769541526*^9, 3.7027286305380087`*^9, {3.7027288568265247`*^9, 
   3.70272888952404*^9}, 3.702729114392333*^9, 3.702733195121739*^9, 
   3.702733539691601*^9, 3.7027336684317904`*^9, 3.702734148330165*^9, 
   3.702734208108444*^9, 3.7027342549269943`*^9, 3.702735893599931*^9, 
   3.702743441363739*^9, 3.702746278844545*^9, 3.702751729322072*^9, 
   3.7027538932833652`*^9, 3.702785615033164*^9, 3.702820283985818*^9, 
   3.702820924659128*^9, 3.702820957233779*^9, 3.702821067654008*^9, 
   3.702821129366108*^9, 3.702821173113909*^9, 3.702824009444315*^9, 
   3.702824072121833*^9, {3.7028241393063707`*^9, 3.702824166868608*^9}, 
   3.7028991101772013`*^9, {3.702908119929233*^9, 3.702908154274343*^9}, 
   3.7029091402726994`*^9, 3.702913103127481*^9, 3.702913140560412*^9, 
   3.702919977436234*^9, 3.702982166417099*^9, {3.702986574312798*^9, 
   3.7029865917190437`*^9}, 3.704734388232782*^9, 3.704735728177154*^9, 
   3.704735793881796*^9, {3.7047360039888144`*^9, 3.7047360319909277`*^9}, {
   3.704736374968199*^9, 3.704736400890172*^9}, 3.704736609394081*^9, 
   3.70473673303255*^9, 3.7047369245387087`*^9, 3.704736987242959*^9, 
   3.704737111558132*^9, 3.704761713643035*^9, 3.7047643673793297`*^9, {
   3.705089802845652*^9, 3.705089816854952*^9}, 3.706055303884554*^9, 
   3.708804144979392*^9, 3.710027184136634*^9, 3.710159432447668*^9, 
   3.7101637186313343`*^9, 3.710163960049914*^9, 3.710179233361367*^9, 
   3.7107742888403673`*^9, 3.710774374743203*^9, 3.710774432697008*^9, 
   3.7107769478332157`*^9, 3.7108649824825583`*^9, 3.710865122239348*^9, 
   3.710865152458912*^9, 3.71086532871502*^9, 3.710865478496868*^9, 
   3.711312264576468*^9, 3.711313478243424*^9, 3.711313541647225*^9, 
   3.712086526608664*^9},
 ExpressionUUID -> "83af319d-617d-4aa9-8097-391475605c2a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"vimmanants", " ", "*", 
    RowBox[{"Sqrt", "[", "2", "]"}]}], "//", "Expand"}], " ", "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.7100318555711937`*^9, 3.710031873789336*^9}, {
  3.710159448821432*^9, 3.7101594504623337`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       FractionBox[
        RowBox[{
         RowBox[{"Imm", "[", "3", "]"}], "[", 
         RowBox[{"Cycles", "[", 
          RowBox[{"{", "}"}], "]"}], "]"}], 
        SqrtBox["3"]]},
      {
       RowBox[{
        FractionBox[
         RowBox[{
          RowBox[{"Imm", "[", 
           RowBox[{"2", ",", "1"}], "]"}], "[", 
          RowBox[{"Cycles", "[", 
           RowBox[{"{", "}"}], "]"}], "]"}], 
         RowBox[{"3", " ", 
          SqrtBox["2"]}]], "-", 
        FractionBox[
         RowBox[{
          RowBox[{"Imm", "[", 
           RowBox[{"2", ",", "1"}], "]"}], "[", 
          RowBox[{"Cycles", "[", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2"}], "}"}], "}"}], "]"}], "]"}], 
         RowBox[{"3", " ", 
          SqrtBox["2"]}]], "+", 
        FractionBox[
         RowBox[{
          RowBox[{"Imm", "[", 
           RowBox[{"2", ",", "1"}], "]"}], "[", 
          RowBox[{"Cycles", "[", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"1", ",", "3"}], "}"}], "}"}], "]"}], "]"}], 
         RowBox[{"3", " ", 
          SqrtBox["2"]}]], "-", 
        FractionBox[
         RowBox[{
          RowBox[{"Imm", "[", 
           RowBox[{"2", ",", "1"}], "]"}], "[", 
          RowBox[{"Cycles", "[", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2", ",", "3"}], "}"}], "}"}], "]"}], "]"}], 
         RowBox[{"3", " ", 
          SqrtBox["2"]}]]}]},
      {
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{
           RowBox[{"Imm", "[", 
            RowBox[{"2", ",", "1"}], "]"}], "[", 
           RowBox[{"Cycles", "[", 
            RowBox[{"{", "}"}], "]"}], "]"}], 
          RowBox[{"3", " ", 
           SqrtBox["2"]}]]}], "+", 
        FractionBox[
         RowBox[{
          RowBox[{"Imm", "[", 
           RowBox[{"2", ",", "1"}], "]"}], "[", 
          RowBox[{"Cycles", "[", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2"}], "}"}], "}"}], "]"}], "]"}], 
         RowBox[{"3", " ", 
          SqrtBox["2"]}]], "-", 
        FractionBox[
         RowBox[{
          RowBox[{"Imm", "[", 
           RowBox[{"2", ",", "1"}], "]"}], "[", 
          RowBox[{"Cycles", "[", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"2", ",", "3"}], "}"}], "}"}], "]"}], "]"}], 
         RowBox[{"3", " ", 
          SqrtBox["2"]}]], "+", 
        FractionBox[
         RowBox[{
          RowBox[{"Imm", "[", 
           RowBox[{"2", ",", "1"}], "]"}], "[", 
          RowBox[{"Cycles", "[", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"1", ",", "3", ",", "2"}], "}"}], "}"}], "]"}], "]"}], 
         RowBox[{"3", " ", 
          SqrtBox["2"]}]]}]},
      {"0"},
      {"0"},
      {"0"}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.710031861770369*^9, 3.7100318740823727`*^9}, {
   3.710159432467578*^9, 3.710159450765424*^9}, 3.710163718847006*^9, 
   3.710163960069388*^9, 3.7101792334187603`*^9, 3.710774289028894*^9, 
   3.710774374815915*^9, 3.7107744327686167`*^9, 3.710776948028866*^9, 
   3.710864982517083*^9, 3.710865122258996*^9, 3.710865152485445*^9, 
   3.710865328756804*^9, 3.7108654785249043`*^9, 3.71131226459834*^9, 
   3.71131347826827*^9, 3.7113135417064123`*^9, 3.712086526690667*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"-", "4"}], " ", 
    SubsuperscriptBox["U", "12", "2"], " ", 
    SubscriptBox["U", "21"], " ", 
    SubscriptBox["U", "22"]}], "+", 
   RowBox[{"4", " ", 
    SubscriptBox["U", "11"], " ", 
    SubscriptBox["U", "12"], " ", 
    SubsuperscriptBox["U", "22", "2"]}]}], "//", "TeXForm"}]], "Input",
 CellChangeTimes->{{3.710161450024353*^9, 3.7101614527247458`*^9}, 
   3.710163818395554*^9, 3.710180721499382*^9, 3.710180792842679*^9, 
   3.710180839018792*^9, 3.710776115350211*^9, 3.7107761658187857`*^9, {
   3.7107769996613417`*^9, 3.710777008794408*^9}, 3.71077705056341*^9}],

Cell["4 U_{11} U_{12} U_{22}^2-4 U_{12}^2 U_{21} U_{22}", "Output",
 CellChangeTimes->{3.710161453011932*^9, 3.710163718966383*^9, 
  3.710163819284492*^9, 3.7101639600940533`*^9, 3.710179233453117*^9, 
  3.710180722144371*^9, 3.7101807932767344`*^9, 3.710180839898306*^9, 
  3.710774289174219*^9, 3.710774374893797*^9, 3.7107744328472223`*^9, 
  3.710776116232128*^9, 3.710776166789949*^9, 3.7107769481159353`*^9, 
  3.710777009553158*^9, 3.710777051222074*^9, 3.710864982575737*^9, 
  3.7108651222837877`*^9, 3.710865152512251*^9, 3.710865328798848*^9, 
  3.710865478557263*^9, 3.711312264728793*^9, 3.711313478293096*^9, 
  3.711313541734466*^9, 3.712086526834641*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["ImmNames"], "Input",
 CellChangeTimes->{{3.712086558544475*^9, 3.712086565817581*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Imm", "[", 
    RowBox[{"1", ",", "1", ",", "1"}], "]"}], "[", 
   RowBox[{"Cycles", "[", 
    RowBox[{"{", "}"}], "]"}], "]"}], "}"}]], "Output",
 CellChangeTimes->{3.712086566372944*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["FullImmNames"], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"Imm", "[", "3", "]"}], "[", 
    RowBox[{"Cycles", "[", 
     RowBox[{"{", "}"}], "]"}], "]"}], ",", 
   RowBox[{
    RowBox[{"Imm", "[", 
     RowBox[{"2", ",", "1"}], "]"}], "[", 
    RowBox[{"Cycles", "[", 
     RowBox[{"{", "}"}], "]"}], "]"}], ",", 
   RowBox[{
    RowBox[{"Imm", "[", 
     RowBox[{"2", ",", "1"}], "]"}], "[", 
    RowBox[{"Cycles", "[", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], "}"}], "]"}], "]"}], ",", 
   RowBox[{
    RowBox[{"Imm", "[", 
     RowBox[{"2", ",", "1"}], "]"}], "[", 
    RowBox[{"Cycles", "[", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "3"}], "}"}], "}"}], "]"}], "]"}], ",", 
   RowBox[{
    RowBox[{"Imm", "[", 
     RowBox[{"2", ",", "1"}], "]"}], "[", 
    RowBox[{"Cycles", "[", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"2", ",", "3"}], "}"}], "}"}], "]"}], "]"}], ",", 
   RowBox[{
    RowBox[{"Imm", "[", 
     RowBox[{"2", ",", "1"}], "]"}], "[", 
    RowBox[{"Cycles", "[", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3"}], "}"}], "}"}], "]"}], "]"}], ",", 
   RowBox[{
    RowBox[{"Imm", "[", 
     RowBox[{"2", ",", "1"}], "]"}], "[", 
    RowBox[{"Cycles", "[", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "3", ",", "2"}], "}"}], "}"}], "]"}], "]"}], ",", 
   RowBox[{
    RowBox[{"Imm", "[", 
     RowBox[{"1", ",", "1", ",", "1"}], "]"}], "[", 
    RowBox[{"Cycles", "[", 
     RowBox[{"{", "}"}], "]"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.712086570797799*^9}]
}, Open  ]]
},
WindowSize->{1920, 1014},
WindowMargins->{{0, Automatic}, {0, Automatic}},
Magnification:>1.5 Inherited,
FrontEndVersion->"11.0 for Linux x86 (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 128, 1, 49, "Text"],
Cell[689, 23, 193, 4, 49, "Text"],
Cell[885, 29, 135, 1, 49, "Text"],
Cell[1023, 32, 12980, 185, 139, "Input"],
Cell[14006, 219, 362, 10, 244, "Text"],
Cell[CellGroupData[{
Cell[14393, 233, 4003, 85, 247, "Input"],
Cell[18399, 320, 3662, 52, 48, "Output"],
Cell[22064, 374, 3662, 52, 48, "Output"],
Cell[25729, 428, 3662, 52, 48, "Output"]
}, Open  ]],
Cell[29406, 483, 392, 7, 82, "Text"],
Cell[CellGroupData[{
Cell[29823, 494, 2733, 46, 82, "Input"],
Cell[32559, 542, 3748, 55, 48, "Output"]
}, Open  ]],
Cell[36322, 600, 161, 2, 49, "Text"],
Cell[CellGroupData[{
Cell[36508, 606, 1879, 42, 181, "Input"],
Cell[38390, 650, 4395, 77, 48, "Output"]
}, Open  ]],
Cell[42800, 730, 327, 6, 49, "Text"],
Cell[43130, 738, 1233, 27, 48, "Input"],
Cell[44366, 767, 173, 4, 49, "Text"],
Cell[44542, 773, 686, 15, 48, "Input"],
Cell[45231, 790, 229, 5, 49, "Text"],
Cell[45463, 797, 2262, 53, 148, "Input"],
Cell[47728, 852, 184, 4, 49, "Text"],
Cell[47915, 858, 4030, 99, 181, "Input"],
Cell[CellGroupData[{
Cell[51970, 961, 236, 4, 48, "Input"],
Cell[52209, 967, 17431, 449, 290, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[69677, 1421, 503, 10, 82, "Input"],
Cell[70183, 1433, 413, 8, 61, "Message"]
}, Open  ]],
Cell[70611, 1444, 124, 1, 49, "Text"],
Cell[70738, 1447, 949, 19, 82, "Input"],
Cell[71690, 1468, 358, 6, 49, "Text"],
Cell[CellGroupData[{
Cell[72073, 1478, 5165, 130, 412, "Input"],
Cell[77241, 1610, 3615, 50, 48, "Output"],
Cell[80859, 1662, 3831, 58, 48, "Output"]
}, Open  ]],
Cell[84705, 1723, 205, 4, 49, "Text"],
Cell[84913, 1729, 1835, 48, 148, "Input"],
Cell[86751, 1779, 297, 6, 49, "Text"],
Cell[CellGroupData[{
Cell[87073, 1789, 1486, 34, 115, "Input"],
Cell[88562, 1825, 4373, 72, 206, "Output"]
}, Open  ]],
Cell[92950, 1900, 306, 6, 49, "Text"],
Cell[CellGroupData[{
Cell[93281, 1910, 736, 17, 82, "Input"],
Cell[94020, 1929, 3802, 58, 48, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[97859, 1992, 348, 8, 53, "Input"],
Cell[98210, 2002, 4126, 71, 48, "Output"]
}, Open  ]],
Cell[102351, 2076, 180, 4, 49, "Text"],
Cell[102534, 2082, 1198, 35, 148, "Input"],
Cell[103735, 2119, 1565, 40, 214, "Input"],
Cell[105303, 2161, 576, 9, 82, "Text"],
Cell[CellGroupData[{
Cell[105904, 2174, 861, 17, 48, "Input"],
Cell[106768, 2193, 3687, 55, 48, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[110492, 2253, 1695, 35, 181, "Input"],
Cell[112190, 2290, 3604, 96, 282, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[115831, 2391, 546, 11, 48, "Input"],
Cell[116380, 2404, 4440, 76, 254, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[120857, 2485, 11629, 293, 302, "Input"],
Cell[132489, 2780, 5458, 100, 206, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[137984, 2885, 1092, 19, 139, "Input"],
Cell[139079, 2906, 3603, 51, 48, "Output"],
Cell[142685, 2959, 8486, 184, 254, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[151208, 3148, 642, 12, 48, "Input"],
Cell[151853, 3162, 8159, 210, 192, "Output"]
}, Open  ]],
Cell[160027, 3375, 707, 13, 48, "Input"],
Cell[160737, 3390, 1024, 20, 48, "Input"],
Cell[CellGroupData[{
Cell[161786, 3414, 334, 5, 48, "Input"],
Cell[162123, 3421, 3533, 49, 48, "Output"]
}, Open  ]],
Cell[165671, 3473, 212, 2, 49, "Text"],
Cell[165886, 3477, 376, 8, 49, "Text"],
Cell[166265, 3487, 2260, 62, 214, "Input"],
Cell[CellGroupData[{
Cell[168550, 3553, 2653, 71, 214, "Input"],
Cell[171206, 3626, 2813, 44, 48, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[174056, 3675, 2735, 73, 214, "Input"],
Cell[176794, 3750, 3733, 56, 48, "Output"]
}, Open  ]],
Cell[180542, 3809, 116, 1, 49, "Text"],
Cell[CellGroupData[{
Cell[180683, 3814, 429, 7, 82, "Input"],
Cell[181115, 3823, 4044, 64, 48, "Output"],
Cell[185162, 3889, 3822, 57, 48, "Output"]
}, Open  ]],
Cell[188999, 3949, 106, 1, 49, "Text"],
Cell[CellGroupData[{
Cell[189130, 3954, 723, 19, 48, "Input"],
Cell[189856, 3975, 4220, 70, 48, "Output"]
}, Open  ]],
Cell[194091, 4048, 116, 1, 49, "Text"],
Cell[194210, 4051, 2083, 55, 148, "Input"],
Cell[196296, 4108, 603, 15, 48, "Input"],
Cell[CellGroupData[{
Cell[196924, 4127, 1380, 36, 115, "Input"],
Cell[198307, 4165, 6451, 137, 122, "Output"]
}, Open  ]],
Cell[204773, 4305, 174, 4, 49, "Text"],
Cell[204950, 4311, 542, 16, 48, "Input"],
Cell[CellGroupData[{
Cell[205517, 4331, 427, 10, 48, "Input"],
Cell[205947, 4343, 4319, 76, 48, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[210303, 4424, 389, 9, 53, "Input"],
Cell[210695, 4435, 3679, 53, 48, "Output"]
}, Open  ]],
Cell[214389, 4491, 267, 6, 48, "Input"],
Cell[CellGroupData[{
Cell[214681, 4501, 1980, 51, 148, "Input"],
Cell[216664, 4554, 8521, 220, 205, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[225222, 4779, 7298, 177, 742, "Input"],
Cell[232523, 4958, 6285, 136, 185, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[238845, 5099, 286, 7, 48, "Input"],
Cell[239134, 5108, 3936, 115, 253, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[243107, 5228, 640, 15, 50, "Input"],
Cell[243750, 5245, 671, 9, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[244458, 5259, 100, 1, 48, "Input"],
Cell[244561, 5262, 240, 7, 48, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[244838, 5274, 38, 0, 48, "Input"],
Cell[244879, 5276, 1623, 52, 82, "Output"]
}, Open  ]]
}
]
*)

